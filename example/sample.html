<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>scape-a-lyzer</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
    <style>
        li.expandable:hover {
            background-color: #f8f9fa;
        }

        li.expandable:hover::after {
            content: none;
        }

        li.expandable.detail-hide:hover::after {
            content: " ›";
        }

        li.expandable.detail-hide .details {
            display: none;
        }

        .collapsing {
            transition: none;
        }


    </style>
</head>
<body>

<div class='container'>
    <div class='row'>
        <div class='col'>
            <div class='accordion accordion-flush' id='report'>
                <h1>Context: k3d-k3dlocal</h1><p>K8S version v1.27.5+k3s1, built on 2023-09-05T18:24:36Z, 1 nodes</p><p>Kubescape version v3.0.1</p><p>Frameworks: cis-v1.23-t1.0.1, allcontrols</p><div class='accordion-item'><div class='accordion-header' id='control_1_header'><button class='accordion-button collapsed' type='button' data-bs-toggle='collapse' data-bs-target='#control_1' aria-expanded='false' aria-controls='control_1'><div class='row'><div class='col'><h2 class='fs-4'>C-0002: Exec into container</h2><p class='mb-0'> Attackers with relevant permissions can run malicious commands in the context of legitimate containers in the cluster using “kubectl exec” command. This control determines which subjects have permissions to use this command.</p></div></div></button></div><div id='control_1' class='accordion-collapse collapse' aria-labelledby='control_1_header' data-bs-parent='#report'><div class='accordion-body'><p>Attackers who have permissions, can run malicious commands in containers in the cluster using exec command (“kubectl exec”). In this method, attackers can use legitimate images, such as an OS image (e.g., Ubuntu) as a backdoor container, and run their malicious code remotely by using “kubectl exec”.</p><h5>Detection</h5><p>Check which subjects have RBAC permissions to exec into pods– if they have the “pods/exec” verb.</p><h5>Remediation</h5><p>It is recommended to prohibit “kubectl exec” command in production environments. It is also recommended not to use subjects with this permission for daily cluster operations.</p><h5>Checked paths and expected values</h5><ul><li>relatedObjects[*].roleRef.name</li><li>relatedObjects[*].rules[*].apiGroups[*]</li><li>relatedObjects[*].rules[*].resources[*]</li><li>relatedObjects[*].rules[*].verbs[*]</li><li>relatedObjects[*].subjects[*]</li></ul><h5>Example</h5><pre>kind: Role
apiVersion: rbac.authorization.k8s.io/v1
metadata:
  namespace: default
  name: pod-exec
rules:
- apiGroups: ["*"]
  resources: ["pods/exec"] # we look for this resource or *
  verbs: ["create"]	   # we look for this verb or * 	</pre><h5>Affected resources</h5><ul><li class='expandable detail-hide'>kube-system ServiceAccount helm-traefik<div class='details'><pre>---
kind: ServiceAccount
name: helm-traefik
namespace: kube-system
relatedObjects:
- apiVersion: rbac.authorization.k8s.io/v1
  kind: ClusterRoleBinding
  metadata:
    annotations:
      objectset.rio.cattle.io/applied: H4sIAAAAAAAA/4yRze6TUBDFX8XMGlD+SGhJXGgXmrirxo1xMVyGMnI/yNwBo03f3UBbrYmtLu/H+c2Zc46AI38iiRw81CANmgwn7YPwD1QOPhs2MePwfM4hgYF9CzXs7BSVZB8svWHfsj9AAo4UW1SE+gjofdBVHpdjaL6S0UiaCYfMoKqlhckLrCfrUhO8SrCWJDU9iqZCB44qKwOSu4TwzZOkh3m4gG6e5jx59p59++odWbdboP/keHQENaggdTz81/c4olk0w9RQGr9HJQenBIzQav0jO4qKboTaT9YmYLEh+zCUHmMPNZgX3bYirPCppKIlU+XbsjIVFk8vcyw2XUFlh1R2y7SL7zXJGyPpdZFTAhIs7albyxn5rYRpfFT3X7uGX5PM+TLF1rFf8HE6bwP15+NV+YFkZkOvjQmTV/jT5u+M76b45fQzAAD//6tHuTCdAgAA
      objectset.rio.cattle.io/id: helm-controller-chart-registration
      objectset.rio.cattle.io/owner-gvk: helm.cattle.io/v1, Kind=HelmChart
      objectset.rio.cattle.io/owner-name: traefik
      objectset.rio.cattle.io/owner-namespace: kube-system
    creationTimestamp: "2024-01-08T17:06:00Z"
    labels:
      objectset.rio.cattle.io/hash: c0f97ea7a25e3dec71957c7a3241a38f3e5fae5f
    name: helm-kube-system-traefik
    resourceVersion: "349"
    uid: a815f9db-1d48-4564-a669-936f12c9a7ec
  roleRef:
    apiGroup: rbac.authorization.k8s.io
    kind: ClusterRole
    name: cluster-admin
  subjects:
  - kind: ServiceAccount
    name: helm-traefik
    namespace: kube-system
- apiVersion: rbac.authorization.k8s.io/v1
  kind: ClusterRole
  metadata:
    annotations:
      rbac.authorization.kubernetes.io/autoupdate: "true"
    creationTimestamp: "2024-01-08T17:05:54Z"
    labels:
      kubernetes.io/bootstrapping: rbac-defaults
    name: cluster-admin
    resourceVersion: "72"
    uid: 7a564a7b-9ca4-49ce-8a42-78660cb44f4c
  rules:
  - apiGroups:
    - '*'
    resources:
    - '*'
    verbs:
    - '*'
  - nonResourceURLs:
    - '*'
    verbs:
    - '*'
...
</pre></div></li><li class='expandable detail-hide'>kube-system ServiceAccount helm-traefik-crd<div class='details'><pre>---
kind: ServiceAccount
name: helm-traefik-crd
namespace: kube-system
relatedObjects:
- apiVersion: rbac.authorization.k8s.io/v1
  kind: ClusterRoleBinding
  metadata:
    annotations:
      objectset.rio.cattle.io/applied: H4sIAAAAAAAA/4yRzY7UQAyEXwX5nA7zw2g2kTjAHkDitiAuiIPT7Z6Y9E/kdoJgNO+Okl3QrMQuHLut+lyuOgOO/JmkcE7QgnRoa5y0z8I/UTmnergpNeeX8xYqGDg5aOE2TEVJ7nKgt5wcpxNUEEnRoSK0Z8CUsq7ysjxz942sFtJaONcWVQMtTF5gPYVobE4qOQQSY3sUNUInLiorA6onCfl7IjGneXgAXY3mbfXiAyf3+j2FeLtA/8lJGAlaUEHyPBgr7r8kZUS76IapI1N+FKUIlwqs0Gr/E0cqinGENk0hVBCwo/BsMD2WHlp4deP93h3sfrs9dvvjzltn8bBpjs3BN3533OzQbw7Nbtn24H1N88qIuT7mUoHkQHfk15JGfid5Gp+r/a+dw59t9v7ToIucFnyZ7i+C9sv5t/IjycyW3libp6Tw2OrjrJ9M8+vlVwAAAP//b1bdJakCAAA
      objectset.rio.cattle.io/id: helm-controller-chart-registration
      objectset.rio.cattle.io/owner-gvk: helm.cattle.io/v1, Kind=HelmChart
      objectset.rio.cattle.io/owner-name: traefik-crd
      objectset.rio.cattle.io/owner-namespace: kube-system
    creationTimestamp: "2024-01-08T17:06:00Z"
    labels:
      objectset.rio.cattle.io/hash: 48ff3d5c3117b372fcdca509795f9f2702af0592
    name: helm-kube-system-traefik-crd
    resourceVersion: "348"
    uid: 31be0c7e-dd79-49c6-9a13-77f5f124746c
  roleRef:
    apiGroup: rbac.authorization.k8s.io
    kind: ClusterRole
    name: cluster-admin
  subjects:
  - kind: ServiceAccount
    name: helm-traefik-crd
    namespace: kube-system
- apiVersion: rbac.authorization.k8s.io/v1
  kind: ClusterRole
  metadata:
    annotations:
      rbac.authorization.kubernetes.io/autoupdate: "true"
    creationTimestamp: "2024-01-08T17:05:54Z"
    labels:
      kubernetes.io/bootstrapping: rbac-defaults
    name: cluster-admin
    resourceVersion: "72"
    uid: 7a564a7b-9ca4-49ce-8a42-78660cb44f4c
  rules:
  - apiGroups:
    - '*'
    resources:
    - '*'
    verbs:
    - '*'
  - nonResourceURLs:
    - '*'
    verbs:
    - '*'
...
</pre></div></li></ul></div></div></div><div class='accordion-item'><div class='accordion-header' id='control_2_header'><button class='accordion-button collapsed' type='button' data-bs-toggle='collapse' data-bs-target='#control_2' aria-expanded='false' aria-controls='control_2'><div class='row'><div class='col'><h2 class='fs-4'>C-0004: Resources memory limit and request</h2><p class='mb-0'> This control identifies all Pods for which the memory limit is not set.</p></div></div></button></div><div id='control_2' class='accordion-collapse collapse' aria-labelledby='control_2_header' data-bs-parent='#report'><div class='accordion-body'><h5>Remediation</h5><p>Set the memory limit or use exception mechanism to avoid unnecessary notifications.</p><h5>Checked paths and expected values</h5><ul><li>spec.template.spec.containers[*].resources.limits.memory = YOUR_VALUE</li><li>spec.template.spec.containers[*].resources.requests.memory = YOUR_VALUE</li></ul><h5>Example</h5><pre>apiVersion: v1
kind: Pod
metadata:
  name: frontend
spec:
  containers:
  - name: app
    image: images.my-company.example/app:v4
    resources:
      requests:
        memory: "64Mi"
        cpu: "250m"
      limits:
        memory: "128Mi"    #we make sure this is set
        cpu: "500m"
</pre><h5>Affected resources</h5><ul><li class='expandable detail-hide'>kube-system DaemonSet svclb-traefik-bf26f129<div class='details'><pre>---
apiVersion: apps/v1
kind: DaemonSet
metadata:
  annotations:
    deprecated.daemonset.template.generation: "1"
    objectset.rio.cattle.io/applied: H4sIAAAAAAAA/8RVwW7jNhD9lWLOsizb2tQR0EOQBEXQrmPY3l4WRjCiRjFriiTIkTZGoH8vKDtZpWsnQYFm4YNBzptH8r3RzCOglX+R89JoyACt9cNmBBFspS4ggyukyuglMURQEWOBjJA9AmptGFka7cPS5H+TYE8cO2ligcyKYmmGMnBAdDJuvmlyg/tmCxkMm1H0yx9SF78tyTVS0Jt5GiuCDNghlXL7Lri3KELOts5p4HeeqYI2AuGoe8xKVuQZKwuZrpWKQGFO6tUnbtBvIIPp5KwUuaBkPC4+FUif8snZ2Xla0oiwnEzPxfkEy18LARH4Rgij2RmlyMXbie+xaVOQJ0WCjYMMSlSe3kjxjfhBiHfgTyhxoPKNUPngQDjIy/FZORqfwz5+ItVbEkGp7/d/hApZbP58FhGtPU3ethEwVVYhU5fbq7d3GPQq98dJ2BMCazaVqTUfCvpCiLBamS1pyDpvIwiHoNTkPGRfH4F00/0f7rNcXN7NbxcriKBBVYetaQJt9AKwuJj9fr3sQZK4+w1fIK+ul6u7+eJ2ddtDri7nP2JeO69D3Mz7p42SOJ3Eo/EoHo8SaNcRyArvQ8ShFhtyw62S1pIbqDxrkjiNUzhg5rVSc6Ok2EEGN+XM8NyRJ83wXInBTWEH0wQisMbxXqZn1ebGMWTTJIKN8fx9dSzbGTbCqKdnryNw5E3tBIUCCsaRqJ3k3aXRTA/cFR5azKWSLGlfZUUB2VeYXa/uLq4+38xg3bZBnrd9S9PJxxr3rwN/lnPhGq9Yl6aTvnfd8ijB/+be+miq33nByvdN1cSxtE0aS3tXGvcNXdEXE9p1d4v+tz7rtVOIgI0i9zQ2w9deliQYMpiZpdhQUavQ7bcURA2jYOCMojj0F6eJyYfmU6FncmHa2cDVzYnrB+nZd27/F8pDoxtYhZpOMu85Lp1kKVBdFIXR/lar3fGEdeiEtS2QackOme53QdbQT6W+/9IF9hPi4YvGBqXCXBFkozAFdjaotniB7TorI9edk6J2jjTP6ion9/TQArIkgoK8dFQcC+lu77P0/sj2grDYQZa07T8BAAD//yoC/PIWCQAA
    objectset.rio.cattle.io/id: ""
    objectset.rio.cattle.io/owner-gvk: /v1, Kind=Service
    objectset.rio.cattle.io/owner-name: traefik
    objectset.rio.cattle.io/owner-namespace: kube-system
  creationTimestamp: "2024-01-08T17:06:48Z"
  generation: 1
  labels:
    objectset.rio.cattle.io/hash: 836fcbce022d5dae5b36694fe1eaf389c93af7dc
    svccontroller.k3s.cattle.io/nodeselector: "false"
    svccontroller.k3s.cattle.io/svcname: traefik
    svccontroller.k3s.cattle.io/svcnamespace: kube-system
  name: svclb-traefik-bf26f129
  namespace: kube-system
  resourceVersion: "615"
  uid: acc5b475-2181-4d70-b320-8de6f12fd45f
spec:
  revisionHistoryLimit: 10
  selector:
    matchLabels:
      app: svclb-traefik-bf26f129
  template:
    metadata:
      creationTimestamp: ~
      labels:
        app: svclb-traefik-bf26f129
        svccontroller.k3s.cattle.io/svcname: traefik
        svccontroller.k3s.cattle.io/svcnamespace: kube-system
    spec:
      automountServiceAccountToken: false
      containers:
      - name: lb-tcp-80
        image: rancher/klipper-lb:v0.4.4
        ports:
        - name: lb-tcp-80
          hostPort: 80
          containerPort: 80
          protocol: TCP
        env:
        - name: SRC_PORT
          value: XXXXXX
        - name: SRC_RANGES
          value: XXXXXX
        - name: DEST_PROTO
          value: XXXXXX
        - name: DEST_PORT
          value: XXXXXX
        - name: DEST_IPS
          value: XXXXXX
        resources: []
        terminationMessagePath: /dev/termination-log
        terminationMessagePolicy: File
        imagePullPolicy: IfNotPresent
        securityContext:
          capabilities:
            add:
            - NET_ADMIN
      - name: lb-tcp-443
        image: rancher/klipper-lb:v0.4.4
        ports:
        - name: lb-tcp-443
          hostPort: 443
          containerPort: 443
          protocol: TCP
        env:
        - name: SRC_PORT
          value: XXXXXX
        - name: SRC_RANGES
          value: XXXXXX
        - name: DEST_PROTO
          value: XXXXXX
        - name: DEST_PORT
          value: XXXXXX
        - name: DEST_IPS
          value: XXXXXX
        resources: []
        terminationMessagePath: /dev/termination-log
        terminationMessagePolicy: File
        imagePullPolicy: IfNotPresent
        securityContext:
          capabilities:
            add:
            - NET_ADMIN
      dnsPolicy: ClusterFirst
      restartPolicy: Always
      schedulerName: default-scheduler
      securityContext:
        sysctls:
        - name: net.ipv4.ip_forward
          value: "1"
      serviceAccount: svclb
      serviceAccountName: svclb
      terminationGracePeriodSeconds: 30
      tolerations:
      - effect: NoSchedule
        key: node-role.kubernetes.io/master
        operator: Exists
      - effect: NoSchedule
        key: node-role.kubernetes.io/control-plane
        operator: Exists
      - key: CriticalAddonsOnly
        operator: Exists
  updateStrategy:
    rollingUpdate:
      maxSurge: 0
      maxUnavailable: 1
    type: RollingUpdate
...
</pre></div></li><li class='expandable detail-hide'>kube-system Deployment local-path-provisioner<div class='details'><pre>---
apiVersion: apps/v1
kind: Deployment
metadata:
  annotations:
    deployment.kubernetes.io/revision: "1"
    objectset.rio.cattle.io/applied: H4sIAAAAAAAA/6xU3W7yRhB9lWqubQMfBCFLvUBJqlZNCEqU3kSoGtZj2LDeXe0Obizkd68Gm/yoIWmlXnl/Zs6emXPGB0Cv/6AQtbOQA3ofB/UIEthpW0AOV+SNayqyDAlUxFggI+QHQGsdI2tno2zd+pkUR+IsaJcpZDaUaTfQAgLJ2Xv3l6WQbuod5LAbx3c39Sj56Xdti5/nReHstxAWK4IcjFNo0sgu4Ib+VVL0qCRzt19TGpvIVEGbgME1mS9L22LcQg6j2bgcX6jpRVmu1Xg4nUyH43IyLkcXs2ExU9MZ/ihwXUwE9ANJj7xNfXC1luZTgO7+DJ/oSQmbQF38r1qKbG50pRnyYQKRDCl2QYIqZLW9ea0AvT//aivgHJBp0xwfcMZou3n0BTJ1YC+PFmvUBteGIB+1CXDjheP9h1g5p8qbU947t5j/wKUvVDnLqC2FCPmTbKsKxZJP59sXGYP4NE2Vs6XeQAIDYjXodv0ne47OwioBsvURuRdleXf152J+e/2wnF9eQwI1mj39ElwlZEpNprin8nW9RBbxTzVmb8q1bbtKQFfivxwCWrWlMPicc14Ps2H2YwJ9wnJvzNIZrRrI4bdy4XgZKHbD9513amf2Fd26veWuY5Use57v2/CG1R2kXSa0KyHug3ZBc3NpMMZFF9e5MLWuoFQFzVqhkXZTqLWiuVLy0uIrfmkfm2IXDAmwMxROP5CnA+xIir7s4Y9DH++saWSIvUSKteH6RUeO0CYHoLIkxZDDwj2oLRV7IwPfwRypBmcokzEKlpiizKyYKjiTeoOW/lfkCiMfdfgEcnVS52RlafstenHTP2Xtvduel6lt278DAAD//8i6p1C4BQAA
    objectset.rio.cattle.io/id: ""
    objectset.rio.cattle.io/owner-gvk: k3s.cattle.io/v1, Kind=Addon
    objectset.rio.cattle.io/owner-name: local-storage
    objectset.rio.cattle.io/owner-namespace: kube-system
  creationTimestamp: "2024-01-08T17:05:58Z"
  generation: 1
  labels:
    objectset.rio.cattle.io/hash: 183f35c65ffbc3064603f43f1580d8c68a2dabd4
  name: local-path-provisioner
  namespace: kube-system
  resourceVersion: "475"
  uid: 718c0dfe-3f1a-4b36-807a-d731f31753f6
spec:
  progressDeadlineSeconds: 600
  replicas: 1
  revisionHistoryLimit: 0
  selector:
    matchLabels:
      app: local-path-provisioner
  strategy:
    rollingUpdate:
      maxSurge: 25%
      maxUnavailable: 1
    type: RollingUpdate
  template:
    metadata:
      creationTimestamp: ~
      labels:
        app: local-path-provisioner
    spec:
      containers:
      - name: local-path-provisioner
        image: rancher/local-path-provisioner:v0.0.24
        command:
        - local-path-provisioner
        - start
        - --config
        - /etc/config/config.json
        env:
        - name: POD_NAMESPACE
          value: XXXXXX
          valueFrom:
            fieldRef:
              apiVersion: v1
              fieldPath: metadata.namespace
        resources: []
        volumeMounts:
        - name: config-volume
          mountPath: /etc/config/
        terminationMessagePath: /dev/termination-log
        terminationMessagePolicy: File
        imagePullPolicy: IfNotPresent
      dnsPolicy: ClusterFirst
      priorityClassName: system-node-critical
      restartPolicy: Always
      schedulerName: default-scheduler
      securityContext: []
      serviceAccount: local-path-provisioner-service-account
      serviceAccountName: local-path-provisioner-service-account
      terminationGracePeriodSeconds: 30
      tolerations:
      - key: CriticalAddonsOnly
        operator: Exists
      - effect: NoSchedule
        key: node-role.kubernetes.io/control-plane
        operator: Exists
      - effect: NoSchedule
        key: node-role.kubernetes.io/master
        operator: Exists
      volumes:
      - configMap:
          defaultMode: 420
          name: local-path-config
        name: config-volume
...
</pre></div></li><li class='expandable detail-hide'>kube-system Deployment traefik<div class='details'><pre>---
apiVersion: apps/v1
kind: Deployment
metadata:
  annotations:
    deployment.kubernetes.io/revision: "1"
    meta.helm.sh/release-name: traefik
    meta.helm.sh/release-namespace: kube-system
  creationTimestamp: "2024-01-08T17:06:48Z"
  generation: 1
  labels:
    app.kubernetes.io/instance: traefik-kube-system
    app.kubernetes.io/managed-by: Helm
    app.kubernetes.io/name: traefik
    helm.sh/chart: traefik-21.2.1_up21.2.0
  name: traefik
  namespace: kube-system
  resourceVersion: "629"
  uid: ec30998f-e81b-47de-aeae-3970de0b73a4
spec:
  progressDeadlineSeconds: 600
  replicas: 1
  revisionHistoryLimit: 10
  selector:
    matchLabels:
      app.kubernetes.io/instance: traefik-kube-system
      app.kubernetes.io/name: traefik
  strategy:
    rollingUpdate:
      maxSurge: 1
      maxUnavailable: 0
    type: RollingUpdate
  template:
    metadata:
      annotations:
        prometheus.io/path: /metrics
        prometheus.io/port: "9100"
        prometheus.io/scrape: "true"
      creationTimestamp: ~
      labels:
        app.kubernetes.io/instance: traefik-kube-system
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: traefik
        helm.sh/chart: traefik-21.2.1_up21.2.0
    spec:
      containers:
      - name: traefik
        image: rancher/mirrored-library-traefik:2.9.10
        args:
        - --global.checknewversion
        - --global.sendanonymoususage
        - --entrypoints.metrics.address=:9100/tcp
        - --entrypoints.traefik.address=:9000/tcp
        - --entrypoints.web.address=:8000/tcp
        - --entrypoints.websecure.address=:8443/tcp
        - --api.dashboard=true
        - --ping=true
        - --metrics.prometheus=true
        - --metrics.prometheus.entrypoint=metrics
        - --providers.kubernetescrd
        - --providers.kubernetesingress
        - --providers.kubernetesingress.ingressendpoint.publishedservice=kube-system/traefik
        - --entrypoints.websecure.http.tls=true
        ports:
        - name: metrics
          containerPort: 9100
          protocol: TCP
        - name: traefik
          containerPort: 9000
          protocol: TCP
        - name: web
          containerPort: 8000
          protocol: TCP
        - name: websecure
          containerPort: 8443
          protocol: TCP
        resources: []
        volumeMounts:
        - name: data
          mountPath: /data
        - name: tmp
          mountPath: /tmp
        livenessProbe:
          httpGet:
            path: /ping
            port: 9000
            scheme: HTTP
          initialDelaySeconds: 2
          timeoutSeconds: 2
          periodSeconds: 10
          successThreshold: 1
          failureThreshold: 3
        readinessProbe:
          httpGet:
            path: /ping
            port: 9000
            scheme: HTTP
          initialDelaySeconds: 2
          timeoutSeconds: 2
          periodSeconds: 10
          successThreshold: 1
          failureThreshold: 1
        terminationMessagePath: /dev/termination-log
        terminationMessagePolicy: File
        imagePullPolicy: IfNotPresent
        securityContext:
          capabilities:
            drop:
            - ALL
          runAsUser: 65532
          runAsGroup: 65532
          runAsNonRoot: true
          readOnlyRootFilesystem: true
      dnsPolicy: ClusterFirst
      priorityClassName: system-cluster-critical
      restartPolicy: Always
      schedulerName: default-scheduler
      securityContext:
        fsGroup: 65532
      serviceAccount: traefik
      serviceAccountName: traefik
      terminationGracePeriodSeconds: 60
      tolerations:
      - key: CriticalAddonsOnly
        operator: Exists
      - effect: NoSchedule
        key: node-role.kubernetes.io/control-plane
        operator: Exists
      - effect: NoSchedule
        key: node-role.kubernetes.io/master
        operator: Exists
      volumes:
      - emptyDir: []
        name: data
      - emptyDir: []
        name: tmp
...
</pre></div></li><li class='expandable detail-hide'>kube-system Job helm-install-traefik<div class='details'><pre>---
apiVersion: batch/v1
kind: Job
metadata:
  annotations:
    batch.kubernetes.io/job-tracking: ""
    objectset.rio.cattle.io/applied: H4sIAAAAAAAA/6xVUY/qNhP9K59Guk9fEgLZbCDSPgQIhd5diAK7alWtkDETcHHsyHZoVyv+e+WQezfb3m5vpb7ZzszxOeM5k1cgFXtCpZkUEMOOGHrsnfvgwImJPcTwo9yBAyUasieGQPwKRAhpiGFSaLuVu1+RGo3GU0x6lBjD0WOyx2z2EXnpUimMkpyjcumRKOMqPDBtVIMBzt8iyN8EKvdwPrVAnU/nvvO/z0zs7+bIy4kF/UccQUqEGIwiWLDTd4XrilCbc6p36OoXbbCEiwNUYUN9w0rUhpQVxKLm3AFOdsiboli6jVbt/Yl5c/pdPI5EHyEG6hejCElEBiEGe6RRfxRGNCLB4KZPgmERYFgQDAvLrNXYVJ0JbQjn7ttFH0jSFVLLe0foSRbFPSuZgbjv+74DBsuKE4P2+wd98IFkKQp2mF/lrOfJILy9C6NJMByPZuPx7ThIg4kfzobRKEgnfhCG09EoDGfRjT9OwptplM4G09HtdBTNhtPb//wBLh35tlMJE6g0xL+8AlEHu4C2lOCA62o0rjaKiQM4cOByR7h3reMUC1Jzk1+b++UOnh1AcW6Q2odZJg8pOHAmvO724sX5GvGU5uvFatk9ytNs1d3P0/uH7TRfPKV5B0sjVWi6cZN5km+29sp1lky6975//PcJnbCjMZWOe71Pr58fx2m+TDfpeptki8unnrYPT6+11L1WhzvoewOv//+6ahb+X0h/Q9wmyX9I/xXL5HEz32bJer2d5Ok0XW4Wyf26k1YQrrGbsFxts3z108+dGE+fqeNRXmuDyuOSEu70fe9m4Pme3+vfNpug3XSxZsni/jFPt9nqfjHpIir80iSXZwdYSQ7NKRH0iKp34qyqULm2FeOz7w29gburGd8P/EHgD/shtDlZzXkmOaMvEMOiWEqTKdQoDLwzNzigUMtaUbTdfnHgLHld4oOshbn2bmmXGTHWc60D3zAa1roR9j6unaRtmLWDvfvybEUJucc1cqRGKmsW+z5KoEHdTE0NMXAm6t+tQ5X1pTJfpazEjDBeKwQHNKozo5hQaq9edkbW26i6ytFd77ScnS+dHr+2qxbh+mu5RrkdczeuLtjhgVQ2R3SjW4Fv4d+S3gwIQ0zdlPryRwAAAP//DrZg0DIHAAA
    objectset.rio.cattle.io/id: helm-controller-chart-registration
    objectset.rio.cattle.io/owner-gvk: helm.cattle.io/v1, Kind=HelmChart
    objectset.rio.cattle.io/owner-name: traefik
    objectset.rio.cattle.io/owner-namespace: kube-system
  creationTimestamp: "2024-01-08T17:06:00Z"
  generation: 1
  labels:
    helmcharts.helm.cattle.io/chart: traefik
    objectset.rio.cattle.io/hash: c0f97ea7a25e3dec71957c7a3241a38f3e5fae5f
  name: helm-install-traefik
  namespace: kube-system
  resourceVersion: "598"
  uid: 2a591629-9af8-4949-b2dd-39bd02b148a4
spec:
  backoffLimit: 1000
  completionMode: NonIndexed
  completions: 1
  parallelism: 1
  selector:
    matchLabels:
      batch.kubernetes.io/controller-uid: 2a591629-9af8-4949-b2dd-39bd02b148a4
  suspend: false
  template:
    metadata:
      annotations:
        helmcharts.helm.cattle.io/configHash: SHA256=57C38B9FBB6B3E3C05F8793EC0355D9955F740BA54D7EF2D96D97F8D678F2B0E
      creationTimestamp: ~
      labels:
        batch.kubernetes.io/controller-uid: 2a591629-9af8-4949-b2dd-39bd02b148a4
        batch.kubernetes.io/job-name: helm-install-traefik
        controller-uid: 2a591629-9af8-4949-b2dd-39bd02b148a4
        helmcharts.helm.cattle.io/chart: traefik
        job-name: helm-install-traefik
    spec:
      containers:
      - name: helm
        image: rancher/klipper-helm:v0.8.2-build20230815
        args:
        - install
        - --set-string
        - global.systemDefaultRegistry=
        env:
        - name: NAME
          value: XXXXXX
        - name: VERSION
          value: XXXXXX
        - name: REPO
          value: XXXXXX
        - name: HELM_DRIVER
          value: XXXXXX
        - name: CHART_NAMESPACE
          value: XXXXXX
        - name: CHART
          value: XXXXXX
        - name: HELM_VERSION
          value: XXXXXX
        - name: TARGET_NAMESPACE
          value: XXXXXX
        - name: AUTH_PASS_CREDENTIALS
          value: XXXXXX
        - name: NO_PROXY
          value: XXXXXX
        - name: FAILURE_POLICY
          value: XXXXXX
        resources: []
        volumeMounts:
        - name: values
          mountPath: /config
        - name: content
          mountPath: /chart
        terminationMessagePath: /dev/termination-log
        terminationMessagePolicy: File
        imagePullPolicy: IfNotPresent
      dnsPolicy: ClusterFirst
      nodeSelector:
        kubernetes.io/os: linux
      restartPolicy: OnFailure
      schedulerName: default-scheduler
      securityContext: []
      serviceAccount: helm-traefik
      serviceAccountName: helm-traefik
      terminationGracePeriodSeconds: 30
      volumes:
      - name: values
        secret:
          defaultMode: 420
          secretName: chart-values-traefik
      - configMap:
          defaultMode: 420
          name: chart-content-traefik
        name: content
...
</pre></div></li><li class='expandable detail-hide'>kube-system Job helm-install-traefik-crd<div class='details'><pre>---
apiVersion: batch/v1
kind: Job
metadata:
  annotations:
    batch.kubernetes.io/job-tracking: ""
    objectset.rio.cattle.io/applied: H4sIAAAAAAAA/7RVUY/iNhD+K9VI99QkJCEsm0j3ELhQ6O0CCuyqVbVCxkzAxbEj26E9If575ZC7hu11e324t9ie7/P3jWcmZyAVe0almRSQwJYYeuidAnDgyMQOEvhZbsGBEg3ZEUMgOQMRQhpimBTaLuX2d6RGo/EUkx4lxnD0mOwxiz4gL10qhVGSc1QuPRBlXIV7po1qOMD5Vwb5h0Dl7k/HlqhzdAqcHz4ysXs/RV6OLel/8ghSIiRgFMGCHV2qdt8E0RWhFnest+jqT9pgCRcHqMJG/pqVqA0pK0hEzbkDnGyRN4mxkhu/2nulvtn9Zi0Hog+QQHRfFP3dgPaDYLjtD8OC7igZ+PEwHhRxEQ79kBT+IA6tutZrk30mtCGcu7eXvWFNV0it/i2hR1kUD6xkBpLA930HDJYVJwbt+Rs18YZ1KQq2n14traZpOLh7n/VH/jiKwvh+Mg7GQRSnk9EkGt/H8d1kFIdROEyzKMiiuygexf1onEbxII6D0fC7PMSlkwJbuYQJVBqS385A1N5+QJtSeHEAxak5ajM+Tx8zcOBEeP262C7Ol6jnLF/NFvPuVp4tF931NHt43HzIZ89Z3uHTSBWabtx4mubrjb12tUzH3btvX/UW0Ak7GFPppNd7d/74NMryebbOVpt0Obu862n7ovSaJN3reHHDwAu94Me6CoN/iP6KuXWa/5T9L5Xp03q6Waar1WacZx+y+XqWPqw6sIJwjV3AfLFZ5otffu3EePpEHY/yWhtUHpeUcCfwvSj0fM/vBXfNot8uulyTdPbwlGeb5eJhNu4yKvz88pcXB1hJ9s0uEfSAqnfkrKpQubbGkpPv3Xuhu60Z34V+2PfvgwG0mGXN+VJyRj9BArNiLs1SoUZh4KZzwQGFWtaKoi3jiwMnyesSH2UtzLUgS/u5JMY2U9taf3M0qnVj7DauHZdtmK1xe/flxZoScocr5EiNVLYD7PsogQZ1MxY1JMCZqP+0radswynzxcpCTAjjtUJwQKM6MYoppfbqeWce3c6hqyXd7aFWt/O52pNz+9WyXP8h1yj3Vec2LVuw/SOpLE50Ea3RW8jX0tBMAENM3aT98lcAAAD//411peIjBwAA
    objectset.rio.cattle.io/id: helm-controller-chart-registration
    objectset.rio.cattle.io/owner-gvk: helm.cattle.io/v1, Kind=HelmChart
    objectset.rio.cattle.io/owner-name: traefik-crd
    objectset.rio.cattle.io/owner-namespace: kube-system
  creationTimestamp: "2024-01-08T17:06:00Z"
  generation: 1
  labels:
    helmcharts.helm.cattle.io/chart: traefik-crd
    objectset.rio.cattle.io/hash: 48ff3d5c3117b372fcdca509795f9f2702af0592
  name: helm-install-traefik-crd
  namespace: kube-system
  resourceVersion: "588"
  uid: 655ceb1b-aaa8-4b24-92ab-fceb2ddd45bd
spec:
  backoffLimit: 1000
  completionMode: NonIndexed
  completions: 1
  parallelism: 1
  selector:
    matchLabels:
      batch.kubernetes.io/controller-uid: 655ceb1b-aaa8-4b24-92ab-fceb2ddd45bd
  suspend: false
  template:
    metadata:
      annotations:
        helmcharts.helm.cattle.io/configHash: SHA256=E3B0C44298FC1C149AFBF4C8996FB92427AE41E4649B934CA495991B7852B855
      creationTimestamp: ~
      labels:
        batch.kubernetes.io/controller-uid: 655ceb1b-aaa8-4b24-92ab-fceb2ddd45bd
        batch.kubernetes.io/job-name: helm-install-traefik-crd
        controller-uid: 655ceb1b-aaa8-4b24-92ab-fceb2ddd45bd
        helmcharts.helm.cattle.io/chart: traefik-crd
        job-name: helm-install-traefik-crd
    spec:
      containers:
      - name: helm
        image: rancher/klipper-helm:v0.8.2-build20230815
        args:
        - install
        env:
        - name: NAME
          value: XXXXXX
        - name: VERSION
          value: XXXXXX
        - name: REPO
          value: XXXXXX
        - name: HELM_DRIVER
          value: XXXXXX
        - name: CHART_NAMESPACE
          value: XXXXXX
        - name: CHART
          value: XXXXXX
        - name: HELM_VERSION
          value: XXXXXX
        - name: TARGET_NAMESPACE
          value: XXXXXX
        - name: AUTH_PASS_CREDENTIALS
          value: XXXXXX
        - name: NO_PROXY
          value: XXXXXX
        - name: FAILURE_POLICY
          value: XXXXXX
        resources: []
        volumeMounts:
        - name: values
          mountPath: /config
        - name: content
          mountPath: /chart
        terminationMessagePath: /dev/termination-log
        terminationMessagePolicy: File
        imagePullPolicy: IfNotPresent
      dnsPolicy: ClusterFirst
      nodeSelector:
        kubernetes.io/os: linux
      restartPolicy: OnFailure
      schedulerName: default-scheduler
      securityContext: []
      serviceAccount: helm-traefik-crd
      serviceAccountName: helm-traefik-crd
      terminationGracePeriodSeconds: 30
      volumes:
      - name: values
        secret:
          defaultMode: 420
          secretName: chart-values-traefik-crd
      - configMap:
          defaultMode: 420
          name: chart-content-traefik-crd
        name: content
...
</pre></div></li></ul></div></div></div><div class='accordion-item'><div class='accordion-header' id='control_3_header'><button class='accordion-button collapsed' type='button' data-bs-toggle='collapse' data-bs-target='#control_3' aria-expanded='false' aria-controls='control_3'><div class='row'><div class='col'><h2 class='fs-4'>C-0007: Data Destruction</h2><p class='mb-0'> Attackers may attempt to destroy data and resources in the cluster. This includes deleting deployments, configurations, storage, and compute resources. This control identifies all subjects that can delete resources.</p></div></div></button></div><div id='control_3' class='accordion-collapse collapse' aria-labelledby='control_3_header' data-bs-parent='#report'><div class='accordion-body'><p>Attackers may attempt to destroy data and resources in the cluster. This includes deleting deployments, configurations, storage, and compute resources.</p><h5>Detection</h5><p>Check which subjects have delete/deletecollection RBAC permissions on workloads.</p><h5>Remediation</h5><p>You should follow the least privilege principle and minimize the number of subjects that can delete resources.</p><h5>Checked paths and expected values</h5><ul><li>relatedObjects[*].roleRef.name</li><li>relatedObjects[*].rules[*].apiGroups[*]</li><li>relatedObjects[*].rules[*].resources[*]</li><li>relatedObjects[*].rules[*].verbs[*]</li><li>relatedObjects[*].subjects[*]</li></ul><h5>Example</h5><pre>kind: Role
apiVersion: rbac.authorization.k8s.io/v1
metadata:
  namespace: default
  name: pod-exec
rules:
- apiGroups: ["*"]
  resources: ["secrets","pods","services","depolyments","replicasets","deamonsets","stateflsets","jobs,"cronjobs"]  # we look for one of these resources or *
  verbs: ["delete","deletecollection"]	    # we look for one of these verbs or * 	



</pre><h5>Affected resources</h5><ul><li class='expandable detail-hide'>kube-system ServiceAccount helm-traefik<div class='details'><pre>---
kind: ServiceAccount
name: helm-traefik
namespace: kube-system
relatedObjects:
- apiVersion: rbac.authorization.k8s.io/v1
  kind: ClusterRoleBinding
  metadata:
    annotations:
      objectset.rio.cattle.io/applied: H4sIAAAAAAAA/4yRze6TUBDFX8XMGlD+SGhJXGgXmrirxo1xMVyGMnI/yNwBo03f3UBbrYmtLu/H+c2Zc46AI38iiRw81CANmgwn7YPwD1QOPhs2MePwfM4hgYF9CzXs7BSVZB8svWHfsj9AAo4UW1SE+gjofdBVHpdjaL6S0UiaCYfMoKqlhckLrCfrUhO8SrCWJDU9iqZCB44qKwOSu4TwzZOkh3m4gG6e5jx59p59++odWbdboP/keHQENaggdTz81/c4olk0w9RQGr9HJQenBIzQav0jO4qKboTaT9YmYLEh+zCUHmMPNZgX3bYirPCppKIlU+XbsjIVFk8vcyw2XUFlh1R2y7SL7zXJGyPpdZFTAhIs7albyxn5rYRpfFT3X7uGX5PM+TLF1rFf8HE6bwP15+NV+YFkZkOvjQmTV/jT5u+M76b45fQzAAD//6tHuTCdAgAA
      objectset.rio.cattle.io/id: helm-controller-chart-registration
      objectset.rio.cattle.io/owner-gvk: helm.cattle.io/v1, Kind=HelmChart
      objectset.rio.cattle.io/owner-name: traefik
      objectset.rio.cattle.io/owner-namespace: kube-system
    creationTimestamp: "2024-01-08T17:06:00Z"
    labels:
      objectset.rio.cattle.io/hash: c0f97ea7a25e3dec71957c7a3241a38f3e5fae5f
    name: helm-kube-system-traefik
    resourceVersion: "349"
    uid: a815f9db-1d48-4564-a669-936f12c9a7ec
  roleRef:
    apiGroup: rbac.authorization.k8s.io
    kind: ClusterRole
    name: cluster-admin
  subjects:
  - kind: ServiceAccount
    name: helm-traefik
    namespace: kube-system
- apiVersion: rbac.authorization.k8s.io/v1
  kind: ClusterRole
  metadata:
    annotations:
      rbac.authorization.kubernetes.io/autoupdate: "true"
    creationTimestamp: "2024-01-08T17:05:54Z"
    labels:
      kubernetes.io/bootstrapping: rbac-defaults
    name: cluster-admin
    resourceVersion: "72"
    uid: 7a564a7b-9ca4-49ce-8a42-78660cb44f4c
  rules:
  - apiGroups:
    - '*'
    resources:
    - '*'
    verbs:
    - '*'
  - nonResourceURLs:
    - '*'
    verbs:
    - '*'
...
</pre></div></li><li class='expandable detail-hide'>kube-system ServiceAccount helm-traefik-crd<div class='details'><pre>---
kind: ServiceAccount
name: helm-traefik-crd
namespace: kube-system
relatedObjects:
- apiVersion: rbac.authorization.k8s.io/v1
  kind: ClusterRoleBinding
  metadata:
    annotations:
      objectset.rio.cattle.io/applied: H4sIAAAAAAAA/4yRzY7UQAyEXwX5nA7zw2g2kTjAHkDitiAuiIPT7Z6Y9E/kdoJgNO+Okl3QrMQuHLut+lyuOgOO/JmkcE7QgnRoa5y0z8I/UTmnergpNeeX8xYqGDg5aOE2TEVJ7nKgt5wcpxNUEEnRoSK0Z8CUsq7ysjxz942sFtJaONcWVQMtTF5gPYVobE4qOQQSY3sUNUInLiorA6onCfl7IjGneXgAXY3mbfXiAyf3+j2FeLtA/8lJGAlaUEHyPBgr7r8kZUS76IapI1N+FKUIlwqs0Gr/E0cqinGENk0hVBCwo/BsMD2WHlp4deP93h3sfrs9dvvjzltn8bBpjs3BN3533OzQbw7Nbtn24H1N88qIuT7mUoHkQHfk15JGfid5Gp+r/a+dw59t9v7ToIucFnyZ7i+C9sv5t/IjycyW3libp6Tw2OrjrJ9M8+vlVwAAAP//b1bdJakCAAA
      objectset.rio.cattle.io/id: helm-controller-chart-registration
      objectset.rio.cattle.io/owner-gvk: helm.cattle.io/v1, Kind=HelmChart
      objectset.rio.cattle.io/owner-name: traefik-crd
      objectset.rio.cattle.io/owner-namespace: kube-system
    creationTimestamp: "2024-01-08T17:06:00Z"
    labels:
      objectset.rio.cattle.io/hash: 48ff3d5c3117b372fcdca509795f9f2702af0592
    name: helm-kube-system-traefik-crd
    resourceVersion: "348"
    uid: 31be0c7e-dd79-49c6-9a13-77f5f124746c
  roleRef:
    apiGroup: rbac.authorization.k8s.io
    kind: ClusterRole
    name: cluster-admin
  subjects:
  - kind: ServiceAccount
    name: helm-traefik-crd
    namespace: kube-system
- apiVersion: rbac.authorization.k8s.io/v1
  kind: ClusterRole
  metadata:
    annotations:
      rbac.authorization.kubernetes.io/autoupdate: "true"
    creationTimestamp: "2024-01-08T17:05:54Z"
    labels:
      kubernetes.io/bootstrapping: rbac-defaults
    name: cluster-admin
    resourceVersion: "72"
    uid: 7a564a7b-9ca4-49ce-8a42-78660cb44f4c
  rules:
  - apiGroups:
    - '*'
    resources:
    - '*'
    verbs:
    - '*'
  - nonResourceURLs:
    - '*'
    verbs:
    - '*'
...
</pre></div></li><li class='expandable detail-hide'>kube-system ServiceAccount local-path-provisioner-service-account<div class='details'><pre>---
kind: ServiceAccount
name: local-path-provisioner-service-account
namespace: kube-system
relatedObjects:
- apiVersion: rbac.authorization.k8s.io/v1
  kind: ClusterRoleBinding
  metadata:
    annotations:
      objectset.rio.cattle.io/applied: H4sIAAAAAAAA/4yRQWvjMBCF/8oyZ9sbrxNjDHvI7qGH3lLopfQwksaxakVjpLFLG/LfixIKDaRJj2LmfU/z3h5wtI8UomUPLQSFusBJeg72HcWyL4YmFpZ/zyVkMFhvoIX/bopCYcOO/llvrN9CBjsSNCgI7R7Qe5ajPKYnqxfSEkmKYLnQKOIoMW2CQfbtnF89hXw7D9DCUMUvk7nMft1bb/6ujWF/E+FxR9CCY40uj8IBt/QjURxRJ+UwKcrjWxTawSEDh4rc1dN6jD20UDZVV610veo6patFvawXVbesunLVLEyj6wb/GFRmmaBnnxxR+nwMPNvUDIVcpegPGQR2tKHumPJo7wJP47XeLpYGt8ySSTKL0+k8aJ/2n5wHCrPVtNaaJy83UfG0nuPZ/sVcnw8fAQAA//9f/s3AjgIAAA
      objectset.rio.cattle.io/id: ""
      objectset.rio.cattle.io/owner-gvk: k3s.cattle.io/v1, Kind=Addon
      objectset.rio.cattle.io/owner-name: local-storage
      objectset.rio.cattle.io/owner-namespace: kube-system
    creationTimestamp: "2024-01-08T17:05:58Z"
    labels:
      objectset.rio.cattle.io/hash: 183f35c65ffbc3064603f43f1580d8c68a2dabd4
    name: local-path-provisioner-bind
    resourceVersion: "270"
    uid: 3847ebc1-fd46-4406-a419-a9d5884f731f
  roleRef:
    apiGroup: rbac.authorization.k8s.io
    kind: ClusterRole
    name: local-path-provisioner-role
  subjects:
  - kind: ServiceAccount
    name: local-path-provisioner-service-account
    namespace: kube-system
- apiVersion: rbac.authorization.k8s.io/v1
  kind: ClusterRole
  metadata:
    annotations:
      objectset.rio.cattle.io/applied: H4sIAAAAAAAA/4ySMY/bMAyF/0rBsZDdpE4Cw0CHokOHbh26FBloiY5Vy6Ig0j60h/z3QkaGO7R3l0mgHt5HUk+PgMn/oCyeI3SQe7Q1Ljpy9n9QPcd6aqX2/GHdg4HJRwcdfAmLKOXvHAgMzKToUBG6R8AYWTeflJL7X2RVSOvsubaoGqjAfKGAeVHnh0i5uqwTdDA18kRZ9+bdNx/dp8/OcXwTEXEm6CCwxVCJcsYL3WWShLY4p6WnSn6L0gxXAwF7Cq+uNqKM0MG+bYbmaE/HYehtszsdTrtmODTD/tjuXGtPLX502LtDgT4bMqGOVcq8+hIJ5SqXV74ayEsgge7nltjXzEsqFcDZQCbhJdtNhsiOBAykEqooRV05LDPZgH4uguU4+MuMSYp3pdxvvgspGAheyvGAakc4X81b3Si6xD7q/zpud+yet3l/F3Wlgnzqs5lQS3bphdFu6d7+6z/Im2wDitAdm5+vfwMAAP//OqHYBhsDAAA
      objectset.rio.cattle.io/id: ""
      objectset.rio.cattle.io/owner-gvk: k3s.cattle.io/v1, Kind=Addon
      objectset.rio.cattle.io/owner-name: local-storage
      objectset.rio.cattle.io/owner-namespace: kube-system
    creationTimestamp: "2024-01-08T17:05:58Z"
    labels:
      objectset.rio.cattle.io/hash: 183f35c65ffbc3064603f43f1580d8c68a2dabd4
    name: local-path-provisioner-role
    resourceVersion: "269"
    uid: 893c5c72-e93d-40cc-81b5-1779e96a6a92
  rules:
  - apiGroups:
    - ""
    resources:
    - nodes
    - persistentvolumeclaims
    - configmaps
    verbs:
    - get
    - list
    - watch
  - apiGroups:
    - ""
    resources:
    - endpoints
    - persistentvolumes
    - pods
    verbs:
    - '*'
  - apiGroups:
    - ""
    resources:
    - events
    verbs:
    - create
    - patch
  - apiGroups:
    - storage.k8s.io
    resources:
    - storageclasses
    verbs:
    - get
    - list
    - watch
...
</pre></div></li><li class='expandable detail-hide'>kube-system User k3s-cloud-controller-manager<div class='details'><pre>---
apiGroup: rbac.authorization.k8s.io
kind: User
name: k3s-cloud-controller-manager
namespace: kube-system
relatedObjects:
- apiVersion: rbac.authorization.k8s.io/v1
  kind: ClusterRoleBinding
  metadata:
    annotations:
      objectset.rio.cattle.io/applied: H4sIAAAAAAAA/4yRwU7jMBCGX2U15ySbNsnWtbSHXQ4cuFWCC+IwsaetieOJPE4RVH13lBYkDqX0aM3nz57/3wMO7oGiOA6gIbZoChzTlqN7w+Q4FJ2SwvHv3Qwy6FywoOHGj5IortjTfxesCxvIoKeEFhOC3gOGwOl4XaYjt89kklAqouPCYEqeJqebZJB9O+eXQDHf7DrQ0FXyZbKbZb/uXLB//1nL4UdFwJ5AgzH9VagMaCa+G1vK5VUS9XDIwGNL/uJCW5QtaGhKtaz/qKZuTFOreT2rzGJdNqSqBS1bpdblHG3ZzCfpx9e6SnLjebS54ZAie08x7zHghuKERfa0ovUx3MHdRh6HS3Wd7Qqufk3G04KgH/efonuheKXhRJ1N8enwHgAA//8jSlYUcgIAAA
      objectset.rio.cattle.io/id: ""
      objectset.rio.cattle.io/owner-gvk: k3s.cattle.io/v1, Kind=Addon
      objectset.rio.cattle.io/owner-name: ccm
      objectset.rio.cattle.io/owner-namespace: kube-system
    creationTimestamp: "2024-01-08T17:05:58Z"
    labels:
      objectset.rio.cattle.io/hash: 5089468545c5482413c7f05e837e9b88f02ad052
    name: k3s-cloud-controller-manager
    resourceVersion: "250"
    uid: 2c2e3ff7-2bbe-47ec-8fbb-cb7101f4a30d
  roleRef:
    apiGroup: rbac.authorization.k8s.io
    kind: ClusterRole
    name: k3s-cloud-controller-manager
  subjects:
  - apiGroup: rbac.authorization.k8s.io
    kind: User
    name: k3s-cloud-controller-manager
    namespace: kube-system
- apiVersion: rbac.authorization.k8s.io/v1
  kind: ClusterRole
  metadata:
    annotations:
      objectset.rio.cattle.io/applied: H4sIAAAAAAAA/5SST2/bMAzFv8rA42C7+efVNbDDsMMOu+2wy5ADLbGJZlk0RMpFV+S7D8raLWuaNjnZosgfnt7jA+DovlMUxwFaiB2aCpNuObpfqI5D1TdSOb6a5lBA74KFFj77JErxG3uCAgZStKgI7QNgCKz7OclH7n6SUSGtouPKoKqnDHOZAsXJe74LFMvN1EML/VIObqZ58e6rC/bjJ2s5vIkIOBC0YMxwVquMaHJ/nzoq5V6UBtgV4LEj/+qDtihbaKGeNTerD029qk29ahar+dJc385qapbXdNM1ze1sgXZWLzL0UVq/lNJ4TrY0HDSy9xTLAQNuKOa2mDwJtD/2QX2JnMZ8AsMcrQuHEcG6gEjCKZr9BHhCIcnliWK3L21IoQATCTVHl0abf9a74hn+iEUTBf2f9ZcyoprtRbTA9pmw92ePXYmiJoEChOLkzL/KIe+PpjOYT5D8DrYvueWd5M/dxcRjPZd49IhBYzidtD4rPMe4p92+CIPjKEcoizRwENK387NODE8U708tKAU7sgsq/sivF61f734HAAD//7yP5LevBAAA
      objectset.rio.cattle.io/id: ""
      objectset.rio.cattle.io/owner-gvk: k3s.cattle.io/v1, Kind=Addon
      objectset.rio.cattle.io/owner-name: ccm
      objectset.rio.cattle.io/owner-namespace: kube-system
    creationTimestamp: "2024-01-08T17:05:58Z"
    labels:
      objectset.rio.cattle.io/hash: 5089468545c5482413c7f05e837e9b88f02ad052
    name: k3s-cloud-controller-manager
    resourceVersion: "249"
    uid: 82336098-a683-40ef-9775-38963b14a3cb
  rules:
  - apiGroups:
    - coordination.k8s.io
    resources:
    - leases
    verbs:
    - get
    - create
    - update
  - apiGroups:
    - ""
    resources:
    - events
    verbs:
    - create
    - patch
    - update
  - apiGroups:
    - ""
    resources:
    - nodes
    verbs:
    - '*'
  - apiGroups:
    - ""
    resources:
    - nodes/status
    - services/status
    verbs:
    - patch
  - apiGroups:
    - ""
    resources:
    - services
    - pods
    verbs:
    - get
    - list
    - watch
  - apiGroups:
    - ""
    resources:
    - services
    verbs:
    - patch
    - update
  - apiGroups:
    - ""
    resources:
    - serviceaccounts
    verbs:
    - create
    - get
  - apiGroups:
    - ""
    resources:
    - namespaces
    verbs:
    - create
    - get
  - apiGroups:
    - apps
    resources:
    - daemonsets
    verbs:
    - '*'
  - apiGroups:
    - discovery.k8s.io
    resources:
    - endpointslices
    verbs:
    - get
    - list
    - watch
...
</pre></div></li></ul></div></div></div><div class='accordion-item'><div class='accordion-header' id='control_4_header'><button class='accordion-button collapsed' type='button' data-bs-toggle='collapse' data-bs-target='#control_4' aria-expanded='false' aria-controls='control_4'><div class='row'><div class='col'><h2 class='fs-4'>C-0009: Resource limits</h2><p class='mb-0'> CPU and memory resources should have a limit set for every container or a namespace to prevent resource exhaustion. This control identifies all the pods without resource limit definitions by checking their yaml definition file as well as their namespace LimitRange objects. It is also recommended to use ResourceQuota object to restrict overall namespace resources, but this is not verified by this control.</p></div></div></button></div><div id='control_4' class='accordion-collapse collapse' aria-labelledby='control_4_header' data-bs-parent='#report'><div class='accordion-body'><p>CPU and memory resources should have a limit set for every container or a namespace to prevent resource exhaustion. This control identifies all the pods without resource limit definitions by checking their yaml definition file as well as their namespace LimitRange objects. It is also recommended to use ResourceQuota object to restrict overall namespace resources, but this is not verified by this control.</p><h5>Detection</h5><p> Check for each container if there is a ‘limits’ field defined for both cpu and memory</p><h5>Remediation</h5><p>Define LimitRange and Resource Limits in the namespace or in the deployment/pod manifests.</p><h5>Checked paths and expected values</h5><ul><li>spec.template.spec.containers[*].resources.limits.cpu = YOUR_VALUE</li><li>spec.template.spec.containers[*].resources.limits.memory = YOUR_VALUE</li></ul><h5>Example</h5><pre>apiVersion: v1
kind: Pod
metadata:
  name: frontend
spec:
  containers:
  - name: app
    image: images.my-company.example/app:v4
    resources:
      requests:            #we make sure this is set
        memory: "64Mi"
        cpu: "250m"
      limits:
        memory: "128Mi"    #we make sure this is set
        cpu: "500m"
</pre><h5>Affected resources</h5><ul><li class='expandable detail-hide'>kube-system DaemonSet svclb-traefik-bf26f129<div class='details'><pre>---
apiVersion: apps/v1
kind: DaemonSet
metadata:
  annotations:
    deprecated.daemonset.template.generation: "1"
    objectset.rio.cattle.io/applied: H4sIAAAAAAAA/8RVwW7jNhD9lWLOsizb2tQR0EOQBEXQrmPY3l4WRjCiRjFriiTIkTZGoH8vKDtZpWsnQYFm4YNBzptH8r3RzCOglX+R89JoyACt9cNmBBFspS4ggyukyuglMURQEWOBjJA9AmptGFka7cPS5H+TYE8cO2ligcyKYmmGMnBAdDJuvmlyg/tmCxkMm1H0yx9SF78tyTVS0Jt5GiuCDNghlXL7Lri3KELOts5p4HeeqYI2AuGoe8xKVuQZKwuZrpWKQGFO6tUnbtBvIIPp5KwUuaBkPC4+FUif8snZ2Xla0oiwnEzPxfkEy18LARH4Rgij2RmlyMXbie+xaVOQJ0WCjYMMSlSe3kjxjfhBiHfgTyhxoPKNUPngQDjIy/FZORqfwz5+ItVbEkGp7/d/hApZbP58FhGtPU3ethEwVVYhU5fbq7d3GPQq98dJ2BMCazaVqTUfCvpCiLBamS1pyDpvIwiHoNTkPGRfH4F00/0f7rNcXN7NbxcriKBBVYetaQJt9AKwuJj9fr3sQZK4+w1fIK+ul6u7+eJ2ddtDri7nP2JeO69D3Mz7p42SOJ3Eo/EoHo8SaNcRyArvQ8ShFhtyw62S1pIbqDxrkjiNUzhg5rVSc6Ok2EEGN+XM8NyRJ83wXInBTWEH0wQisMbxXqZn1ebGMWTTJIKN8fx9dSzbGTbCqKdnryNw5E3tBIUCCsaRqJ3k3aXRTA/cFR5azKWSLGlfZUUB2VeYXa/uLq4+38xg3bZBnrd9S9PJxxr3rwN/lnPhGq9Yl6aTvnfd8ijB/+be+miq33nByvdN1cSxtE0aS3tXGvcNXdEXE9p1d4v+tz7rtVOIgI0i9zQ2w9deliQYMpiZpdhQUavQ7bcURA2jYOCMojj0F6eJyYfmU6FncmHa2cDVzYnrB+nZd27/F8pDoxtYhZpOMu85Lp1kKVBdFIXR/lar3fGEdeiEtS2QackOme53QdbQT6W+/9IF9hPi4YvGBqXCXBFkozAFdjaotniB7TorI9edk6J2jjTP6ion9/TQArIkgoK8dFQcC+lu77P0/sj2grDYQZa07T8BAAD//yoC/PIWCQAA
    objectset.rio.cattle.io/id: ""
    objectset.rio.cattle.io/owner-gvk: /v1, Kind=Service
    objectset.rio.cattle.io/owner-name: traefik
    objectset.rio.cattle.io/owner-namespace: kube-system
  creationTimestamp: "2024-01-08T17:06:48Z"
  generation: 1
  labels:
    objectset.rio.cattle.io/hash: 836fcbce022d5dae5b36694fe1eaf389c93af7dc
    svccontroller.k3s.cattle.io/nodeselector: "false"
    svccontroller.k3s.cattle.io/svcname: traefik
    svccontroller.k3s.cattle.io/svcnamespace: kube-system
  name: svclb-traefik-bf26f129
  namespace: kube-system
  resourceVersion: "615"
  uid: acc5b475-2181-4d70-b320-8de6f12fd45f
spec:
  revisionHistoryLimit: 10
  selector:
    matchLabels:
      app: svclb-traefik-bf26f129
  template:
    metadata:
      creationTimestamp: ~
      labels:
        app: svclb-traefik-bf26f129
        svccontroller.k3s.cattle.io/svcname: traefik
        svccontroller.k3s.cattle.io/svcnamespace: kube-system
    spec:
      automountServiceAccountToken: false
      containers:
      - name: lb-tcp-80
        image: rancher/klipper-lb:v0.4.4
        ports:
        - name: lb-tcp-80
          hostPort: 80
          containerPort: 80
          protocol: TCP
        env:
        - name: SRC_PORT
          value: XXXXXX
        - name: SRC_RANGES
          value: XXXXXX
        - name: DEST_PROTO
          value: XXXXXX
        - name: DEST_PORT
          value: XXXXXX
        - name: DEST_IPS
          value: XXXXXX
        resources: []
        terminationMessagePath: /dev/termination-log
        terminationMessagePolicy: File
        imagePullPolicy: IfNotPresent
        securityContext:
          capabilities:
            add:
            - NET_ADMIN
      - name: lb-tcp-443
        image: rancher/klipper-lb:v0.4.4
        ports:
        - name: lb-tcp-443
          hostPort: 443
          containerPort: 443
          protocol: TCP
        env:
        - name: SRC_PORT
          value: XXXXXX
        - name: SRC_RANGES
          value: XXXXXX
        - name: DEST_PROTO
          value: XXXXXX
        - name: DEST_PORT
          value: XXXXXX
        - name: DEST_IPS
          value: XXXXXX
        resources: []
        terminationMessagePath: /dev/termination-log
        terminationMessagePolicy: File
        imagePullPolicy: IfNotPresent
        securityContext:
          capabilities:
            add:
            - NET_ADMIN
      dnsPolicy: ClusterFirst
      restartPolicy: Always
      schedulerName: default-scheduler
      securityContext:
        sysctls:
        - name: net.ipv4.ip_forward
          value: "1"
      serviceAccount: svclb
      serviceAccountName: svclb
      terminationGracePeriodSeconds: 30
      tolerations:
      - effect: NoSchedule
        key: node-role.kubernetes.io/master
        operator: Exists
      - effect: NoSchedule
        key: node-role.kubernetes.io/control-plane
        operator: Exists
      - key: CriticalAddonsOnly
        operator: Exists
  updateStrategy:
    rollingUpdate:
      maxSurge: 0
      maxUnavailable: 1
    type: RollingUpdate
...
</pre></div></li><li class='expandable detail-hide'>kube-system Deployment local-path-provisioner<div class='details'><pre>---
apiVersion: apps/v1
kind: Deployment
metadata:
  annotations:
    deployment.kubernetes.io/revision: "1"
    objectset.rio.cattle.io/applied: H4sIAAAAAAAA/6xU3W7yRhB9lWqubQMfBCFLvUBJqlZNCEqU3kSoGtZj2LDeXe0Obizkd68Gm/yoIWmlXnl/Zs6emXPGB0Cv/6AQtbOQA3ofB/UIEthpW0AOV+SNayqyDAlUxFggI+QHQGsdI2tno2zd+pkUR+IsaJcpZDaUaTfQAgLJ2Xv3l6WQbuod5LAbx3c39Sj56Xdti5/nReHstxAWK4IcjFNo0sgu4Ib+VVL0qCRzt19TGpvIVEGbgME1mS9L22LcQg6j2bgcX6jpRVmu1Xg4nUyH43IyLkcXs2ExU9MZ/ihwXUwE9ANJj7xNfXC1luZTgO7+DJ/oSQmbQF38r1qKbG50pRnyYQKRDCl2QYIqZLW9ea0AvT//aivgHJBp0xwfcMZou3n0BTJ1YC+PFmvUBteGIB+1CXDjheP9h1g5p8qbU947t5j/wKUvVDnLqC2FCPmTbKsKxZJP59sXGYP4NE2Vs6XeQAIDYjXodv0ne47OwioBsvURuRdleXf152J+e/2wnF9eQwI1mj39ElwlZEpNprin8nW9RBbxTzVmb8q1bbtKQFfivxwCWrWlMPicc14Ps2H2YwJ9wnJvzNIZrRrI4bdy4XgZKHbD9513amf2Fd26veWuY5Use57v2/CG1R2kXSa0KyHug3ZBc3NpMMZFF9e5MLWuoFQFzVqhkXZTqLWiuVLy0uIrfmkfm2IXDAmwMxROP5CnA+xIir7s4Y9DH++saWSIvUSKteH6RUeO0CYHoLIkxZDDwj2oLRV7IwPfwRypBmcokzEKlpiizKyYKjiTeoOW/lfkCiMfdfgEcnVS52RlafstenHTP2Xtvduel6lt278DAAD//8i6p1C4BQAA
    objectset.rio.cattle.io/id: ""
    objectset.rio.cattle.io/owner-gvk: k3s.cattle.io/v1, Kind=Addon
    objectset.rio.cattle.io/owner-name: local-storage
    objectset.rio.cattle.io/owner-namespace: kube-system
  creationTimestamp: "2024-01-08T17:05:58Z"
  generation: 1
  labels:
    objectset.rio.cattle.io/hash: 183f35c65ffbc3064603f43f1580d8c68a2dabd4
  name: local-path-provisioner
  namespace: kube-system
  resourceVersion: "475"
  uid: 718c0dfe-3f1a-4b36-807a-d731f31753f6
spec:
  progressDeadlineSeconds: 600
  replicas: 1
  revisionHistoryLimit: 0
  selector:
    matchLabels:
      app: local-path-provisioner
  strategy:
    rollingUpdate:
      maxSurge: 25%
      maxUnavailable: 1
    type: RollingUpdate
  template:
    metadata:
      creationTimestamp: ~
      labels:
        app: local-path-provisioner
    spec:
      containers:
      - name: local-path-provisioner
        image: rancher/local-path-provisioner:v0.0.24
        command:
        - local-path-provisioner
        - start
        - --config
        - /etc/config/config.json
        env:
        - name: POD_NAMESPACE
          value: XXXXXX
          valueFrom:
            fieldRef:
              apiVersion: v1
              fieldPath: metadata.namespace
        resources: []
        volumeMounts:
        - name: config-volume
          mountPath: /etc/config/
        terminationMessagePath: /dev/termination-log
        terminationMessagePolicy: File
        imagePullPolicy: IfNotPresent
      dnsPolicy: ClusterFirst
      priorityClassName: system-node-critical
      restartPolicy: Always
      schedulerName: default-scheduler
      securityContext: []
      serviceAccount: local-path-provisioner-service-account
      serviceAccountName: local-path-provisioner-service-account
      terminationGracePeriodSeconds: 30
      tolerations:
      - key: CriticalAddonsOnly
        operator: Exists
      - effect: NoSchedule
        key: node-role.kubernetes.io/control-plane
        operator: Exists
      - effect: NoSchedule
        key: node-role.kubernetes.io/master
        operator: Exists
      volumes:
      - configMap:
          defaultMode: 420
          name: local-path-config
        name: config-volume
...
</pre></div></li><li class='expandable detail-hide'>kube-system Deployment traefik<div class='details'><pre>---
apiVersion: apps/v1
kind: Deployment
metadata:
  annotations:
    deployment.kubernetes.io/revision: "1"
    meta.helm.sh/release-name: traefik
    meta.helm.sh/release-namespace: kube-system
  creationTimestamp: "2024-01-08T17:06:48Z"
  generation: 1
  labels:
    app.kubernetes.io/instance: traefik-kube-system
    app.kubernetes.io/managed-by: Helm
    app.kubernetes.io/name: traefik
    helm.sh/chart: traefik-21.2.1_up21.2.0
  name: traefik
  namespace: kube-system
  resourceVersion: "629"
  uid: ec30998f-e81b-47de-aeae-3970de0b73a4
spec:
  progressDeadlineSeconds: 600
  replicas: 1
  revisionHistoryLimit: 10
  selector:
    matchLabels:
      app.kubernetes.io/instance: traefik-kube-system
      app.kubernetes.io/name: traefik
  strategy:
    rollingUpdate:
      maxSurge: 1
      maxUnavailable: 0
    type: RollingUpdate
  template:
    metadata:
      annotations:
        prometheus.io/path: /metrics
        prometheus.io/port: "9100"
        prometheus.io/scrape: "true"
      creationTimestamp: ~
      labels:
        app.kubernetes.io/instance: traefik-kube-system
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: traefik
        helm.sh/chart: traefik-21.2.1_up21.2.0
    spec:
      containers:
      - name: traefik
        image: rancher/mirrored-library-traefik:2.9.10
        args:
        - --global.checknewversion
        - --global.sendanonymoususage
        - --entrypoints.metrics.address=:9100/tcp
        - --entrypoints.traefik.address=:9000/tcp
        - --entrypoints.web.address=:8000/tcp
        - --entrypoints.websecure.address=:8443/tcp
        - --api.dashboard=true
        - --ping=true
        - --metrics.prometheus=true
        - --metrics.prometheus.entrypoint=metrics
        - --providers.kubernetescrd
        - --providers.kubernetesingress
        - --providers.kubernetesingress.ingressendpoint.publishedservice=kube-system/traefik
        - --entrypoints.websecure.http.tls=true
        ports:
        - name: metrics
          containerPort: 9100
          protocol: TCP
        - name: traefik
          containerPort: 9000
          protocol: TCP
        - name: web
          containerPort: 8000
          protocol: TCP
        - name: websecure
          containerPort: 8443
          protocol: TCP
        resources: []
        volumeMounts:
        - name: data
          mountPath: /data
        - name: tmp
          mountPath: /tmp
        livenessProbe:
          httpGet:
            path: /ping
            port: 9000
            scheme: HTTP
          initialDelaySeconds: 2
          timeoutSeconds: 2
          periodSeconds: 10
          successThreshold: 1
          failureThreshold: 3
        readinessProbe:
          httpGet:
            path: /ping
            port: 9000
            scheme: HTTP
          initialDelaySeconds: 2
          timeoutSeconds: 2
          periodSeconds: 10
          successThreshold: 1
          failureThreshold: 1
        terminationMessagePath: /dev/termination-log
        terminationMessagePolicy: File
        imagePullPolicy: IfNotPresent
        securityContext:
          capabilities:
            drop:
            - ALL
          runAsUser: 65532
          runAsGroup: 65532
          runAsNonRoot: true
          readOnlyRootFilesystem: true
      dnsPolicy: ClusterFirst
      priorityClassName: system-cluster-critical
      restartPolicy: Always
      schedulerName: default-scheduler
      securityContext:
        fsGroup: 65532
      serviceAccount: traefik
      serviceAccountName: traefik
      terminationGracePeriodSeconds: 60
      tolerations:
      - key: CriticalAddonsOnly
        operator: Exists
      - effect: NoSchedule
        key: node-role.kubernetes.io/control-plane
        operator: Exists
      - effect: NoSchedule
        key: node-role.kubernetes.io/master
        operator: Exists
      volumes:
      - emptyDir: []
        name: data
      - emptyDir: []
        name: tmp
...
</pre></div></li><li class='expandable detail-hide'>kube-system Job helm-install-traefik<div class='details'><pre>---
apiVersion: batch/v1
kind: Job
metadata:
  annotations:
    batch.kubernetes.io/job-tracking: ""
    objectset.rio.cattle.io/applied: H4sIAAAAAAAA/6xVUY/qNhP9K59Guk9fEgLZbCDSPgQIhd5diAK7alWtkDETcHHsyHZoVyv+e+WQezfb3m5vpb7ZzszxOeM5k1cgFXtCpZkUEMOOGHrsnfvgwImJPcTwo9yBAyUasieGQPwKRAhpiGFSaLuVu1+RGo3GU0x6lBjD0WOyx2z2EXnpUimMkpyjcumRKOMqPDBtVIMBzt8iyN8EKvdwPrVAnU/nvvO/z0zs7+bIy4kF/UccQUqEGIwiWLDTd4XrilCbc6p36OoXbbCEiwNUYUN9w0rUhpQVxKLm3AFOdsiboli6jVbt/Yl5c/pdPI5EHyEG6hejCElEBiEGe6RRfxRGNCLB4KZPgmERYFgQDAvLrNXYVJ0JbQjn7ttFH0jSFVLLe0foSRbFPSuZgbjv+74DBsuKE4P2+wd98IFkKQp2mF/lrOfJILy9C6NJMByPZuPx7ThIg4kfzobRKEgnfhCG09EoDGfRjT9OwptplM4G09HtdBTNhtPb//wBLh35tlMJE6g0xL+8AlEHu4C2lOCA62o0rjaKiQM4cOByR7h3reMUC1Jzk1+b++UOnh1AcW6Q2odZJg8pOHAmvO724sX5GvGU5uvFatk9ytNs1d3P0/uH7TRfPKV5B0sjVWi6cZN5km+29sp1lky6975//PcJnbCjMZWOe71Pr58fx2m+TDfpeptki8unnrYPT6+11L1WhzvoewOv//+6ahb+X0h/Q9wmyX9I/xXL5HEz32bJer2d5Ok0XW4Wyf26k1YQrrGbsFxts3z108+dGE+fqeNRXmuDyuOSEu70fe9m4Pme3+vfNpug3XSxZsni/jFPt9nqfjHpIir80iSXZwdYSQ7NKRH0iKp34qyqULm2FeOz7w29gburGd8P/EHgD/shtDlZzXkmOaMvEMOiWEqTKdQoDLwzNzigUMtaUbTdfnHgLHld4oOshbn2bmmXGTHWc60D3zAa1roR9j6unaRtmLWDvfvybEUJucc1cqRGKmsW+z5KoEHdTE0NMXAm6t+tQ5X1pTJfpazEjDBeKwQHNKozo5hQaq9edkbW26i6ytFd77ScnS+dHr+2qxbh+mu5RrkdczeuLtjhgVQ2R3SjW4Fv4d+S3gwIQ0zdlPryRwAAAP//DrZg0DIHAAA
    objectset.rio.cattle.io/id: helm-controller-chart-registration
    objectset.rio.cattle.io/owner-gvk: helm.cattle.io/v1, Kind=HelmChart
    objectset.rio.cattle.io/owner-name: traefik
    objectset.rio.cattle.io/owner-namespace: kube-system
  creationTimestamp: "2024-01-08T17:06:00Z"
  generation: 1
  labels:
    helmcharts.helm.cattle.io/chart: traefik
    objectset.rio.cattle.io/hash: c0f97ea7a25e3dec71957c7a3241a38f3e5fae5f
  name: helm-install-traefik
  namespace: kube-system
  resourceVersion: "598"
  uid: 2a591629-9af8-4949-b2dd-39bd02b148a4
spec:
  backoffLimit: 1000
  completionMode: NonIndexed
  completions: 1
  parallelism: 1
  selector:
    matchLabels:
      batch.kubernetes.io/controller-uid: 2a591629-9af8-4949-b2dd-39bd02b148a4
  suspend: false
  template:
    metadata:
      annotations:
        helmcharts.helm.cattle.io/configHash: SHA256=57C38B9FBB6B3E3C05F8793EC0355D9955F740BA54D7EF2D96D97F8D678F2B0E
      creationTimestamp: ~
      labels:
        batch.kubernetes.io/controller-uid: 2a591629-9af8-4949-b2dd-39bd02b148a4
        batch.kubernetes.io/job-name: helm-install-traefik
        controller-uid: 2a591629-9af8-4949-b2dd-39bd02b148a4
        helmcharts.helm.cattle.io/chart: traefik
        job-name: helm-install-traefik
    spec:
      containers:
      - name: helm
        image: rancher/klipper-helm:v0.8.2-build20230815
        args:
        - install
        - --set-string
        - global.systemDefaultRegistry=
        env:
        - name: NAME
          value: XXXXXX
        - name: VERSION
          value: XXXXXX
        - name: REPO
          value: XXXXXX
        - name: HELM_DRIVER
          value: XXXXXX
        - name: CHART_NAMESPACE
          value: XXXXXX
        - name: CHART
          value: XXXXXX
        - name: HELM_VERSION
          value: XXXXXX
        - name: TARGET_NAMESPACE
          value: XXXXXX
        - name: AUTH_PASS_CREDENTIALS
          value: XXXXXX
        - name: NO_PROXY
          value: XXXXXX
        - name: FAILURE_POLICY
          value: XXXXXX
        resources: []
        volumeMounts:
        - name: values
          mountPath: /config
        - name: content
          mountPath: /chart
        terminationMessagePath: /dev/termination-log
        terminationMessagePolicy: File
        imagePullPolicy: IfNotPresent
      dnsPolicy: ClusterFirst
      nodeSelector:
        kubernetes.io/os: linux
      restartPolicy: OnFailure
      schedulerName: default-scheduler
      securityContext: []
      serviceAccount: helm-traefik
      serviceAccountName: helm-traefik
      terminationGracePeriodSeconds: 30
      volumes:
      - name: values
        secret:
          defaultMode: 420
          secretName: chart-values-traefik
      - configMap:
          defaultMode: 420
          name: chart-content-traefik
        name: content
...
</pre></div></li><li class='expandable detail-hide'>kube-system Job helm-install-traefik-crd<div class='details'><pre>---
apiVersion: batch/v1
kind: Job
metadata:
  annotations:
    batch.kubernetes.io/job-tracking: ""
    objectset.rio.cattle.io/applied: H4sIAAAAAAAA/7RVUY/iNhD+K9VI99QkJCEsm0j3ELhQ6O0CCuyqVbVCxkzAxbEj26E9If575ZC7hu11e324t9ie7/P3jWcmZyAVe0almRSQwJYYeuidAnDgyMQOEvhZbsGBEg3ZEUMgOQMRQhpimBTaLuX2d6RGo/EUkx4lxnD0mOwxiz4gL10qhVGSc1QuPRBlXIV7po1qOMD5Vwb5h0Dl7k/HlqhzdAqcHz4ysXs/RV6OLel/8ghSIiRgFMGCHV2qdt8E0RWhFnest+jqT9pgCRcHqMJG/pqVqA0pK0hEzbkDnGyRN4mxkhu/2nulvtn9Zi0Hog+QQHRfFP3dgPaDYLjtD8OC7igZ+PEwHhRxEQ79kBT+IA6tutZrk30mtCGcu7eXvWFNV0it/i2hR1kUD6xkBpLA930HDJYVJwbt+Rs18YZ1KQq2n14traZpOLh7n/VH/jiKwvh+Mg7GQRSnk9EkGt/H8d1kFIdROEyzKMiiuygexf1onEbxII6D0fC7PMSlkwJbuYQJVBqS385A1N5+QJtSeHEAxak5ajM+Tx8zcOBEeP262C7Ol6jnLF/NFvPuVp4tF931NHt43HzIZ89Z3uHTSBWabtx4mubrjb12tUzH3btvX/UW0Ak7GFPppNd7d/74NMryebbOVpt0Obu862n7ovSaJN3reHHDwAu94Me6CoN/iP6KuXWa/5T9L5Xp03q6Waar1WacZx+y+XqWPqw6sIJwjV3AfLFZ5otffu3EePpEHY/yWhtUHpeUcCfwvSj0fM/vBXfNot8uulyTdPbwlGeb5eJhNu4yKvz88pcXB1hJ9s0uEfSAqnfkrKpQubbGkpPv3Xuhu60Z34V+2PfvgwG0mGXN+VJyRj9BArNiLs1SoUZh4KZzwQGFWtaKoi3jiwMnyesSH2UtzLUgS/u5JMY2U9taf3M0qnVj7DauHZdtmK1xe/flxZoScocr5EiNVLYD7PsogQZ1MxY1JMCZqP+0radswynzxcpCTAjjtUJwQKM6MYoppfbqeWce3c6hqyXd7aFWt/O52pNz+9WyXP8h1yj3Vec2LVuw/SOpLE50Ea3RW8jX0tBMAENM3aT98lcAAAD//411peIjBwAA
    objectset.rio.cattle.io/id: helm-controller-chart-registration
    objectset.rio.cattle.io/owner-gvk: helm.cattle.io/v1, Kind=HelmChart
    objectset.rio.cattle.io/owner-name: traefik-crd
    objectset.rio.cattle.io/owner-namespace: kube-system
  creationTimestamp: "2024-01-08T17:06:00Z"
  generation: 1
  labels:
    helmcharts.helm.cattle.io/chart: traefik-crd
    objectset.rio.cattle.io/hash: 48ff3d5c3117b372fcdca509795f9f2702af0592
  name: helm-install-traefik-crd
  namespace: kube-system
  resourceVersion: "588"
  uid: 655ceb1b-aaa8-4b24-92ab-fceb2ddd45bd
spec:
  backoffLimit: 1000
  completionMode: NonIndexed
  completions: 1
  parallelism: 1
  selector:
    matchLabels:
      batch.kubernetes.io/controller-uid: 655ceb1b-aaa8-4b24-92ab-fceb2ddd45bd
  suspend: false
  template:
    metadata:
      annotations:
        helmcharts.helm.cattle.io/configHash: SHA256=E3B0C44298FC1C149AFBF4C8996FB92427AE41E4649B934CA495991B7852B855
      creationTimestamp: ~
      labels:
        batch.kubernetes.io/controller-uid: 655ceb1b-aaa8-4b24-92ab-fceb2ddd45bd
        batch.kubernetes.io/job-name: helm-install-traefik-crd
        controller-uid: 655ceb1b-aaa8-4b24-92ab-fceb2ddd45bd
        helmcharts.helm.cattle.io/chart: traefik-crd
        job-name: helm-install-traefik-crd
    spec:
      containers:
      - name: helm
        image: rancher/klipper-helm:v0.8.2-build20230815
        args:
        - install
        env:
        - name: NAME
          value: XXXXXX
        - name: VERSION
          value: XXXXXX
        - name: REPO
          value: XXXXXX
        - name: HELM_DRIVER
          value: XXXXXX
        - name: CHART_NAMESPACE
          value: XXXXXX
        - name: CHART
          value: XXXXXX
        - name: HELM_VERSION
          value: XXXXXX
        - name: TARGET_NAMESPACE
          value: XXXXXX
        - name: AUTH_PASS_CREDENTIALS
          value: XXXXXX
        - name: NO_PROXY
          value: XXXXXX
        - name: FAILURE_POLICY
          value: XXXXXX
        resources: []
        volumeMounts:
        - name: values
          mountPath: /config
        - name: content
          mountPath: /chart
        terminationMessagePath: /dev/termination-log
        terminationMessagePolicy: File
        imagePullPolicy: IfNotPresent
      dnsPolicy: ClusterFirst
      nodeSelector:
        kubernetes.io/os: linux
      restartPolicy: OnFailure
      schedulerName: default-scheduler
      securityContext: []
      serviceAccount: helm-traefik-crd
      serviceAccountName: helm-traefik-crd
      terminationGracePeriodSeconds: 30
      volumes:
      - name: values
        secret:
          defaultMode: 420
          secretName: chart-values-traefik-crd
      - configMap:
          defaultMode: 420
          name: chart-content-traefik-crd
        name: content
...
</pre></div></li></ul></div></div></div><div class='accordion-item'><div class='accordion-header' id='control_5_header'><button class='accordion-button collapsed' type='button' data-bs-toggle='collapse' data-bs-target='#control_5' aria-expanded='false' aria-controls='control_5'><div class='row'><div class='col'><h2 class='fs-4'>C-0012: Applications credentials in configuration files</h2><p class='mb-0'> Attackers who have access to configuration files can steal the stored secrets and use them. This control checks if ConfigMaps or pod specifications have sensitive information in their configuration.</p></div></div></button></div><div id='control_5' class='accordion-collapse collapse' aria-labelledby='control_5_header' data-bs-parent='#report'><div class='accordion-body'><p>Developers store secrets in the Kubernetes configuration files, such as environment variables in the pod configuration. Such behavior is commonly seen in clusters that are monitored by Azure Security Center. Attackers who have access to those configurations, by querying the API server or by accessing those files on the developer’s endpoint, can steal the stored secrets and use them.</p><h5>Detection</h5><p>Check if the pod has sensitive information in environment variables, by using list of known sensitive key names. Check if there are configmaps with sensitive information.</p><h5>Remediation</h5><p>Use Kubernetes secrets or Key Management Systems to store credentials.</p><h5>Checked paths and expected values</h5><ul><li>spec.template.spec.containers[*].env[*].name</li></ul><h5>Affected resources</h5><ul><li class='expandable detail-hide'>kube-system Job helm-install-traefik<div class='details'><pre>---
apiVersion: batch/v1
kind: Job
metadata:
  annotations:
    batch.kubernetes.io/job-tracking: ""
    objectset.rio.cattle.io/applied: H4sIAAAAAAAA/6xVUY/qNhP9K59Guk9fEgLZbCDSPgQIhd5diAK7alWtkDETcHHsyHZoVyv+e+WQezfb3m5vpb7ZzszxOeM5k1cgFXtCpZkUEMOOGHrsnfvgwImJPcTwo9yBAyUasieGQPwKRAhpiGFSaLuVu1+RGo3GU0x6lBjD0WOyx2z2EXnpUimMkpyjcumRKOMqPDBtVIMBzt8iyN8EKvdwPrVAnU/nvvO/z0zs7+bIy4kF/UccQUqEGIwiWLDTd4XrilCbc6p36OoXbbCEiwNUYUN9w0rUhpQVxKLm3AFOdsiboli6jVbt/Yl5c/pdPI5EHyEG6hejCElEBiEGe6RRfxRGNCLB4KZPgmERYFgQDAvLrNXYVJ0JbQjn7ttFH0jSFVLLe0foSRbFPSuZgbjv+74DBsuKE4P2+wd98IFkKQp2mF/lrOfJILy9C6NJMByPZuPx7ThIg4kfzobRKEgnfhCG09EoDGfRjT9OwptplM4G09HtdBTNhtPb//wBLh35tlMJE6g0xL+8AlEHu4C2lOCA62o0rjaKiQM4cOByR7h3reMUC1Jzk1+b++UOnh1AcW6Q2odZJg8pOHAmvO724sX5GvGU5uvFatk9ytNs1d3P0/uH7TRfPKV5B0sjVWi6cZN5km+29sp1lky6975//PcJnbCjMZWOe71Pr58fx2m+TDfpeptki8unnrYPT6+11L1WhzvoewOv//+6ahb+X0h/Q9wmyX9I/xXL5HEz32bJer2d5Ok0XW4Wyf26k1YQrrGbsFxts3z108+dGE+fqeNRXmuDyuOSEu70fe9m4Pme3+vfNpug3XSxZsni/jFPt9nqfjHpIir80iSXZwdYSQ7NKRH0iKp34qyqULm2FeOz7w29gburGd8P/EHgD/shtDlZzXkmOaMvEMOiWEqTKdQoDLwzNzigUMtaUbTdfnHgLHld4oOshbn2bmmXGTHWc60D3zAa1roR9j6unaRtmLWDvfvybEUJucc1cqRGKmsW+z5KoEHdTE0NMXAm6t+tQ5X1pTJfpazEjDBeKwQHNKozo5hQaq9edkbW26i6ytFd77ScnS+dHr+2qxbh+mu5RrkdczeuLtjhgVQ2R3SjW4Fv4d+S3gwIQ0zdlPryRwAAAP//DrZg0DIHAAA
    objectset.rio.cattle.io/id: helm-controller-chart-registration
    objectset.rio.cattle.io/owner-gvk: helm.cattle.io/v1, Kind=HelmChart
    objectset.rio.cattle.io/owner-name: traefik
    objectset.rio.cattle.io/owner-namespace: kube-system
  creationTimestamp: "2024-01-08T17:06:00Z"
  generation: 1
  labels:
    helmcharts.helm.cattle.io/chart: traefik
    objectset.rio.cattle.io/hash: c0f97ea7a25e3dec71957c7a3241a38f3e5fae5f
  name: helm-install-traefik
  namespace: kube-system
  resourceVersion: "598"
  uid: 2a591629-9af8-4949-b2dd-39bd02b148a4
spec:
  backoffLimit: 1000
  completionMode: NonIndexed
  completions: 1
  parallelism: 1
  selector:
    matchLabels:
      batch.kubernetes.io/controller-uid: 2a591629-9af8-4949-b2dd-39bd02b148a4
  suspend: false
  template:
    metadata:
      annotations:
        helmcharts.helm.cattle.io/configHash: SHA256=57C38B9FBB6B3E3C05F8793EC0355D9955F740BA54D7EF2D96D97F8D678F2B0E
      creationTimestamp: ~
      labels:
        batch.kubernetes.io/controller-uid: 2a591629-9af8-4949-b2dd-39bd02b148a4
        batch.kubernetes.io/job-name: helm-install-traefik
        controller-uid: 2a591629-9af8-4949-b2dd-39bd02b148a4
        helmcharts.helm.cattle.io/chart: traefik
        job-name: helm-install-traefik
    spec:
      containers:
      - name: helm
        image: rancher/klipper-helm:v0.8.2-build20230815
        args:
        - install
        - --set-string
        - global.systemDefaultRegistry=
        env:
        - name: NAME
          value: XXXXXX
        - name: VERSION
          value: XXXXXX
        - name: REPO
          value: XXXXXX
        - name: HELM_DRIVER
          value: XXXXXX
        - name: CHART_NAMESPACE
          value: XXXXXX
        - name: CHART
          value: XXXXXX
        - name: HELM_VERSION
          value: XXXXXX
        - name: TARGET_NAMESPACE
          value: XXXXXX
        - name: AUTH_PASS_CREDENTIALS
          value: XXXXXX
        - name: NO_PROXY
          value: XXXXXX
        - name: FAILURE_POLICY
          value: XXXXXX
        resources: []
        volumeMounts:
        - name: values
          mountPath: /config
        - name: content
          mountPath: /chart
        terminationMessagePath: /dev/termination-log
        terminationMessagePolicy: File
        imagePullPolicy: IfNotPresent
      dnsPolicy: ClusterFirst
      nodeSelector:
        kubernetes.io/os: linux
      restartPolicy: OnFailure
      schedulerName: default-scheduler
      securityContext: []
      serviceAccount: helm-traefik
      serviceAccountName: helm-traefik
      terminationGracePeriodSeconds: 30
      volumes:
      - name: values
        secret:
          defaultMode: 420
          secretName: chart-values-traefik
      - configMap:
          defaultMode: 420
          name: chart-content-traefik
        name: content
...
</pre></div></li><li class='expandable detail-hide'>kube-system Job helm-install-traefik-crd<div class='details'><pre>---
apiVersion: batch/v1
kind: Job
metadata:
  annotations:
    batch.kubernetes.io/job-tracking: ""
    objectset.rio.cattle.io/applied: H4sIAAAAAAAA/7RVUY/iNhD+K9VI99QkJCEsm0j3ELhQ6O0CCuyqVbVCxkzAxbEj26E9If575ZC7hu11e324t9ie7/P3jWcmZyAVe0almRSQwJYYeuidAnDgyMQOEvhZbsGBEg3ZEUMgOQMRQhpimBTaLuX2d6RGo/EUkx4lxnD0mOwxiz4gL10qhVGSc1QuPRBlXIV7po1qOMD5Vwb5h0Dl7k/HlqhzdAqcHz4ysXs/RV6OLel/8ghSIiRgFMGCHV2qdt8E0RWhFnest+jqT9pgCRcHqMJG/pqVqA0pK0hEzbkDnGyRN4mxkhu/2nulvtn9Zi0Hog+QQHRfFP3dgPaDYLjtD8OC7igZ+PEwHhRxEQ79kBT+IA6tutZrk30mtCGcu7eXvWFNV0it/i2hR1kUD6xkBpLA930HDJYVJwbt+Rs18YZ1KQq2n14traZpOLh7n/VH/jiKwvh+Mg7GQRSnk9EkGt/H8d1kFIdROEyzKMiiuygexf1onEbxII6D0fC7PMSlkwJbuYQJVBqS385A1N5+QJtSeHEAxak5ajM+Tx8zcOBEeP262C7Ol6jnLF/NFvPuVp4tF931NHt43HzIZ89Z3uHTSBWabtx4mubrjb12tUzH3btvX/UW0Ak7GFPppNd7d/74NMryebbOVpt0Obu862n7ovSaJN3reHHDwAu94Me6CoN/iP6KuXWa/5T9L5Xp03q6Waar1WacZx+y+XqWPqw6sIJwjV3AfLFZ5otffu3EePpEHY/yWhtUHpeUcCfwvSj0fM/vBXfNot8uulyTdPbwlGeb5eJhNu4yKvz88pcXB1hJ9s0uEfSAqnfkrKpQubbGkpPv3Xuhu60Z34V+2PfvgwG0mGXN+VJyRj9BArNiLs1SoUZh4KZzwQGFWtaKoi3jiwMnyesSH2UtzLUgS/u5JMY2U9taf3M0qnVj7DauHZdtmK1xe/flxZoScocr5EiNVLYD7PsogQZ1MxY1JMCZqP+0radswynzxcpCTAjjtUJwQKM6MYoppfbqeWce3c6hqyXd7aFWt/O52pNz+9WyXP8h1yj3Vec2LVuw/SOpLE50Ea3RW8jX0tBMAENM3aT98lcAAAD//411peIjBwAA
    objectset.rio.cattle.io/id: helm-controller-chart-registration
    objectset.rio.cattle.io/owner-gvk: helm.cattle.io/v1, Kind=HelmChart
    objectset.rio.cattle.io/owner-name: traefik-crd
    objectset.rio.cattle.io/owner-namespace: kube-system
  creationTimestamp: "2024-01-08T17:06:00Z"
  generation: 1
  labels:
    helmcharts.helm.cattle.io/chart: traefik-crd
    objectset.rio.cattle.io/hash: 48ff3d5c3117b372fcdca509795f9f2702af0592
  name: helm-install-traefik-crd
  namespace: kube-system
  resourceVersion: "588"
  uid: 655ceb1b-aaa8-4b24-92ab-fceb2ddd45bd
spec:
  backoffLimit: 1000
  completionMode: NonIndexed
  completions: 1
  parallelism: 1
  selector:
    matchLabels:
      batch.kubernetes.io/controller-uid: 655ceb1b-aaa8-4b24-92ab-fceb2ddd45bd
  suspend: false
  template:
    metadata:
      annotations:
        helmcharts.helm.cattle.io/configHash: SHA256=E3B0C44298FC1C149AFBF4C8996FB92427AE41E4649B934CA495991B7852B855
      creationTimestamp: ~
      labels:
        batch.kubernetes.io/controller-uid: 655ceb1b-aaa8-4b24-92ab-fceb2ddd45bd
        batch.kubernetes.io/job-name: helm-install-traefik-crd
        controller-uid: 655ceb1b-aaa8-4b24-92ab-fceb2ddd45bd
        helmcharts.helm.cattle.io/chart: traefik-crd
        job-name: helm-install-traefik-crd
    spec:
      containers:
      - name: helm
        image: rancher/klipper-helm:v0.8.2-build20230815
        args:
        - install
        env:
        - name: NAME
          value: XXXXXX
        - name: VERSION
          value: XXXXXX
        - name: REPO
          value: XXXXXX
        - name: HELM_DRIVER
          value: XXXXXX
        - name: CHART_NAMESPACE
          value: XXXXXX
        - name: CHART
          value: XXXXXX
        - name: HELM_VERSION
          value: XXXXXX
        - name: TARGET_NAMESPACE
          value: XXXXXX
        - name: AUTH_PASS_CREDENTIALS
          value: XXXXXX
        - name: NO_PROXY
          value: XXXXXX
        - name: FAILURE_POLICY
          value: XXXXXX
        resources: []
        volumeMounts:
        - name: values
          mountPath: /config
        - name: content
          mountPath: /chart
        terminationMessagePath: /dev/termination-log
        terminationMessagePolicy: File
        imagePullPolicy: IfNotPresent
      dnsPolicy: ClusterFirst
      nodeSelector:
        kubernetes.io/os: linux
      restartPolicy: OnFailure
      schedulerName: default-scheduler
      securityContext: []
      serviceAccount: helm-traefik-crd
      serviceAccountName: helm-traefik-crd
      terminationGracePeriodSeconds: 30
      volumes:
      - name: values
        secret:
          defaultMode: 420
          secretName: chart-values-traefik-crd
      - configMap:
          defaultMode: 420
          name: chart-content-traefik-crd
        name: content
...
</pre></div></li></ul></div></div></div><div class='accordion-item'><div class='accordion-header' id='control_6_header'><button class='accordion-button collapsed' type='button' data-bs-toggle='collapse' data-bs-target='#control_6' aria-expanded='false' aria-controls='control_6'><div class='row'><div class='col'><h2 class='fs-4'>C-0013: Non-root containers</h2><p class='mb-0'> Potential attackers may gain access to a container and leverage its existing privileges to conduct an attack. Therefore, it is not recommended to deploy containers with root privileges unless it is absolutely necessary. This control identifies all the pods running as root or can escalate to root.</p></div></div></button></div><div id='control_6' class='accordion-collapse collapse' aria-labelledby='control_6_header' data-bs-parent='#report'><div class='accordion-body'><p>Container engines allow containers to run applications as a non-root user with non-root group membership. Typically, this non-default setting is configured when the container image is built. . Alternatively, Kubernetes can load containers into a Pod with SecurityContext:runAsUser specifying a non-zero user. While the runAsUser directive effectively forces non-root execution at deployment, NSA and CISA encourage developers to build container applications to execute as a non-root user. Having non-root execution integrated at build time provides better assurance that applications will function correctly without root privileges.</p><h5>Detection</h5><p>Verify if runAsUser  and runAsGroup are set to a user id greater than 999. Check that the allowPrivilegeEscalation field is set to false. Check all the combinations with PodSecurityContext and SecurityContext (for containers).</p><h5>Remediation</h5><p>If your application does not need root privileges, make sure to define the runAsUser or runAsGroup under the PodSecurityContext and use user ID 1000 or higher. Do not turn on allowPrivlegeEscalation bit and make sure runAsNonRoot is true.</p><h5>Checked paths and expected values</h5><ul><li>spec.template.spec.containers[*].securityContext.allowPrivilegeEscalation = false</li><li>spec.template.spec.containers[*].securityContext.runAsNonRoot = true</li></ul><h5>Example</h5><pre>apiVersion: v1
kind: Pod
metadata:
  name: security-context-demo
spec:
  securityContext:
    runAsUser: 1000   # we make sure this is greater than 999 and
    runAsGroup: 3000  # This value is greater than 999
    fsGroup: 2000
  containers:
  - name: sec-ctx-demo
    image: busybox
    command: [ "sh", "-c", "sleep 1h" ]
    securityContext:
      allowPrivilegeEscalation: false  #lastly, we check this is set to false</pre><h5>Affected resources</h5><ul><li class='expandable detail-hide'>kube-system DaemonSet svclb-traefik-bf26f129<div class='details'><pre>---
apiVersion: apps/v1
kind: DaemonSet
metadata:
  annotations:
    deprecated.daemonset.template.generation: "1"
    objectset.rio.cattle.io/applied: H4sIAAAAAAAA/8RVwW7jNhD9lWLOsizb2tQR0EOQBEXQrmPY3l4WRjCiRjFriiTIkTZGoH8vKDtZpWsnQYFm4YNBzptH8r3RzCOglX+R89JoyACt9cNmBBFspS4ggyukyuglMURQEWOBjJA9AmptGFka7cPS5H+TYE8cO2ligcyKYmmGMnBAdDJuvmlyg/tmCxkMm1H0yx9SF78tyTVS0Jt5GiuCDNghlXL7Lri3KELOts5p4HeeqYI2AuGoe8xKVuQZKwuZrpWKQGFO6tUnbtBvIIPp5KwUuaBkPC4+FUif8snZ2Xla0oiwnEzPxfkEy18LARH4Rgij2RmlyMXbie+xaVOQJ0WCjYMMSlSe3kjxjfhBiHfgTyhxoPKNUPngQDjIy/FZORqfwz5+ItVbEkGp7/d/hApZbP58FhGtPU3ethEwVVYhU5fbq7d3GPQq98dJ2BMCazaVqTUfCvpCiLBamS1pyDpvIwiHoNTkPGRfH4F00/0f7rNcXN7NbxcriKBBVYetaQJt9AKwuJj9fr3sQZK4+w1fIK+ul6u7+eJ2ddtDri7nP2JeO69D3Mz7p42SOJ3Eo/EoHo8SaNcRyArvQ8ShFhtyw62S1pIbqDxrkjiNUzhg5rVSc6Ok2EEGN+XM8NyRJ83wXInBTWEH0wQisMbxXqZn1ebGMWTTJIKN8fx9dSzbGTbCqKdnryNw5E3tBIUCCsaRqJ3k3aXRTA/cFR5azKWSLGlfZUUB2VeYXa/uLq4+38xg3bZBnrd9S9PJxxr3rwN/lnPhGq9Yl6aTvnfd8ijB/+be+miq33nByvdN1cSxtE0aS3tXGvcNXdEXE9p1d4v+tz7rtVOIgI0i9zQ2w9deliQYMpiZpdhQUavQ7bcURA2jYOCMojj0F6eJyYfmU6FncmHa2cDVzYnrB+nZd27/F8pDoxtYhZpOMu85Lp1kKVBdFIXR/lar3fGEdeiEtS2QackOme53QdbQT6W+/9IF9hPi4YvGBqXCXBFkozAFdjaotniB7TorI9edk6J2jjTP6ion9/TQArIkgoK8dFQcC+lu77P0/sj2grDYQZa07T8BAAD//yoC/PIWCQAA
    objectset.rio.cattle.io/id: ""
    objectset.rio.cattle.io/owner-gvk: /v1, Kind=Service
    objectset.rio.cattle.io/owner-name: traefik
    objectset.rio.cattle.io/owner-namespace: kube-system
  creationTimestamp: "2024-01-08T17:06:48Z"
  generation: 1
  labels:
    objectset.rio.cattle.io/hash: 836fcbce022d5dae5b36694fe1eaf389c93af7dc
    svccontroller.k3s.cattle.io/nodeselector: "false"
    svccontroller.k3s.cattle.io/svcname: traefik
    svccontroller.k3s.cattle.io/svcnamespace: kube-system
  name: svclb-traefik-bf26f129
  namespace: kube-system
  resourceVersion: "615"
  uid: acc5b475-2181-4d70-b320-8de6f12fd45f
spec:
  revisionHistoryLimit: 10
  selector:
    matchLabels:
      app: svclb-traefik-bf26f129
  template:
    metadata:
      creationTimestamp: ~
      labels:
        app: svclb-traefik-bf26f129
        svccontroller.k3s.cattle.io/svcname: traefik
        svccontroller.k3s.cattle.io/svcnamespace: kube-system
    spec:
      automountServiceAccountToken: false
      containers:
      - name: lb-tcp-80
        image: rancher/klipper-lb:v0.4.4
        ports:
        - name: lb-tcp-80
          hostPort: 80
          containerPort: 80
          protocol: TCP
        env:
        - name: SRC_PORT
          value: XXXXXX
        - name: SRC_RANGES
          value: XXXXXX
        - name: DEST_PROTO
          value: XXXXXX
        - name: DEST_PORT
          value: XXXXXX
        - name: DEST_IPS
          value: XXXXXX
        resources: []
        terminationMessagePath: /dev/termination-log
        terminationMessagePolicy: File
        imagePullPolicy: IfNotPresent
        securityContext:
          capabilities:
            add:
            - NET_ADMIN
      - name: lb-tcp-443
        image: rancher/klipper-lb:v0.4.4
        ports:
        - name: lb-tcp-443
          hostPort: 443
          containerPort: 443
          protocol: TCP
        env:
        - name: SRC_PORT
          value: XXXXXX
        - name: SRC_RANGES
          value: XXXXXX
        - name: DEST_PROTO
          value: XXXXXX
        - name: DEST_PORT
          value: XXXXXX
        - name: DEST_IPS
          value: XXXXXX
        resources: []
        terminationMessagePath: /dev/termination-log
        terminationMessagePolicy: File
        imagePullPolicy: IfNotPresent
        securityContext:
          capabilities:
            add:
            - NET_ADMIN
      dnsPolicy: ClusterFirst
      restartPolicy: Always
      schedulerName: default-scheduler
      securityContext:
        sysctls:
        - name: net.ipv4.ip_forward
          value: "1"
      serviceAccount: svclb
      serviceAccountName: svclb
      terminationGracePeriodSeconds: 30
      tolerations:
      - effect: NoSchedule
        key: node-role.kubernetes.io/master
        operator: Exists
      - effect: NoSchedule
        key: node-role.kubernetes.io/control-plane
        operator: Exists
      - key: CriticalAddonsOnly
        operator: Exists
  updateStrategy:
    rollingUpdate:
      maxSurge: 0
      maxUnavailable: 1
    type: RollingUpdate
...
</pre></div></li><li class='expandable detail-hide'>kube-system Deployment local-path-provisioner<div class='details'><pre>---
apiVersion: apps/v1
kind: Deployment
metadata:
  annotations:
    deployment.kubernetes.io/revision: "1"
    objectset.rio.cattle.io/applied: H4sIAAAAAAAA/6xU3W7yRhB9lWqubQMfBCFLvUBJqlZNCEqU3kSoGtZj2LDeXe0Obizkd68Gm/yoIWmlXnl/Zs6emXPGB0Cv/6AQtbOQA3ofB/UIEthpW0AOV+SNayqyDAlUxFggI+QHQGsdI2tno2zd+pkUR+IsaJcpZDaUaTfQAgLJ2Xv3l6WQbuod5LAbx3c39Sj56Xdti5/nReHstxAWK4IcjFNo0sgu4Ib+VVL0qCRzt19TGpvIVEGbgME1mS9L22LcQg6j2bgcX6jpRVmu1Xg4nUyH43IyLkcXs2ExU9MZ/ihwXUwE9ANJj7xNfXC1luZTgO7+DJ/oSQmbQF38r1qKbG50pRnyYQKRDCl2QYIqZLW9ea0AvT//aivgHJBp0xwfcMZou3n0BTJ1YC+PFmvUBteGIB+1CXDjheP9h1g5p8qbU947t5j/wKUvVDnLqC2FCPmTbKsKxZJP59sXGYP4NE2Vs6XeQAIDYjXodv0ne47OwioBsvURuRdleXf152J+e/2wnF9eQwI1mj39ElwlZEpNprin8nW9RBbxTzVmb8q1bbtKQFfivxwCWrWlMPicc14Ps2H2YwJ9wnJvzNIZrRrI4bdy4XgZKHbD9513amf2Fd26veWuY5Use57v2/CG1R2kXSa0KyHug3ZBc3NpMMZFF9e5MLWuoFQFzVqhkXZTqLWiuVLy0uIrfmkfm2IXDAmwMxROP5CnA+xIir7s4Y9DH++saWSIvUSKteH6RUeO0CYHoLIkxZDDwj2oLRV7IwPfwRypBmcokzEKlpiizKyYKjiTeoOW/lfkCiMfdfgEcnVS52RlafstenHTP2Xtvduel6lt278DAAD//8i6p1C4BQAA
    objectset.rio.cattle.io/id: ""
    objectset.rio.cattle.io/owner-gvk: k3s.cattle.io/v1, Kind=Addon
    objectset.rio.cattle.io/owner-name: local-storage
    objectset.rio.cattle.io/owner-namespace: kube-system
  creationTimestamp: "2024-01-08T17:05:58Z"
  generation: 1
  labels:
    objectset.rio.cattle.io/hash: 183f35c65ffbc3064603f43f1580d8c68a2dabd4
  name: local-path-provisioner
  namespace: kube-system
  resourceVersion: "475"
  uid: 718c0dfe-3f1a-4b36-807a-d731f31753f6
spec:
  progressDeadlineSeconds: 600
  replicas: 1
  revisionHistoryLimit: 0
  selector:
    matchLabels:
      app: local-path-provisioner
  strategy:
    rollingUpdate:
      maxSurge: 25%
      maxUnavailable: 1
    type: RollingUpdate
  template:
    metadata:
      creationTimestamp: ~
      labels:
        app: local-path-provisioner
    spec:
      containers:
      - name: local-path-provisioner
        image: rancher/local-path-provisioner:v0.0.24
        command:
        - local-path-provisioner
        - start
        - --config
        - /etc/config/config.json
        env:
        - name: POD_NAMESPACE
          value: XXXXXX
          valueFrom:
            fieldRef:
              apiVersion: v1
              fieldPath: metadata.namespace
        resources: []
        volumeMounts:
        - name: config-volume
          mountPath: /etc/config/
        terminationMessagePath: /dev/termination-log
        terminationMessagePolicy: File
        imagePullPolicy: IfNotPresent
      dnsPolicy: ClusterFirst
      priorityClassName: system-node-critical
      restartPolicy: Always
      schedulerName: default-scheduler
      securityContext: []
      serviceAccount: local-path-provisioner-service-account
      serviceAccountName: local-path-provisioner-service-account
      terminationGracePeriodSeconds: 30
      tolerations:
      - key: CriticalAddonsOnly
        operator: Exists
      - effect: NoSchedule
        key: node-role.kubernetes.io/control-plane
        operator: Exists
      - effect: NoSchedule
        key: node-role.kubernetes.io/master
        operator: Exists
      volumes:
      - configMap:
          defaultMode: 420
          name: local-path-config
        name: config-volume
...
</pre></div></li><li class='expandable detail-hide'>kube-system Deployment traefik<div class='details'><pre>---
apiVersion: apps/v1
kind: Deployment
metadata:
  annotations:
    deployment.kubernetes.io/revision: "1"
    meta.helm.sh/release-name: traefik
    meta.helm.sh/release-namespace: kube-system
  creationTimestamp: "2024-01-08T17:06:48Z"
  generation: 1
  labels:
    app.kubernetes.io/instance: traefik-kube-system
    app.kubernetes.io/managed-by: Helm
    app.kubernetes.io/name: traefik
    helm.sh/chart: traefik-21.2.1_up21.2.0
  name: traefik
  namespace: kube-system
  resourceVersion: "629"
  uid: ec30998f-e81b-47de-aeae-3970de0b73a4
spec:
  progressDeadlineSeconds: 600
  replicas: 1
  revisionHistoryLimit: 10
  selector:
    matchLabels:
      app.kubernetes.io/instance: traefik-kube-system
      app.kubernetes.io/name: traefik
  strategy:
    rollingUpdate:
      maxSurge: 1
      maxUnavailable: 0
    type: RollingUpdate
  template:
    metadata:
      annotations:
        prometheus.io/path: /metrics
        prometheus.io/port: "9100"
        prometheus.io/scrape: "true"
      creationTimestamp: ~
      labels:
        app.kubernetes.io/instance: traefik-kube-system
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: traefik
        helm.sh/chart: traefik-21.2.1_up21.2.0
    spec:
      containers:
      - name: traefik
        image: rancher/mirrored-library-traefik:2.9.10
        args:
        - --global.checknewversion
        - --global.sendanonymoususage
        - --entrypoints.metrics.address=:9100/tcp
        - --entrypoints.traefik.address=:9000/tcp
        - --entrypoints.web.address=:8000/tcp
        - --entrypoints.websecure.address=:8443/tcp
        - --api.dashboard=true
        - --ping=true
        - --metrics.prometheus=true
        - --metrics.prometheus.entrypoint=metrics
        - --providers.kubernetescrd
        - --providers.kubernetesingress
        - --providers.kubernetesingress.ingressendpoint.publishedservice=kube-system/traefik
        - --entrypoints.websecure.http.tls=true
        ports:
        - name: metrics
          containerPort: 9100
          protocol: TCP
        - name: traefik
          containerPort: 9000
          protocol: TCP
        - name: web
          containerPort: 8000
          protocol: TCP
        - name: websecure
          containerPort: 8443
          protocol: TCP
        resources: []
        volumeMounts:
        - name: data
          mountPath: /data
        - name: tmp
          mountPath: /tmp
        livenessProbe:
          httpGet:
            path: /ping
            port: 9000
            scheme: HTTP
          initialDelaySeconds: 2
          timeoutSeconds: 2
          periodSeconds: 10
          successThreshold: 1
          failureThreshold: 3
        readinessProbe:
          httpGet:
            path: /ping
            port: 9000
            scheme: HTTP
          initialDelaySeconds: 2
          timeoutSeconds: 2
          periodSeconds: 10
          successThreshold: 1
          failureThreshold: 1
        terminationMessagePath: /dev/termination-log
        terminationMessagePolicy: File
        imagePullPolicy: IfNotPresent
        securityContext:
          capabilities:
            drop:
            - ALL
          runAsUser: 65532
          runAsGroup: 65532
          runAsNonRoot: true
          readOnlyRootFilesystem: true
      dnsPolicy: ClusterFirst
      priorityClassName: system-cluster-critical
      restartPolicy: Always
      schedulerName: default-scheduler
      securityContext:
        fsGroup: 65532
      serviceAccount: traefik
      serviceAccountName: traefik
      terminationGracePeriodSeconds: 60
      tolerations:
      - key: CriticalAddonsOnly
        operator: Exists
      - effect: NoSchedule
        key: node-role.kubernetes.io/control-plane
        operator: Exists
      - effect: NoSchedule
        key: node-role.kubernetes.io/master
        operator: Exists
      volumes:
      - emptyDir: []
        name: data
      - emptyDir: []
        name: tmp
...
</pre></div></li><li class='expandable detail-hide'>kube-system Job helm-install-traefik<div class='details'><pre>---
apiVersion: batch/v1
kind: Job
metadata:
  annotations:
    batch.kubernetes.io/job-tracking: ""
    objectset.rio.cattle.io/applied: H4sIAAAAAAAA/6xVUY/qNhP9K59Guk9fEgLZbCDSPgQIhd5diAK7alWtkDETcHHsyHZoVyv+e+WQezfb3m5vpb7ZzszxOeM5k1cgFXtCpZkUEMOOGHrsnfvgwImJPcTwo9yBAyUasieGQPwKRAhpiGFSaLuVu1+RGo3GU0x6lBjD0WOyx2z2EXnpUimMkpyjcumRKOMqPDBtVIMBzt8iyN8EKvdwPrVAnU/nvvO/z0zs7+bIy4kF/UccQUqEGIwiWLDTd4XrilCbc6p36OoXbbCEiwNUYUN9w0rUhpQVxKLm3AFOdsiboli6jVbt/Yl5c/pdPI5EHyEG6hejCElEBiEGe6RRfxRGNCLB4KZPgmERYFgQDAvLrNXYVJ0JbQjn7ttFH0jSFVLLe0foSRbFPSuZgbjv+74DBsuKE4P2+wd98IFkKQp2mF/lrOfJILy9C6NJMByPZuPx7ThIg4kfzobRKEgnfhCG09EoDGfRjT9OwptplM4G09HtdBTNhtPb//wBLh35tlMJE6g0xL+8AlEHu4C2lOCA62o0rjaKiQM4cOByR7h3reMUC1Jzk1+b++UOnh1AcW6Q2odZJg8pOHAmvO724sX5GvGU5uvFatk9ytNs1d3P0/uH7TRfPKV5B0sjVWi6cZN5km+29sp1lky6975//PcJnbCjMZWOe71Pr58fx2m+TDfpeptki8unnrYPT6+11L1WhzvoewOv//+6ahb+X0h/Q9wmyX9I/xXL5HEz32bJer2d5Ok0XW4Wyf26k1YQrrGbsFxts3z108+dGE+fqeNRXmuDyuOSEu70fe9m4Pme3+vfNpug3XSxZsni/jFPt9nqfjHpIir80iSXZwdYSQ7NKRH0iKp34qyqULm2FeOz7w29gburGd8P/EHgD/shtDlZzXkmOaMvEMOiWEqTKdQoDLwzNzigUMtaUbTdfnHgLHld4oOshbn2bmmXGTHWc60D3zAa1roR9j6unaRtmLWDvfvybEUJucc1cqRGKmsW+z5KoEHdTE0NMXAm6t+tQ5X1pTJfpazEjDBeKwQHNKozo5hQaq9edkbW26i6ytFd77ScnS+dHr+2qxbh+mu5RrkdczeuLtjhgVQ2R3SjW4Fv4d+S3gwIQ0zdlPryRwAAAP//DrZg0DIHAAA
    objectset.rio.cattle.io/id: helm-controller-chart-registration
    objectset.rio.cattle.io/owner-gvk: helm.cattle.io/v1, Kind=HelmChart
    objectset.rio.cattle.io/owner-name: traefik
    objectset.rio.cattle.io/owner-namespace: kube-system
  creationTimestamp: "2024-01-08T17:06:00Z"
  generation: 1
  labels:
    helmcharts.helm.cattle.io/chart: traefik
    objectset.rio.cattle.io/hash: c0f97ea7a25e3dec71957c7a3241a38f3e5fae5f
  name: helm-install-traefik
  namespace: kube-system
  resourceVersion: "598"
  uid: 2a591629-9af8-4949-b2dd-39bd02b148a4
spec:
  backoffLimit: 1000
  completionMode: NonIndexed
  completions: 1
  parallelism: 1
  selector:
    matchLabels:
      batch.kubernetes.io/controller-uid: 2a591629-9af8-4949-b2dd-39bd02b148a4
  suspend: false
  template:
    metadata:
      annotations:
        helmcharts.helm.cattle.io/configHash: SHA256=57C38B9FBB6B3E3C05F8793EC0355D9955F740BA54D7EF2D96D97F8D678F2B0E
      creationTimestamp: ~
      labels:
        batch.kubernetes.io/controller-uid: 2a591629-9af8-4949-b2dd-39bd02b148a4
        batch.kubernetes.io/job-name: helm-install-traefik
        controller-uid: 2a591629-9af8-4949-b2dd-39bd02b148a4
        helmcharts.helm.cattle.io/chart: traefik
        job-name: helm-install-traefik
    spec:
      containers:
      - name: helm
        image: rancher/klipper-helm:v0.8.2-build20230815
        args:
        - install
        - --set-string
        - global.systemDefaultRegistry=
        env:
        - name: NAME
          value: XXXXXX
        - name: VERSION
          value: XXXXXX
        - name: REPO
          value: XXXXXX
        - name: HELM_DRIVER
          value: XXXXXX
        - name: CHART_NAMESPACE
          value: XXXXXX
        - name: CHART
          value: XXXXXX
        - name: HELM_VERSION
          value: XXXXXX
        - name: TARGET_NAMESPACE
          value: XXXXXX
        - name: AUTH_PASS_CREDENTIALS
          value: XXXXXX
        - name: NO_PROXY
          value: XXXXXX
        - name: FAILURE_POLICY
          value: XXXXXX
        resources: []
        volumeMounts:
        - name: values
          mountPath: /config
        - name: content
          mountPath: /chart
        terminationMessagePath: /dev/termination-log
        terminationMessagePolicy: File
        imagePullPolicy: IfNotPresent
      dnsPolicy: ClusterFirst
      nodeSelector:
        kubernetes.io/os: linux
      restartPolicy: OnFailure
      schedulerName: default-scheduler
      securityContext: []
      serviceAccount: helm-traefik
      serviceAccountName: helm-traefik
      terminationGracePeriodSeconds: 30
      volumes:
      - name: values
        secret:
          defaultMode: 420
          secretName: chart-values-traefik
      - configMap:
          defaultMode: 420
          name: chart-content-traefik
        name: content
...
</pre></div></li><li class='expandable detail-hide'>kube-system Job helm-install-traefik-crd<div class='details'><pre>---
apiVersion: batch/v1
kind: Job
metadata:
  annotations:
    batch.kubernetes.io/job-tracking: ""
    objectset.rio.cattle.io/applied: H4sIAAAAAAAA/7RVUY/iNhD+K9VI99QkJCEsm0j3ELhQ6O0CCuyqVbVCxkzAxbEj26E9If575ZC7hu11e324t9ie7/P3jWcmZyAVe0almRSQwJYYeuidAnDgyMQOEvhZbsGBEg3ZEUMgOQMRQhpimBTaLuX2d6RGo/EUkx4lxnD0mOwxiz4gL10qhVGSc1QuPRBlXIV7po1qOMD5Vwb5h0Dl7k/HlqhzdAqcHz4ysXs/RV6OLel/8ghSIiRgFMGCHV2qdt8E0RWhFnest+jqT9pgCRcHqMJG/pqVqA0pK0hEzbkDnGyRN4mxkhu/2nulvtn9Zi0Hog+QQHRfFP3dgPaDYLjtD8OC7igZ+PEwHhRxEQ79kBT+IA6tutZrk30mtCGcu7eXvWFNV0it/i2hR1kUD6xkBpLA930HDJYVJwbt+Rs18YZ1KQq2n14traZpOLh7n/VH/jiKwvh+Mg7GQRSnk9EkGt/H8d1kFIdROEyzKMiiuygexf1onEbxII6D0fC7PMSlkwJbuYQJVBqS385A1N5+QJtSeHEAxak5ajM+Tx8zcOBEeP262C7Ol6jnLF/NFvPuVp4tF931NHt43HzIZ89Z3uHTSBWabtx4mubrjb12tUzH3btvX/UW0Ak7GFPppNd7d/74NMryebbOVpt0Obu862n7ovSaJN3reHHDwAu94Me6CoN/iP6KuXWa/5T9L5Xp03q6Waar1WacZx+y+XqWPqw6sIJwjV3AfLFZ5otffu3EePpEHY/yWhtUHpeUcCfwvSj0fM/vBXfNot8uulyTdPbwlGeb5eJhNu4yKvz88pcXB1hJ9s0uEfSAqnfkrKpQubbGkpPv3Xuhu60Z34V+2PfvgwG0mGXN+VJyRj9BArNiLs1SoUZh4KZzwQGFWtaKoi3jiwMnyesSH2UtzLUgS/u5JMY2U9taf3M0qnVj7DauHZdtmK1xe/flxZoScocr5EiNVLYD7PsogQZ1MxY1JMCZqP+0radswynzxcpCTAjjtUJwQKM6MYoppfbqeWce3c6hqyXd7aFWt/O52pNz+9WyXP8h1yj3Vec2LVuw/SOpLE50Ea3RW8jX0tBMAENM3aT98lcAAAD//411peIjBwAA
    objectset.rio.cattle.io/id: helm-controller-chart-registration
    objectset.rio.cattle.io/owner-gvk: helm.cattle.io/v1, Kind=HelmChart
    objectset.rio.cattle.io/owner-name: traefik-crd
    objectset.rio.cattle.io/owner-namespace: kube-system
  creationTimestamp: "2024-01-08T17:06:00Z"
  generation: 1
  labels:
    helmcharts.helm.cattle.io/chart: traefik-crd
    objectset.rio.cattle.io/hash: 48ff3d5c3117b372fcdca509795f9f2702af0592
  name: helm-install-traefik-crd
  namespace: kube-system
  resourceVersion: "588"
  uid: 655ceb1b-aaa8-4b24-92ab-fceb2ddd45bd
spec:
  backoffLimit: 1000
  completionMode: NonIndexed
  completions: 1
  parallelism: 1
  selector:
    matchLabels:
      batch.kubernetes.io/controller-uid: 655ceb1b-aaa8-4b24-92ab-fceb2ddd45bd
  suspend: false
  template:
    metadata:
      annotations:
        helmcharts.helm.cattle.io/configHash: SHA256=E3B0C44298FC1C149AFBF4C8996FB92427AE41E4649B934CA495991B7852B855
      creationTimestamp: ~
      labels:
        batch.kubernetes.io/controller-uid: 655ceb1b-aaa8-4b24-92ab-fceb2ddd45bd
        batch.kubernetes.io/job-name: helm-install-traefik-crd
        controller-uid: 655ceb1b-aaa8-4b24-92ab-fceb2ddd45bd
        helmcharts.helm.cattle.io/chart: traefik-crd
        job-name: helm-install-traefik-crd
    spec:
      containers:
      - name: helm
        image: rancher/klipper-helm:v0.8.2-build20230815
        args:
        - install
        env:
        - name: NAME
          value: XXXXXX
        - name: VERSION
          value: XXXXXX
        - name: REPO
          value: XXXXXX
        - name: HELM_DRIVER
          value: XXXXXX
        - name: CHART_NAMESPACE
          value: XXXXXX
        - name: CHART
          value: XXXXXX
        - name: HELM_VERSION
          value: XXXXXX
        - name: TARGET_NAMESPACE
          value: XXXXXX
        - name: AUTH_PASS_CREDENTIALS
          value: XXXXXX
        - name: NO_PROXY
          value: XXXXXX
        - name: FAILURE_POLICY
          value: XXXXXX
        resources: []
        volumeMounts:
        - name: values
          mountPath: /config
        - name: content
          mountPath: /chart
        terminationMessagePath: /dev/termination-log
        terminationMessagePolicy: File
        imagePullPolicy: IfNotPresent
      dnsPolicy: ClusterFirst
      nodeSelector:
        kubernetes.io/os: linux
      restartPolicy: OnFailure
      schedulerName: default-scheduler
      securityContext: []
      serviceAccount: helm-traefik-crd
      serviceAccountName: helm-traefik-crd
      terminationGracePeriodSeconds: 30
      volumes:
      - name: values
        secret:
          defaultMode: 420
          secretName: chart-values-traefik-crd
      - configMap:
          defaultMode: 420
          name: chart-content-traefik-crd
        name: content
...
</pre></div></li></ul></div></div></div><div class='accordion-item'><div class='accordion-header' id='control_7_header'><button class='accordion-button collapsed' type='button' data-bs-toggle='collapse' data-bs-target='#control_7' aria-expanded='false' aria-controls='control_7'><div class='row'><div class='col'><h2 class='fs-4'>C-0015: List Kubernetes secrets</h2><p class='mb-0'> Attackers who have permissions to access secrets can access sensitive information that might include credentials to various services. This control determines which user, group or service account can list/get secrets.</p></div></div></button></div><div id='control_7' class='accordion-collapse collapse' aria-labelledby='control_7_header' data-bs-parent='#report'><div class='accordion-body'><p>A Kubernetes secret is an object that lets users store and manage sensitive information, such as passwords and connection strings in the cluster. Secrets can be consumed by reference in the pod configuration. Attackers who have permissions to retrieve the secrets from the API server (by using the pod service account, for example) can access sensitive information that might include credentials to various services.</p><h5>Detection</h5><p>Alerting on users  which have get/list/watch RBAC permissions on secrets. </p><h5>Remediation</h5><p>Monitor and approve list of users, groups and service accounts that can access secrets. Use exception mechanism to prevent repetitive the notifications.</p><h5>Checked paths and expected values</h5><ul><li>relatedObjects[*].roleRef.name</li><li>relatedObjects[*].rules[*].apiGroups[*]</li><li>relatedObjects[*].rules[*].resources[*]</li><li>relatedObjects[*].rules[*].verbs[*]</li><li>relatedObjects[*].subjects[*]</li></ul><h5>Example</h5><pre>kind: Role
apiVersion: rbac.authorization.k8s.io/v1
metadata:
  namespace: default
  name: pod-exec
rules:
- apiGroups: ["*"]
  resources: ["secrets"] # we look for this resource or *
  verbs: ["get","list","watch"]	   # we look for this verb or * 	</pre><h5>Affected resources</h5><ul><li class='expandable detail-hide'>kube-system ServiceAccount helm-traefik<div class='details'><pre>---
kind: ServiceAccount
name: helm-traefik
namespace: kube-system
relatedObjects:
- apiVersion: rbac.authorization.k8s.io/v1
  kind: ClusterRoleBinding
  metadata:
    annotations:
      objectset.rio.cattle.io/applied: H4sIAAAAAAAA/4yRze6TUBDFX8XMGlD+SGhJXGgXmrirxo1xMVyGMnI/yNwBo03f3UBbrYmtLu/H+c2Zc46AI38iiRw81CANmgwn7YPwD1QOPhs2MePwfM4hgYF9CzXs7BSVZB8svWHfsj9AAo4UW1SE+gjofdBVHpdjaL6S0UiaCYfMoKqlhckLrCfrUhO8SrCWJDU9iqZCB44qKwOSu4TwzZOkh3m4gG6e5jx59p59++odWbdboP/keHQENaggdTz81/c4olk0w9RQGr9HJQenBIzQav0jO4qKboTaT9YmYLEh+zCUHmMPNZgX3bYirPCppKIlU+XbsjIVFk8vcyw2XUFlh1R2y7SL7zXJGyPpdZFTAhIs7albyxn5rYRpfFT3X7uGX5PM+TLF1rFf8HE6bwP15+NV+YFkZkOvjQmTV/jT5u+M76b45fQzAAD//6tHuTCdAgAA
      objectset.rio.cattle.io/id: helm-controller-chart-registration
      objectset.rio.cattle.io/owner-gvk: helm.cattle.io/v1, Kind=HelmChart
      objectset.rio.cattle.io/owner-name: traefik
      objectset.rio.cattle.io/owner-namespace: kube-system
    creationTimestamp: "2024-01-08T17:06:00Z"
    labels:
      objectset.rio.cattle.io/hash: c0f97ea7a25e3dec71957c7a3241a38f3e5fae5f
    name: helm-kube-system-traefik
    resourceVersion: "349"
    uid: a815f9db-1d48-4564-a669-936f12c9a7ec
  roleRef:
    apiGroup: rbac.authorization.k8s.io
    kind: ClusterRole
    name: cluster-admin
  subjects:
  - kind: ServiceAccount
    name: helm-traefik
    namespace: kube-system
- apiVersion: rbac.authorization.k8s.io/v1
  kind: ClusterRole
  metadata:
    annotations:
      rbac.authorization.kubernetes.io/autoupdate: "true"
    creationTimestamp: "2024-01-08T17:05:54Z"
    labels:
      kubernetes.io/bootstrapping: rbac-defaults
    name: cluster-admin
    resourceVersion: "72"
    uid: 7a564a7b-9ca4-49ce-8a42-78660cb44f4c
  rules:
  - apiGroups:
    - '*'
    resources:
    - '*'
    verbs:
    - '*'
  - nonResourceURLs:
    - '*'
    verbs:
    - '*'
...
</pre></div></li><li class='expandable detail-hide'>kube-system ServiceAccount helm-traefik-crd<div class='details'><pre>---
kind: ServiceAccount
name: helm-traefik-crd
namespace: kube-system
relatedObjects:
- apiVersion: rbac.authorization.k8s.io/v1
  kind: ClusterRoleBinding
  metadata:
    annotations:
      objectset.rio.cattle.io/applied: H4sIAAAAAAAA/4yRzY7UQAyEXwX5nA7zw2g2kTjAHkDitiAuiIPT7Z6Y9E/kdoJgNO+Okl3QrMQuHLut+lyuOgOO/JmkcE7QgnRoa5y0z8I/UTmnergpNeeX8xYqGDg5aOE2TEVJ7nKgt5wcpxNUEEnRoSK0Z8CUsq7ysjxz942sFtJaONcWVQMtTF5gPYVobE4qOQQSY3sUNUInLiorA6onCfl7IjGneXgAXY3mbfXiAyf3+j2FeLtA/8lJGAlaUEHyPBgr7r8kZUS76IapI1N+FKUIlwqs0Gr/E0cqinGENk0hVBCwo/BsMD2WHlp4deP93h3sfrs9dvvjzltn8bBpjs3BN3533OzQbw7Nbtn24H1N88qIuT7mUoHkQHfk15JGfid5Gp+r/a+dw59t9v7ToIucFnyZ7i+C9sv5t/IjycyW3libp6Tw2OrjrJ9M8+vlVwAAAP//b1bdJakCAAA
      objectset.rio.cattle.io/id: helm-controller-chart-registration
      objectset.rio.cattle.io/owner-gvk: helm.cattle.io/v1, Kind=HelmChart
      objectset.rio.cattle.io/owner-name: traefik-crd
      objectset.rio.cattle.io/owner-namespace: kube-system
    creationTimestamp: "2024-01-08T17:06:00Z"
    labels:
      objectset.rio.cattle.io/hash: 48ff3d5c3117b372fcdca509795f9f2702af0592
    name: helm-kube-system-traefik-crd
    resourceVersion: "348"
    uid: 31be0c7e-dd79-49c6-9a13-77f5f124746c
  roleRef:
    apiGroup: rbac.authorization.k8s.io
    kind: ClusterRole
    name: cluster-admin
  subjects:
  - kind: ServiceAccount
    name: helm-traefik-crd
    namespace: kube-system
- apiVersion: rbac.authorization.k8s.io/v1
  kind: ClusterRole
  metadata:
    annotations:
      rbac.authorization.kubernetes.io/autoupdate: "true"
    creationTimestamp: "2024-01-08T17:05:54Z"
    labels:
      kubernetes.io/bootstrapping: rbac-defaults
    name: cluster-admin
    resourceVersion: "72"
    uid: 7a564a7b-9ca4-49ce-8a42-78660cb44f4c
  rules:
  - apiGroups:
    - '*'
    resources:
    - '*'
    verbs:
    - '*'
  - nonResourceURLs:
    - '*'
    verbs:
    - '*'
...
</pre></div></li><li class='expandable detail-hide'>kube-system ServiceAccount traefik<div class='details'><pre>---
kind: ServiceAccount
name: traefik
namespace: kube-system
relatedObjects:
- apiVersion: rbac.authorization.k8s.io/v1
  kind: ClusterRoleBinding
  metadata:
    annotations:
      meta.helm.sh/release-name: traefik
      meta.helm.sh/release-namespace: kube-system
    creationTimestamp: "2024-01-08T17:06:48Z"
    labels:
      app.kubernetes.io/instance: traefik-kube-system
      app.kubernetes.io/managed-by: Helm
      app.kubernetes.io/name: traefik
      helm.sh/chart: traefik-21.2.1_up21.2.0
    name: traefik-kube-system
    resourceVersion: "546"
    uid: 3b79bfea-e538-4ca3-ab2c-6486126d79ed
  roleRef:
    apiGroup: rbac.authorization.k8s.io
    kind: ClusterRole
    name: traefik-kube-system
  subjects:
  - kind: ServiceAccount
    name: traefik
    namespace: kube-system
- apiVersion: rbac.authorization.k8s.io/v1
  kind: ClusterRole
  metadata:
    annotations:
      meta.helm.sh/release-name: traefik
      meta.helm.sh/release-namespace: kube-system
    creationTimestamp: "2024-01-08T17:06:48Z"
    labels:
      app.kubernetes.io/instance: traefik-kube-system
      app.kubernetes.io/managed-by: Helm
      app.kubernetes.io/name: traefik
      helm.sh/chart: traefik-21.2.1_up21.2.0
    name: traefik-kube-system
    resourceVersion: "545"
    uid: 8564701d-a4e1-451e-baa7-2905263b21c5
  rules:
  - apiGroups:
    - extensions
    - networking.k8s.io
    resources:
    - ingressclasses
    - ingresses
    verbs:
    - get
    - list
    - watch
  - apiGroups:
    - ""
    resources:
    - services
    - endpoints
    - secrets
    verbs:
    - get
    - list
    - watch
  - apiGroups:
    - extensions
    - networking.k8s.io
    resources:
    - ingresses/status
    verbs:
    - update
  - apiGroups:
    - traefik.containo.us
    resources:
    - ingressroutes
    - ingressroutetcps
    - ingressrouteudps
    - middlewares
    - middlewaretcps
    - tlsoptions
    - tlsstores
    - traefikservices
    - serverstransports
    verbs:
    - get
    - list
    - watch
...
</pre></div></li></ul></div></div></div><div class='accordion-item'><div class='accordion-header' id='control_8_header'><button class='accordion-button collapsed' type='button' data-bs-toggle='collapse' data-bs-target='#control_8' aria-expanded='false' aria-controls='control_8'><div class='row'><div class='col'><h2 class='fs-4'>C-0016: Allow privilege escalation</h2><p class='mb-0'> Attackers may gain access to a container and uplift its privilege to enable excessive capabilities.</p></div></div></button></div><div id='control_8' class='accordion-collapse collapse' aria-labelledby='control_8_header' data-bs-parent='#report'><div class='accordion-body'><h5>Detection</h5><p> Check that the allowPrivilegeEscalation field in securityContext of container is set to false.   </p><h5>Remediation</h5><p>If your application does not need it, make sure the allowPrivilegeEscalation field of the securityContext is set to false.</p><h5>Checked paths and expected values</h5><ul><li>spec.template.spec.containers[*].securityContext.allowPrivilegeEscalation = false</li></ul><h5>Example</h5><pre>apiVersion: apps/v1
kind: Deployment
metadata:
  name: nginx-deployment
spec:
  replicas: 1
  template:
    spec:
      containers:
      - name: nginx
        image: nginx:latest
        securityContext:
          allowPrivilegeEscalation: false # this field should be set to false explicitly</pre><h5>Affected resources</h5><ul><li class='expandable detail-hide'>kube-system DaemonSet svclb-traefik-bf26f129<div class='details'><pre>---
apiVersion: apps/v1
kind: DaemonSet
metadata:
  annotations:
    deprecated.daemonset.template.generation: "1"
    objectset.rio.cattle.io/applied: H4sIAAAAAAAA/8RVwW7jNhD9lWLOsizb2tQR0EOQBEXQrmPY3l4WRjCiRjFriiTIkTZGoH8vKDtZpWsnQYFm4YNBzptH8r3RzCOglX+R89JoyACt9cNmBBFspS4ggyukyuglMURQEWOBjJA9AmptGFka7cPS5H+TYE8cO2ligcyKYmmGMnBAdDJuvmlyg/tmCxkMm1H0yx9SF78tyTVS0Jt5GiuCDNghlXL7Lri3KELOts5p4HeeqYI2AuGoe8xKVuQZKwuZrpWKQGFO6tUnbtBvIIPp5KwUuaBkPC4+FUif8snZ2Xla0oiwnEzPxfkEy18LARH4Rgij2RmlyMXbie+xaVOQJ0WCjYMMSlSe3kjxjfhBiHfgTyhxoPKNUPngQDjIy/FZORqfwz5+ItVbEkGp7/d/hApZbP58FhGtPU3ethEwVVYhU5fbq7d3GPQq98dJ2BMCazaVqTUfCvpCiLBamS1pyDpvIwiHoNTkPGRfH4F00/0f7rNcXN7NbxcriKBBVYetaQJt9AKwuJj9fr3sQZK4+w1fIK+ul6u7+eJ2ddtDri7nP2JeO69D3Mz7p42SOJ3Eo/EoHo8SaNcRyArvQ8ShFhtyw62S1pIbqDxrkjiNUzhg5rVSc6Ok2EEGN+XM8NyRJ83wXInBTWEH0wQisMbxXqZn1ebGMWTTJIKN8fx9dSzbGTbCqKdnryNw5E3tBIUCCsaRqJ3k3aXRTA/cFR5azKWSLGlfZUUB2VeYXa/uLq4+38xg3bZBnrd9S9PJxxr3rwN/lnPhGq9Yl6aTvnfd8ijB/+be+miq33nByvdN1cSxtE0aS3tXGvcNXdEXE9p1d4v+tz7rtVOIgI0i9zQ2w9deliQYMpiZpdhQUavQ7bcURA2jYOCMojj0F6eJyYfmU6FncmHa2cDVzYnrB+nZd27/F8pDoxtYhZpOMu85Lp1kKVBdFIXR/lar3fGEdeiEtS2QackOme53QdbQT6W+/9IF9hPi4YvGBqXCXBFkozAFdjaotniB7TorI9edk6J2jjTP6ion9/TQArIkgoK8dFQcC+lu77P0/sj2grDYQZa07T8BAAD//yoC/PIWCQAA
    objectset.rio.cattle.io/id: ""
    objectset.rio.cattle.io/owner-gvk: /v1, Kind=Service
    objectset.rio.cattle.io/owner-name: traefik
    objectset.rio.cattle.io/owner-namespace: kube-system
  creationTimestamp: "2024-01-08T17:06:48Z"
  generation: 1
  labels:
    objectset.rio.cattle.io/hash: 836fcbce022d5dae5b36694fe1eaf389c93af7dc
    svccontroller.k3s.cattle.io/nodeselector: "false"
    svccontroller.k3s.cattle.io/svcname: traefik
    svccontroller.k3s.cattle.io/svcnamespace: kube-system
  name: svclb-traefik-bf26f129
  namespace: kube-system
  resourceVersion: "615"
  uid: acc5b475-2181-4d70-b320-8de6f12fd45f
spec:
  revisionHistoryLimit: 10
  selector:
    matchLabels:
      app: svclb-traefik-bf26f129
  template:
    metadata:
      creationTimestamp: ~
      labels:
        app: svclb-traefik-bf26f129
        svccontroller.k3s.cattle.io/svcname: traefik
        svccontroller.k3s.cattle.io/svcnamespace: kube-system
    spec:
      automountServiceAccountToken: false
      containers:
      - name: lb-tcp-80
        image: rancher/klipper-lb:v0.4.4
        ports:
        - name: lb-tcp-80
          hostPort: 80
          containerPort: 80
          protocol: TCP
        env:
        - name: SRC_PORT
          value: XXXXXX
        - name: SRC_RANGES
          value: XXXXXX
        - name: DEST_PROTO
          value: XXXXXX
        - name: DEST_PORT
          value: XXXXXX
        - name: DEST_IPS
          value: XXXXXX
        resources: []
        terminationMessagePath: /dev/termination-log
        terminationMessagePolicy: File
        imagePullPolicy: IfNotPresent
        securityContext:
          capabilities:
            add:
            - NET_ADMIN
      - name: lb-tcp-443
        image: rancher/klipper-lb:v0.4.4
        ports:
        - name: lb-tcp-443
          hostPort: 443
          containerPort: 443
          protocol: TCP
        env:
        - name: SRC_PORT
          value: XXXXXX
        - name: SRC_RANGES
          value: XXXXXX
        - name: DEST_PROTO
          value: XXXXXX
        - name: DEST_PORT
          value: XXXXXX
        - name: DEST_IPS
          value: XXXXXX
        resources: []
        terminationMessagePath: /dev/termination-log
        terminationMessagePolicy: File
        imagePullPolicy: IfNotPresent
        securityContext:
          capabilities:
            add:
            - NET_ADMIN
      dnsPolicy: ClusterFirst
      restartPolicy: Always
      schedulerName: default-scheduler
      securityContext:
        sysctls:
        - name: net.ipv4.ip_forward
          value: "1"
      serviceAccount: svclb
      serviceAccountName: svclb
      terminationGracePeriodSeconds: 30
      tolerations:
      - effect: NoSchedule
        key: node-role.kubernetes.io/master
        operator: Exists
      - effect: NoSchedule
        key: node-role.kubernetes.io/control-plane
        operator: Exists
      - key: CriticalAddonsOnly
        operator: Exists
  updateStrategy:
    rollingUpdate:
      maxSurge: 0
      maxUnavailable: 1
    type: RollingUpdate
...
</pre></div></li><li class='expandable detail-hide'>kube-system Deployment local-path-provisioner<div class='details'><pre>---
apiVersion: apps/v1
kind: Deployment
metadata:
  annotations:
    deployment.kubernetes.io/revision: "1"
    objectset.rio.cattle.io/applied: H4sIAAAAAAAA/6xU3W7yRhB9lWqubQMfBCFLvUBJqlZNCEqU3kSoGtZj2LDeXe0Obizkd68Gm/yoIWmlXnl/Zs6emXPGB0Cv/6AQtbOQA3ofB/UIEthpW0AOV+SNayqyDAlUxFggI+QHQGsdI2tno2zd+pkUR+IsaJcpZDaUaTfQAgLJ2Xv3l6WQbuod5LAbx3c39Sj56Xdti5/nReHstxAWK4IcjFNo0sgu4Ib+VVL0qCRzt19TGpvIVEGbgME1mS9L22LcQg6j2bgcX6jpRVmu1Xg4nUyH43IyLkcXs2ExU9MZ/ihwXUwE9ANJj7xNfXC1luZTgO7+DJ/oSQmbQF38r1qKbG50pRnyYQKRDCl2QYIqZLW9ea0AvT//aivgHJBp0xwfcMZou3n0BTJ1YC+PFmvUBteGIB+1CXDjheP9h1g5p8qbU947t5j/wKUvVDnLqC2FCPmTbKsKxZJP59sXGYP4NE2Vs6XeQAIDYjXodv0ne47OwioBsvURuRdleXf152J+e/2wnF9eQwI1mj39ElwlZEpNprin8nW9RBbxTzVmb8q1bbtKQFfivxwCWrWlMPicc14Ps2H2YwJ9wnJvzNIZrRrI4bdy4XgZKHbD9513amf2Fd26veWuY5Use57v2/CG1R2kXSa0KyHug3ZBc3NpMMZFF9e5MLWuoFQFzVqhkXZTqLWiuVLy0uIrfmkfm2IXDAmwMxROP5CnA+xIir7s4Y9DH++saWSIvUSKteH6RUeO0CYHoLIkxZDDwj2oLRV7IwPfwRypBmcokzEKlpiizKyYKjiTeoOW/lfkCiMfdfgEcnVS52RlafstenHTP2Xtvduel6lt278DAAD//8i6p1C4BQAA
    objectset.rio.cattle.io/id: ""
    objectset.rio.cattle.io/owner-gvk: k3s.cattle.io/v1, Kind=Addon
    objectset.rio.cattle.io/owner-name: local-storage
    objectset.rio.cattle.io/owner-namespace: kube-system
  creationTimestamp: "2024-01-08T17:05:58Z"
  generation: 1
  labels:
    objectset.rio.cattle.io/hash: 183f35c65ffbc3064603f43f1580d8c68a2dabd4
  name: local-path-provisioner
  namespace: kube-system
  resourceVersion: "475"
  uid: 718c0dfe-3f1a-4b36-807a-d731f31753f6
spec:
  progressDeadlineSeconds: 600
  replicas: 1
  revisionHistoryLimit: 0
  selector:
    matchLabels:
      app: local-path-provisioner
  strategy:
    rollingUpdate:
      maxSurge: 25%
      maxUnavailable: 1
    type: RollingUpdate
  template:
    metadata:
      creationTimestamp: ~
      labels:
        app: local-path-provisioner
    spec:
      containers:
      - name: local-path-provisioner
        image: rancher/local-path-provisioner:v0.0.24
        command:
        - local-path-provisioner
        - start
        - --config
        - /etc/config/config.json
        env:
        - name: POD_NAMESPACE
          value: XXXXXX
          valueFrom:
            fieldRef:
              apiVersion: v1
              fieldPath: metadata.namespace
        resources: []
        volumeMounts:
        - name: config-volume
          mountPath: /etc/config/
        terminationMessagePath: /dev/termination-log
        terminationMessagePolicy: File
        imagePullPolicy: IfNotPresent
      dnsPolicy: ClusterFirst
      priorityClassName: system-node-critical
      restartPolicy: Always
      schedulerName: default-scheduler
      securityContext: []
      serviceAccount: local-path-provisioner-service-account
      serviceAccountName: local-path-provisioner-service-account
      terminationGracePeriodSeconds: 30
      tolerations:
      - key: CriticalAddonsOnly
        operator: Exists
      - effect: NoSchedule
        key: node-role.kubernetes.io/control-plane
        operator: Exists
      - effect: NoSchedule
        key: node-role.kubernetes.io/master
        operator: Exists
      volumes:
      - configMap:
          defaultMode: 420
          name: local-path-config
        name: config-volume
...
</pre></div></li><li class='expandable detail-hide'>kube-system Deployment traefik<div class='details'><pre>---
apiVersion: apps/v1
kind: Deployment
metadata:
  annotations:
    deployment.kubernetes.io/revision: "1"
    meta.helm.sh/release-name: traefik
    meta.helm.sh/release-namespace: kube-system
  creationTimestamp: "2024-01-08T17:06:48Z"
  generation: 1
  labels:
    app.kubernetes.io/instance: traefik-kube-system
    app.kubernetes.io/managed-by: Helm
    app.kubernetes.io/name: traefik
    helm.sh/chart: traefik-21.2.1_up21.2.0
  name: traefik
  namespace: kube-system
  resourceVersion: "629"
  uid: ec30998f-e81b-47de-aeae-3970de0b73a4
spec:
  progressDeadlineSeconds: 600
  replicas: 1
  revisionHistoryLimit: 10
  selector:
    matchLabels:
      app.kubernetes.io/instance: traefik-kube-system
      app.kubernetes.io/name: traefik
  strategy:
    rollingUpdate:
      maxSurge: 1
      maxUnavailable: 0
    type: RollingUpdate
  template:
    metadata:
      annotations:
        prometheus.io/path: /metrics
        prometheus.io/port: "9100"
        prometheus.io/scrape: "true"
      creationTimestamp: ~
      labels:
        app.kubernetes.io/instance: traefik-kube-system
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: traefik
        helm.sh/chart: traefik-21.2.1_up21.2.0
    spec:
      containers:
      - name: traefik
        image: rancher/mirrored-library-traefik:2.9.10
        args:
        - --global.checknewversion
        - --global.sendanonymoususage
        - --entrypoints.metrics.address=:9100/tcp
        - --entrypoints.traefik.address=:9000/tcp
        - --entrypoints.web.address=:8000/tcp
        - --entrypoints.websecure.address=:8443/tcp
        - --api.dashboard=true
        - --ping=true
        - --metrics.prometheus=true
        - --metrics.prometheus.entrypoint=metrics
        - --providers.kubernetescrd
        - --providers.kubernetesingress
        - --providers.kubernetesingress.ingressendpoint.publishedservice=kube-system/traefik
        - --entrypoints.websecure.http.tls=true
        ports:
        - name: metrics
          containerPort: 9100
          protocol: TCP
        - name: traefik
          containerPort: 9000
          protocol: TCP
        - name: web
          containerPort: 8000
          protocol: TCP
        - name: websecure
          containerPort: 8443
          protocol: TCP
        resources: []
        volumeMounts:
        - name: data
          mountPath: /data
        - name: tmp
          mountPath: /tmp
        livenessProbe:
          httpGet:
            path: /ping
            port: 9000
            scheme: HTTP
          initialDelaySeconds: 2
          timeoutSeconds: 2
          periodSeconds: 10
          successThreshold: 1
          failureThreshold: 3
        readinessProbe:
          httpGet:
            path: /ping
            port: 9000
            scheme: HTTP
          initialDelaySeconds: 2
          timeoutSeconds: 2
          periodSeconds: 10
          successThreshold: 1
          failureThreshold: 1
        terminationMessagePath: /dev/termination-log
        terminationMessagePolicy: File
        imagePullPolicy: IfNotPresent
        securityContext:
          capabilities:
            drop:
            - ALL
          runAsUser: 65532
          runAsGroup: 65532
          runAsNonRoot: true
          readOnlyRootFilesystem: true
      dnsPolicy: ClusterFirst
      priorityClassName: system-cluster-critical
      restartPolicy: Always
      schedulerName: default-scheduler
      securityContext:
        fsGroup: 65532
      serviceAccount: traefik
      serviceAccountName: traefik
      terminationGracePeriodSeconds: 60
      tolerations:
      - key: CriticalAddonsOnly
        operator: Exists
      - effect: NoSchedule
        key: node-role.kubernetes.io/control-plane
        operator: Exists
      - effect: NoSchedule
        key: node-role.kubernetes.io/master
        operator: Exists
      volumes:
      - emptyDir: []
        name: data
      - emptyDir: []
        name: tmp
...
</pre></div></li><li class='expandable detail-hide'>kube-system Job helm-install-traefik<div class='details'><pre>---
apiVersion: batch/v1
kind: Job
metadata:
  annotations:
    batch.kubernetes.io/job-tracking: ""
    objectset.rio.cattle.io/applied: H4sIAAAAAAAA/6xVUY/qNhP9K59Guk9fEgLZbCDSPgQIhd5diAK7alWtkDETcHHsyHZoVyv+e+WQezfb3m5vpb7ZzszxOeM5k1cgFXtCpZkUEMOOGHrsnfvgwImJPcTwo9yBAyUasieGQPwKRAhpiGFSaLuVu1+RGo3GU0x6lBjD0WOyx2z2EXnpUimMkpyjcumRKOMqPDBtVIMBzt8iyN8EKvdwPrVAnU/nvvO/z0zs7+bIy4kF/UccQUqEGIwiWLDTd4XrilCbc6p36OoXbbCEiwNUYUN9w0rUhpQVxKLm3AFOdsiboli6jVbt/Yl5c/pdPI5EHyEG6hejCElEBiEGe6RRfxRGNCLB4KZPgmERYFgQDAvLrNXYVJ0JbQjn7ttFH0jSFVLLe0foSRbFPSuZgbjv+74DBsuKE4P2+wd98IFkKQp2mF/lrOfJILy9C6NJMByPZuPx7ThIg4kfzobRKEgnfhCG09EoDGfRjT9OwptplM4G09HtdBTNhtPb//wBLh35tlMJE6g0xL+8AlEHu4C2lOCA62o0rjaKiQM4cOByR7h3reMUC1Jzk1+b++UOnh1AcW6Q2odZJg8pOHAmvO724sX5GvGU5uvFatk9ytNs1d3P0/uH7TRfPKV5B0sjVWi6cZN5km+29sp1lky6975//PcJnbCjMZWOe71Pr58fx2m+TDfpeptki8unnrYPT6+11L1WhzvoewOv//+6ahb+X0h/Q9wmyX9I/xXL5HEz32bJer2d5Ok0XW4Wyf26k1YQrrGbsFxts3z108+dGE+fqeNRXmuDyuOSEu70fe9m4Pme3+vfNpug3XSxZsni/jFPt9nqfjHpIir80iSXZwdYSQ7NKRH0iKp34qyqULm2FeOz7w29gburGd8P/EHgD/shtDlZzXkmOaMvEMOiWEqTKdQoDLwzNzigUMtaUbTdfnHgLHld4oOshbn2bmmXGTHWc60D3zAa1roR9j6unaRtmLWDvfvybEUJucc1cqRGKmsW+z5KoEHdTE0NMXAm6t+tQ5X1pTJfpazEjDBeKwQHNKozo5hQaq9edkbW26i6ytFd77ScnS+dHr+2qxbh+mu5RrkdczeuLtjhgVQ2R3SjW4Fv4d+S3gwIQ0zdlPryRwAAAP//DrZg0DIHAAA
    objectset.rio.cattle.io/id: helm-controller-chart-registration
    objectset.rio.cattle.io/owner-gvk: helm.cattle.io/v1, Kind=HelmChart
    objectset.rio.cattle.io/owner-name: traefik
    objectset.rio.cattle.io/owner-namespace: kube-system
  creationTimestamp: "2024-01-08T17:06:00Z"
  generation: 1
  labels:
    helmcharts.helm.cattle.io/chart: traefik
    objectset.rio.cattle.io/hash: c0f97ea7a25e3dec71957c7a3241a38f3e5fae5f
  name: helm-install-traefik
  namespace: kube-system
  resourceVersion: "598"
  uid: 2a591629-9af8-4949-b2dd-39bd02b148a4
spec:
  backoffLimit: 1000
  completionMode: NonIndexed
  completions: 1
  parallelism: 1
  selector:
    matchLabels:
      batch.kubernetes.io/controller-uid: 2a591629-9af8-4949-b2dd-39bd02b148a4
  suspend: false
  template:
    metadata:
      annotations:
        helmcharts.helm.cattle.io/configHash: SHA256=57C38B9FBB6B3E3C05F8793EC0355D9955F740BA54D7EF2D96D97F8D678F2B0E
      creationTimestamp: ~
      labels:
        batch.kubernetes.io/controller-uid: 2a591629-9af8-4949-b2dd-39bd02b148a4
        batch.kubernetes.io/job-name: helm-install-traefik
        controller-uid: 2a591629-9af8-4949-b2dd-39bd02b148a4
        helmcharts.helm.cattle.io/chart: traefik
        job-name: helm-install-traefik
    spec:
      containers:
      - name: helm
        image: rancher/klipper-helm:v0.8.2-build20230815
        args:
        - install
        - --set-string
        - global.systemDefaultRegistry=
        env:
        - name: NAME
          value: XXXXXX
        - name: VERSION
          value: XXXXXX
        - name: REPO
          value: XXXXXX
        - name: HELM_DRIVER
          value: XXXXXX
        - name: CHART_NAMESPACE
          value: XXXXXX
        - name: CHART
          value: XXXXXX
        - name: HELM_VERSION
          value: XXXXXX
        - name: TARGET_NAMESPACE
          value: XXXXXX
        - name: AUTH_PASS_CREDENTIALS
          value: XXXXXX
        - name: NO_PROXY
          value: XXXXXX
        - name: FAILURE_POLICY
          value: XXXXXX
        resources: []
        volumeMounts:
        - name: values
          mountPath: /config
        - name: content
          mountPath: /chart
        terminationMessagePath: /dev/termination-log
        terminationMessagePolicy: File
        imagePullPolicy: IfNotPresent
      dnsPolicy: ClusterFirst
      nodeSelector:
        kubernetes.io/os: linux
      restartPolicy: OnFailure
      schedulerName: default-scheduler
      securityContext: []
      serviceAccount: helm-traefik
      serviceAccountName: helm-traefik
      terminationGracePeriodSeconds: 30
      volumes:
      - name: values
        secret:
          defaultMode: 420
          secretName: chart-values-traefik
      - configMap:
          defaultMode: 420
          name: chart-content-traefik
        name: content
...
</pre></div></li><li class='expandable detail-hide'>kube-system Job helm-install-traefik-crd<div class='details'><pre>---
apiVersion: batch/v1
kind: Job
metadata:
  annotations:
    batch.kubernetes.io/job-tracking: ""
    objectset.rio.cattle.io/applied: H4sIAAAAAAAA/7RVUY/iNhD+K9VI99QkJCEsm0j3ELhQ6O0CCuyqVbVCxkzAxbEj26E9If575ZC7hu11e324t9ie7/P3jWcmZyAVe0almRSQwJYYeuidAnDgyMQOEvhZbsGBEg3ZEUMgOQMRQhpimBTaLuX2d6RGo/EUkx4lxnD0mOwxiz4gL10qhVGSc1QuPRBlXIV7po1qOMD5Vwb5h0Dl7k/HlqhzdAqcHz4ysXs/RV6OLel/8ghSIiRgFMGCHV2qdt8E0RWhFnest+jqT9pgCRcHqMJG/pqVqA0pK0hEzbkDnGyRN4mxkhu/2nulvtn9Zi0Hog+QQHRfFP3dgPaDYLjtD8OC7igZ+PEwHhRxEQ79kBT+IA6tutZrk30mtCGcu7eXvWFNV0it/i2hR1kUD6xkBpLA930HDJYVJwbt+Rs18YZ1KQq2n14traZpOLh7n/VH/jiKwvh+Mg7GQRSnk9EkGt/H8d1kFIdROEyzKMiiuygexf1onEbxII6D0fC7PMSlkwJbuYQJVBqS385A1N5+QJtSeHEAxak5ajM+Tx8zcOBEeP262C7Ol6jnLF/NFvPuVp4tF931NHt43HzIZ89Z3uHTSBWabtx4mubrjb12tUzH3btvX/UW0Ak7GFPppNd7d/74NMryebbOVpt0Obu862n7ovSaJN3reHHDwAu94Me6CoN/iP6KuXWa/5T9L5Xp03q6Waar1WacZx+y+XqWPqw6sIJwjV3AfLFZ5otffu3EePpEHY/yWhtUHpeUcCfwvSj0fM/vBXfNot8uulyTdPbwlGeb5eJhNu4yKvz88pcXB1hJ9s0uEfSAqnfkrKpQubbGkpPv3Xuhu60Z34V+2PfvgwG0mGXN+VJyRj9BArNiLs1SoUZh4KZzwQGFWtaKoi3jiwMnyesSH2UtzLUgS/u5JMY2U9taf3M0qnVj7DauHZdtmK1xe/flxZoScocr5EiNVLYD7PsogQZ1MxY1JMCZqP+0radswynzxcpCTAjjtUJwQKM6MYoppfbqeWce3c6hqyXd7aFWt/O52pNz+9WyXP8h1yj3Vec2LVuw/SOpLE50Ea3RW8jX0tBMAENM3aT98lcAAAD//411peIjBwAA
    objectset.rio.cattle.io/id: helm-controller-chart-registration
    objectset.rio.cattle.io/owner-gvk: helm.cattle.io/v1, Kind=HelmChart
    objectset.rio.cattle.io/owner-name: traefik-crd
    objectset.rio.cattle.io/owner-namespace: kube-system
  creationTimestamp: "2024-01-08T17:06:00Z"
  generation: 1
  labels:
    helmcharts.helm.cattle.io/chart: traefik-crd
    objectset.rio.cattle.io/hash: 48ff3d5c3117b372fcdca509795f9f2702af0592
  name: helm-install-traefik-crd
  namespace: kube-system
  resourceVersion: "588"
  uid: 655ceb1b-aaa8-4b24-92ab-fceb2ddd45bd
spec:
  backoffLimit: 1000
  completionMode: NonIndexed
  completions: 1
  parallelism: 1
  selector:
    matchLabels:
      batch.kubernetes.io/controller-uid: 655ceb1b-aaa8-4b24-92ab-fceb2ddd45bd
  suspend: false
  template:
    metadata:
      annotations:
        helmcharts.helm.cattle.io/configHash: SHA256=E3B0C44298FC1C149AFBF4C8996FB92427AE41E4649B934CA495991B7852B855
      creationTimestamp: ~
      labels:
        batch.kubernetes.io/controller-uid: 655ceb1b-aaa8-4b24-92ab-fceb2ddd45bd
        batch.kubernetes.io/job-name: helm-install-traefik-crd
        controller-uid: 655ceb1b-aaa8-4b24-92ab-fceb2ddd45bd
        helmcharts.helm.cattle.io/chart: traefik-crd
        job-name: helm-install-traefik-crd
    spec:
      containers:
      - name: helm
        image: rancher/klipper-helm:v0.8.2-build20230815
        args:
        - install
        env:
        - name: NAME
          value: XXXXXX
        - name: VERSION
          value: XXXXXX
        - name: REPO
          value: XXXXXX
        - name: HELM_DRIVER
          value: XXXXXX
        - name: CHART_NAMESPACE
          value: XXXXXX
        - name: CHART
          value: XXXXXX
        - name: HELM_VERSION
          value: XXXXXX
        - name: TARGET_NAMESPACE
          value: XXXXXX
        - name: AUTH_PASS_CREDENTIALS
          value: XXXXXX
        - name: NO_PROXY
          value: XXXXXX
        - name: FAILURE_POLICY
          value: XXXXXX
        resources: []
        volumeMounts:
        - name: values
          mountPath: /config
        - name: content
          mountPath: /chart
        terminationMessagePath: /dev/termination-log
        terminationMessagePolicy: File
        imagePullPolicy: IfNotPresent
      dnsPolicy: ClusterFirst
      nodeSelector:
        kubernetes.io/os: linux
      restartPolicy: OnFailure
      schedulerName: default-scheduler
      securityContext: []
      serviceAccount: helm-traefik-crd
      serviceAccountName: helm-traefik-crd
      terminationGracePeriodSeconds: 30
      volumes:
      - name: values
        secret:
          defaultMode: 420
          secretName: chart-values-traefik-crd
      - configMap:
          defaultMode: 420
          name: chart-content-traefik-crd
        name: content
...
</pre></div></li></ul></div></div></div><div class='accordion-item'><div class='accordion-header' id='control_9_header'><button class='accordion-button collapsed' type='button' data-bs-toggle='collapse' data-bs-target='#control_9' aria-expanded='false' aria-controls='control_9'><div class='row'><div class='col'><h2 class='fs-4'>C-0017: Immutable container filesystem</h2><p class='mb-0'> Mutable container filesystem can be abused to inject malicious code or data into containers. Use immutable (read-only) filesystem to limit potential attacks.</p></div></div></button></div><div id='control_9' class='accordion-collapse collapse' aria-labelledby='control_9_header' data-bs-parent='#report'><div class='accordion-body'><p>By default, containers are permitted mostly unrestricted execution within their own context. An attacker who has access to a container, can create files and download scripts as he wishes, and modify the underlying application running on the container. </p><h5>Detection</h5><p>Check whether the readOnlyRootFilesystem field in the SecurityContext is set to true. </p><h5>Remediation</h5><p>Set the filesystem of the container to read-only when possible (pod securityContext, readOnlyRootFilesystem: true). If containers application needs to write into the filesystem, it is recommended to mount secondary filesystems for specific directories where application require write access.</p><h5>Checked paths and expected values</h5><ul><li>spec.template.spec.containers[*].securityContext.readOnlyRootFilesystem = true</li></ul><h5>Example</h5><pre>apiVersion: v1
kind: Pod
metadata:
  name: security-context-demo
spec:
  containers:
  - name: sec-ctx-demo
    image: busybox
    command: [ "sh", "-c", "sleep 1h" ]
    securityContext:
      readOnlyRootFilesystem : true  #we check this is set to true</pre><h5>Affected resources</h5><ul><li class='expandable detail-hide'>kube-system DaemonSet svclb-traefik-bf26f129<div class='details'><pre>---
apiVersion: apps/v1
kind: DaemonSet
metadata:
  annotations:
    deprecated.daemonset.template.generation: "1"
    objectset.rio.cattle.io/applied: H4sIAAAAAAAA/8RVwW7jNhD9lWLOsizb2tQR0EOQBEXQrmPY3l4WRjCiRjFriiTIkTZGoH8vKDtZpWsnQYFm4YNBzptH8r3RzCOglX+R89JoyACt9cNmBBFspS4ggyukyuglMURQEWOBjJA9AmptGFka7cPS5H+TYE8cO2ligcyKYmmGMnBAdDJuvmlyg/tmCxkMm1H0yx9SF78tyTVS0Jt5GiuCDNghlXL7Lri3KELOts5p4HeeqYI2AuGoe8xKVuQZKwuZrpWKQGFO6tUnbtBvIIPp5KwUuaBkPC4+FUif8snZ2Xla0oiwnEzPxfkEy18LARH4Rgij2RmlyMXbie+xaVOQJ0WCjYMMSlSe3kjxjfhBiHfgTyhxoPKNUPngQDjIy/FZORqfwz5+ItVbEkGp7/d/hApZbP58FhGtPU3ethEwVVYhU5fbq7d3GPQq98dJ2BMCazaVqTUfCvpCiLBamS1pyDpvIwiHoNTkPGRfH4F00/0f7rNcXN7NbxcriKBBVYetaQJt9AKwuJj9fr3sQZK4+w1fIK+ul6u7+eJ2ddtDri7nP2JeO69D3Mz7p42SOJ3Eo/EoHo8SaNcRyArvQ8ShFhtyw62S1pIbqDxrkjiNUzhg5rVSc6Ok2EEGN+XM8NyRJ83wXInBTWEH0wQisMbxXqZn1ebGMWTTJIKN8fx9dSzbGTbCqKdnryNw5E3tBIUCCsaRqJ3k3aXRTA/cFR5azKWSLGlfZUUB2VeYXa/uLq4+38xg3bZBnrd9S9PJxxr3rwN/lnPhGq9Yl6aTvnfd8ijB/+be+miq33nByvdN1cSxtE0aS3tXGvcNXdEXE9p1d4v+tz7rtVOIgI0i9zQ2w9deliQYMpiZpdhQUavQ7bcURA2jYOCMojj0F6eJyYfmU6FncmHa2cDVzYnrB+nZd27/F8pDoxtYhZpOMu85Lp1kKVBdFIXR/lar3fGEdeiEtS2QackOme53QdbQT6W+/9IF9hPi4YvGBqXCXBFkozAFdjaotniB7TorI9edk6J2jjTP6ion9/TQArIkgoK8dFQcC+lu77P0/sj2grDYQZa07T8BAAD//yoC/PIWCQAA
    objectset.rio.cattle.io/id: ""
    objectset.rio.cattle.io/owner-gvk: /v1, Kind=Service
    objectset.rio.cattle.io/owner-name: traefik
    objectset.rio.cattle.io/owner-namespace: kube-system
  creationTimestamp: "2024-01-08T17:06:48Z"
  generation: 1
  labels:
    objectset.rio.cattle.io/hash: 836fcbce022d5dae5b36694fe1eaf389c93af7dc
    svccontroller.k3s.cattle.io/nodeselector: "false"
    svccontroller.k3s.cattle.io/svcname: traefik
    svccontroller.k3s.cattle.io/svcnamespace: kube-system
  name: svclb-traefik-bf26f129
  namespace: kube-system
  resourceVersion: "615"
  uid: acc5b475-2181-4d70-b320-8de6f12fd45f
spec:
  revisionHistoryLimit: 10
  selector:
    matchLabels:
      app: svclb-traefik-bf26f129
  template:
    metadata:
      creationTimestamp: ~
      labels:
        app: svclb-traefik-bf26f129
        svccontroller.k3s.cattle.io/svcname: traefik
        svccontroller.k3s.cattle.io/svcnamespace: kube-system
    spec:
      automountServiceAccountToken: false
      containers:
      - name: lb-tcp-80
        image: rancher/klipper-lb:v0.4.4
        ports:
        - name: lb-tcp-80
          hostPort: 80
          containerPort: 80
          protocol: TCP
        env:
        - name: SRC_PORT
          value: XXXXXX
        - name: SRC_RANGES
          value: XXXXXX
        - name: DEST_PROTO
          value: XXXXXX
        - name: DEST_PORT
          value: XXXXXX
        - name: DEST_IPS
          value: XXXXXX
        resources: []
        terminationMessagePath: /dev/termination-log
        terminationMessagePolicy: File
        imagePullPolicy: IfNotPresent
        securityContext:
          capabilities:
            add:
            - NET_ADMIN
      - name: lb-tcp-443
        image: rancher/klipper-lb:v0.4.4
        ports:
        - name: lb-tcp-443
          hostPort: 443
          containerPort: 443
          protocol: TCP
        env:
        - name: SRC_PORT
          value: XXXXXX
        - name: SRC_RANGES
          value: XXXXXX
        - name: DEST_PROTO
          value: XXXXXX
        - name: DEST_PORT
          value: XXXXXX
        - name: DEST_IPS
          value: XXXXXX
        resources: []
        terminationMessagePath: /dev/termination-log
        terminationMessagePolicy: File
        imagePullPolicy: IfNotPresent
        securityContext:
          capabilities:
            add:
            - NET_ADMIN
      dnsPolicy: ClusterFirst
      restartPolicy: Always
      schedulerName: default-scheduler
      securityContext:
        sysctls:
        - name: net.ipv4.ip_forward
          value: "1"
      serviceAccount: svclb
      serviceAccountName: svclb
      terminationGracePeriodSeconds: 30
      tolerations:
      - effect: NoSchedule
        key: node-role.kubernetes.io/master
        operator: Exists
      - effect: NoSchedule
        key: node-role.kubernetes.io/control-plane
        operator: Exists
      - key: CriticalAddonsOnly
        operator: Exists
  updateStrategy:
    rollingUpdate:
      maxSurge: 0
      maxUnavailable: 1
    type: RollingUpdate
...
</pre></div></li><li class='expandable detail-hide'>kube-system Deployment local-path-provisioner<div class='details'><pre>---
apiVersion: apps/v1
kind: Deployment
metadata:
  annotations:
    deployment.kubernetes.io/revision: "1"
    objectset.rio.cattle.io/applied: H4sIAAAAAAAA/6xU3W7yRhB9lWqubQMfBCFLvUBJqlZNCEqU3kSoGtZj2LDeXe0Obizkd68Gm/yoIWmlXnl/Zs6emXPGB0Cv/6AQtbOQA3ofB/UIEthpW0AOV+SNayqyDAlUxFggI+QHQGsdI2tno2zd+pkUR+IsaJcpZDaUaTfQAgLJ2Xv3l6WQbuod5LAbx3c39Sj56Xdti5/nReHstxAWK4IcjFNo0sgu4Ib+VVL0qCRzt19TGpvIVEGbgME1mS9L22LcQg6j2bgcX6jpRVmu1Xg4nUyH43IyLkcXs2ExU9MZ/ihwXUwE9ANJj7xNfXC1luZTgO7+DJ/oSQmbQF38r1qKbG50pRnyYQKRDCl2QYIqZLW9ea0AvT//aivgHJBp0xwfcMZou3n0BTJ1YC+PFmvUBteGIB+1CXDjheP9h1g5p8qbU947t5j/wKUvVDnLqC2FCPmTbKsKxZJP59sXGYP4NE2Vs6XeQAIDYjXodv0ne47OwioBsvURuRdleXf152J+e/2wnF9eQwI1mj39ElwlZEpNprin8nW9RBbxTzVmb8q1bbtKQFfivxwCWrWlMPicc14Ps2H2YwJ9wnJvzNIZrRrI4bdy4XgZKHbD9513amf2Fd26veWuY5Use57v2/CG1R2kXSa0KyHug3ZBc3NpMMZFF9e5MLWuoFQFzVqhkXZTqLWiuVLy0uIrfmkfm2IXDAmwMxROP5CnA+xIir7s4Y9DH++saWSIvUSKteH6RUeO0CYHoLIkxZDDwj2oLRV7IwPfwRypBmcokzEKlpiizKyYKjiTeoOW/lfkCiMfdfgEcnVS52RlafstenHTP2Xtvduel6lt278DAAD//8i6p1C4BQAA
    objectset.rio.cattle.io/id: ""
    objectset.rio.cattle.io/owner-gvk: k3s.cattle.io/v1, Kind=Addon
    objectset.rio.cattle.io/owner-name: local-storage
    objectset.rio.cattle.io/owner-namespace: kube-system
  creationTimestamp: "2024-01-08T17:05:58Z"
  generation: 1
  labels:
    objectset.rio.cattle.io/hash: 183f35c65ffbc3064603f43f1580d8c68a2dabd4
  name: local-path-provisioner
  namespace: kube-system
  resourceVersion: "475"
  uid: 718c0dfe-3f1a-4b36-807a-d731f31753f6
spec:
  progressDeadlineSeconds: 600
  replicas: 1
  revisionHistoryLimit: 0
  selector:
    matchLabels:
      app: local-path-provisioner
  strategy:
    rollingUpdate:
      maxSurge: 25%
      maxUnavailable: 1
    type: RollingUpdate
  template:
    metadata:
      creationTimestamp: ~
      labels:
        app: local-path-provisioner
    spec:
      containers:
      - name: local-path-provisioner
        image: rancher/local-path-provisioner:v0.0.24
        command:
        - local-path-provisioner
        - start
        - --config
        - /etc/config/config.json
        env:
        - name: POD_NAMESPACE
          value: XXXXXX
          valueFrom:
            fieldRef:
              apiVersion: v1
              fieldPath: metadata.namespace
        resources: []
        volumeMounts:
        - name: config-volume
          mountPath: /etc/config/
        terminationMessagePath: /dev/termination-log
        terminationMessagePolicy: File
        imagePullPolicy: IfNotPresent
      dnsPolicy: ClusterFirst
      priorityClassName: system-node-critical
      restartPolicy: Always
      schedulerName: default-scheduler
      securityContext: []
      serviceAccount: local-path-provisioner-service-account
      serviceAccountName: local-path-provisioner-service-account
      terminationGracePeriodSeconds: 30
      tolerations:
      - key: CriticalAddonsOnly
        operator: Exists
      - effect: NoSchedule
        key: node-role.kubernetes.io/control-plane
        operator: Exists
      - effect: NoSchedule
        key: node-role.kubernetes.io/master
        operator: Exists
      volumes:
      - configMap:
          defaultMode: 420
          name: local-path-config
        name: config-volume
...
</pre></div></li><li class='expandable detail-hide'>kube-system Job helm-install-traefik<div class='details'><pre>---
apiVersion: batch/v1
kind: Job
metadata:
  annotations:
    batch.kubernetes.io/job-tracking: ""
    objectset.rio.cattle.io/applied: H4sIAAAAAAAA/6xVUY/qNhP9K59Guk9fEgLZbCDSPgQIhd5diAK7alWtkDETcHHsyHZoVyv+e+WQezfb3m5vpb7ZzszxOeM5k1cgFXtCpZkUEMOOGHrsnfvgwImJPcTwo9yBAyUasieGQPwKRAhpiGFSaLuVu1+RGo3GU0x6lBjD0WOyx2z2EXnpUimMkpyjcumRKOMqPDBtVIMBzt8iyN8EKvdwPrVAnU/nvvO/z0zs7+bIy4kF/UccQUqEGIwiWLDTd4XrilCbc6p36OoXbbCEiwNUYUN9w0rUhpQVxKLm3AFOdsiboli6jVbt/Yl5c/pdPI5EHyEG6hejCElEBiEGe6RRfxRGNCLB4KZPgmERYFgQDAvLrNXYVJ0JbQjn7ttFH0jSFVLLe0foSRbFPSuZgbjv+74DBsuKE4P2+wd98IFkKQp2mF/lrOfJILy9C6NJMByPZuPx7ThIg4kfzobRKEgnfhCG09EoDGfRjT9OwptplM4G09HtdBTNhtPb//wBLh35tlMJE6g0xL+8AlEHu4C2lOCA62o0rjaKiQM4cOByR7h3reMUC1Jzk1+b++UOnh1AcW6Q2odZJg8pOHAmvO724sX5GvGU5uvFatk9ytNs1d3P0/uH7TRfPKV5B0sjVWi6cZN5km+29sp1lky6975//PcJnbCjMZWOe71Pr58fx2m+TDfpeptki8unnrYPT6+11L1WhzvoewOv//+6ahb+X0h/Q9wmyX9I/xXL5HEz32bJer2d5Ok0XW4Wyf26k1YQrrGbsFxts3z108+dGE+fqeNRXmuDyuOSEu70fe9m4Pme3+vfNpug3XSxZsni/jFPt9nqfjHpIir80iSXZwdYSQ7NKRH0iKp34qyqULm2FeOz7w29gburGd8P/EHgD/shtDlZzXkmOaMvEMOiWEqTKdQoDLwzNzigUMtaUbTdfnHgLHld4oOshbn2bmmXGTHWc60D3zAa1roR9j6unaRtmLWDvfvybEUJucc1cqRGKmsW+z5KoEHdTE0NMXAm6t+tQ5X1pTJfpazEjDBeKwQHNKozo5hQaq9edkbW26i6ytFd77ScnS+dHr+2qxbh+mu5RrkdczeuLtjhgVQ2R3SjW4Fv4d+S3gwIQ0zdlPryRwAAAP//DrZg0DIHAAA
    objectset.rio.cattle.io/id: helm-controller-chart-registration
    objectset.rio.cattle.io/owner-gvk: helm.cattle.io/v1, Kind=HelmChart
    objectset.rio.cattle.io/owner-name: traefik
    objectset.rio.cattle.io/owner-namespace: kube-system
  creationTimestamp: "2024-01-08T17:06:00Z"
  generation: 1
  labels:
    helmcharts.helm.cattle.io/chart: traefik
    objectset.rio.cattle.io/hash: c0f97ea7a25e3dec71957c7a3241a38f3e5fae5f
  name: helm-install-traefik
  namespace: kube-system
  resourceVersion: "598"
  uid: 2a591629-9af8-4949-b2dd-39bd02b148a4
spec:
  backoffLimit: 1000
  completionMode: NonIndexed
  completions: 1
  parallelism: 1
  selector:
    matchLabels:
      batch.kubernetes.io/controller-uid: 2a591629-9af8-4949-b2dd-39bd02b148a4
  suspend: false
  template:
    metadata:
      annotations:
        helmcharts.helm.cattle.io/configHash: SHA256=57C38B9FBB6B3E3C05F8793EC0355D9955F740BA54D7EF2D96D97F8D678F2B0E
      creationTimestamp: ~
      labels:
        batch.kubernetes.io/controller-uid: 2a591629-9af8-4949-b2dd-39bd02b148a4
        batch.kubernetes.io/job-name: helm-install-traefik
        controller-uid: 2a591629-9af8-4949-b2dd-39bd02b148a4
        helmcharts.helm.cattle.io/chart: traefik
        job-name: helm-install-traefik
    spec:
      containers:
      - name: helm
        image: rancher/klipper-helm:v0.8.2-build20230815
        args:
        - install
        - --set-string
        - global.systemDefaultRegistry=
        env:
        - name: NAME
          value: XXXXXX
        - name: VERSION
          value: XXXXXX
        - name: REPO
          value: XXXXXX
        - name: HELM_DRIVER
          value: XXXXXX
        - name: CHART_NAMESPACE
          value: XXXXXX
        - name: CHART
          value: XXXXXX
        - name: HELM_VERSION
          value: XXXXXX
        - name: TARGET_NAMESPACE
          value: XXXXXX
        - name: AUTH_PASS_CREDENTIALS
          value: XXXXXX
        - name: NO_PROXY
          value: XXXXXX
        - name: FAILURE_POLICY
          value: XXXXXX
        resources: []
        volumeMounts:
        - name: values
          mountPath: /config
        - name: content
          mountPath: /chart
        terminationMessagePath: /dev/termination-log
        terminationMessagePolicy: File
        imagePullPolicy: IfNotPresent
      dnsPolicy: ClusterFirst
      nodeSelector:
        kubernetes.io/os: linux
      restartPolicy: OnFailure
      schedulerName: default-scheduler
      securityContext: []
      serviceAccount: helm-traefik
      serviceAccountName: helm-traefik
      terminationGracePeriodSeconds: 30
      volumes:
      - name: values
        secret:
          defaultMode: 420
          secretName: chart-values-traefik
      - configMap:
          defaultMode: 420
          name: chart-content-traefik
        name: content
...
</pre></div></li><li class='expandable detail-hide'>kube-system Job helm-install-traefik-crd<div class='details'><pre>---
apiVersion: batch/v1
kind: Job
metadata:
  annotations:
    batch.kubernetes.io/job-tracking: ""
    objectset.rio.cattle.io/applied: H4sIAAAAAAAA/7RVUY/iNhD+K9VI99QkJCEsm0j3ELhQ6O0CCuyqVbVCxkzAxbEj26E9If575ZC7hu11e324t9ie7/P3jWcmZyAVe0almRSQwJYYeuidAnDgyMQOEvhZbsGBEg3ZEUMgOQMRQhpimBTaLuX2d6RGo/EUkx4lxnD0mOwxiz4gL10qhVGSc1QuPRBlXIV7po1qOMD5Vwb5h0Dl7k/HlqhzdAqcHz4ysXs/RV6OLel/8ghSIiRgFMGCHV2qdt8E0RWhFnest+jqT9pgCRcHqMJG/pqVqA0pK0hEzbkDnGyRN4mxkhu/2nulvtn9Zi0Hog+QQHRfFP3dgPaDYLjtD8OC7igZ+PEwHhRxEQ79kBT+IA6tutZrk30mtCGcu7eXvWFNV0it/i2hR1kUD6xkBpLA930HDJYVJwbt+Rs18YZ1KQq2n14traZpOLh7n/VH/jiKwvh+Mg7GQRSnk9EkGt/H8d1kFIdROEyzKMiiuygexf1onEbxII6D0fC7PMSlkwJbuYQJVBqS385A1N5+QJtSeHEAxak5ajM+Tx8zcOBEeP262C7Ol6jnLF/NFvPuVp4tF931NHt43HzIZ89Z3uHTSBWabtx4mubrjb12tUzH3btvX/UW0Ak7GFPppNd7d/74NMryebbOVpt0Obu862n7ovSaJN3reHHDwAu94Me6CoN/iP6KuXWa/5T9L5Xp03q6Waar1WacZx+y+XqWPqw6sIJwjV3AfLFZ5otffu3EePpEHY/yWhtUHpeUcCfwvSj0fM/vBXfNot8uulyTdPbwlGeb5eJhNu4yKvz88pcXB1hJ9s0uEfSAqnfkrKpQubbGkpPv3Xuhu60Z34V+2PfvgwG0mGXN+VJyRj9BArNiLs1SoUZh4KZzwQGFWtaKoi3jiwMnyesSH2UtzLUgS/u5JMY2U9taf3M0qnVj7DauHZdtmK1xe/flxZoScocr5EiNVLYD7PsogQZ1MxY1JMCZqP+0radswynzxcpCTAjjtUJwQKM6MYoppfbqeWce3c6hqyXd7aFWt/O52pNz+9WyXP8h1yj3Vec2LVuw/SOpLE50Ea3RW8jX0tBMAENM3aT98lcAAAD//411peIjBwAA
    objectset.rio.cattle.io/id: helm-controller-chart-registration
    objectset.rio.cattle.io/owner-gvk: helm.cattle.io/v1, Kind=HelmChart
    objectset.rio.cattle.io/owner-name: traefik-crd
    objectset.rio.cattle.io/owner-namespace: kube-system
  creationTimestamp: "2024-01-08T17:06:00Z"
  generation: 1
  labels:
    helmcharts.helm.cattle.io/chart: traefik-crd
    objectset.rio.cattle.io/hash: 48ff3d5c3117b372fcdca509795f9f2702af0592
  name: helm-install-traefik-crd
  namespace: kube-system
  resourceVersion: "588"
  uid: 655ceb1b-aaa8-4b24-92ab-fceb2ddd45bd
spec:
  backoffLimit: 1000
  completionMode: NonIndexed
  completions: 1
  parallelism: 1
  selector:
    matchLabels:
      batch.kubernetes.io/controller-uid: 655ceb1b-aaa8-4b24-92ab-fceb2ddd45bd
  suspend: false
  template:
    metadata:
      annotations:
        helmcharts.helm.cattle.io/configHash: SHA256=E3B0C44298FC1C149AFBF4C8996FB92427AE41E4649B934CA495991B7852B855
      creationTimestamp: ~
      labels:
        batch.kubernetes.io/controller-uid: 655ceb1b-aaa8-4b24-92ab-fceb2ddd45bd
        batch.kubernetes.io/job-name: helm-install-traefik-crd
        controller-uid: 655ceb1b-aaa8-4b24-92ab-fceb2ddd45bd
        helmcharts.helm.cattle.io/chart: traefik-crd
        job-name: helm-install-traefik-crd
    spec:
      containers:
      - name: helm
        image: rancher/klipper-helm:v0.8.2-build20230815
        args:
        - install
        env:
        - name: NAME
          value: XXXXXX
        - name: VERSION
          value: XXXXXX
        - name: REPO
          value: XXXXXX
        - name: HELM_DRIVER
          value: XXXXXX
        - name: CHART_NAMESPACE
          value: XXXXXX
        - name: CHART
          value: XXXXXX
        - name: HELM_VERSION
          value: XXXXXX
        - name: TARGET_NAMESPACE
          value: XXXXXX
        - name: AUTH_PASS_CREDENTIALS
          value: XXXXXX
        - name: NO_PROXY
          value: XXXXXX
        - name: FAILURE_POLICY
          value: XXXXXX
        resources: []
        volumeMounts:
        - name: values
          mountPath: /config
        - name: content
          mountPath: /chart
        terminationMessagePath: /dev/termination-log
        terminationMessagePolicy: File
        imagePullPolicy: IfNotPresent
      dnsPolicy: ClusterFirst
      nodeSelector:
        kubernetes.io/os: linux
      restartPolicy: OnFailure
      schedulerName: default-scheduler
      securityContext: []
      serviceAccount: helm-traefik-crd
      serviceAccountName: helm-traefik-crd
      terminationGracePeriodSeconds: 30
      volumes:
      - name: values
        secret:
          defaultMode: 420
          secretName: chart-values-traefik-crd
      - configMap:
          defaultMode: 420
          name: chart-content-traefik-crd
        name: content
...
</pre></div></li></ul></div></div></div><div class='accordion-item'><div class='accordion-header' id='control_10_header'><button class='accordion-button collapsed' type='button' data-bs-toggle='collapse' data-bs-target='#control_10' aria-expanded='false' aria-controls='control_10'><div class='row'><div class='col'><h2 class='fs-4'>C-0018: Configured readiness probe</h2><p class='mb-0'> Readiness probe is intended to ensure that workload is ready to process network traffic. It is highly recommended to define readiness probe for every worker container. This control finds all the pods where the readiness probe is not configured.</p></div></div></button></div><div id='control_10' class='accordion-collapse collapse' aria-labelledby='control_10_header' data-bs-parent='#report'><div class='accordion-body'><p>Readiness probe is intended to ensure that workload is ready to process network traffic. It is highly recommended to define readiness probe for every worker container. This control finds all the pods where the readiness probe is not configured.</p><h5>Remediation</h5><p>Ensure Readiness probes are configured wherever possible.</p><h5>Checked paths and expected values</h5><ul><li>spec.template.spec.containers[*].readinessProbe = YOUR_VALUE</li></ul><h5>Example</h5><pre>readinessProbe:  # we are looking for this section in the resource definition
  exec:
    command:
    - cat
    - /tmp/healthy
  initialDelaySeconds: 5
  periodSeconds: 5</pre><h5>Affected resources</h5><ul><li class='expandable detail-hide'>kube-system DaemonSet svclb-traefik-bf26f129<div class='details'><pre>---
apiVersion: apps/v1
kind: DaemonSet
metadata:
  annotations:
    deprecated.daemonset.template.generation: "1"
    objectset.rio.cattle.io/applied: H4sIAAAAAAAA/8RVwW7jNhD9lWLOsizb2tQR0EOQBEXQrmPY3l4WRjCiRjFriiTIkTZGoH8vKDtZpWsnQYFm4YNBzptH8r3RzCOglX+R89JoyACt9cNmBBFspS4ggyukyuglMURQEWOBjJA9AmptGFka7cPS5H+TYE8cO2ligcyKYmmGMnBAdDJuvmlyg/tmCxkMm1H0yx9SF78tyTVS0Jt5GiuCDNghlXL7Lri3KELOts5p4HeeqYI2AuGoe8xKVuQZKwuZrpWKQGFO6tUnbtBvIIPp5KwUuaBkPC4+FUif8snZ2Xla0oiwnEzPxfkEy18LARH4Rgij2RmlyMXbie+xaVOQJ0WCjYMMSlSe3kjxjfhBiHfgTyhxoPKNUPngQDjIy/FZORqfwz5+ItVbEkGp7/d/hApZbP58FhGtPU3ethEwVVYhU5fbq7d3GPQq98dJ2BMCazaVqTUfCvpCiLBamS1pyDpvIwiHoNTkPGRfH4F00/0f7rNcXN7NbxcriKBBVYetaQJt9AKwuJj9fr3sQZK4+w1fIK+ul6u7+eJ2ddtDri7nP2JeO69D3Mz7p42SOJ3Eo/EoHo8SaNcRyArvQ8ShFhtyw62S1pIbqDxrkjiNUzhg5rVSc6Ok2EEGN+XM8NyRJ83wXInBTWEH0wQisMbxXqZn1ebGMWTTJIKN8fx9dSzbGTbCqKdnryNw5E3tBIUCCsaRqJ3k3aXRTA/cFR5azKWSLGlfZUUB2VeYXa/uLq4+38xg3bZBnrd9S9PJxxr3rwN/lnPhGq9Yl6aTvnfd8ijB/+be+miq33nByvdN1cSxtE0aS3tXGvcNXdEXE9p1d4v+tz7rtVOIgI0i9zQ2w9deliQYMpiZpdhQUavQ7bcURA2jYOCMojj0F6eJyYfmU6FncmHa2cDVzYnrB+nZd27/F8pDoxtYhZpOMu85Lp1kKVBdFIXR/lar3fGEdeiEtS2QackOme53QdbQT6W+/9IF9hPi4YvGBqXCXBFkozAFdjaotniB7TorI9edk6J2jjTP6ion9/TQArIkgoK8dFQcC+lu77P0/sj2grDYQZa07T8BAAD//yoC/PIWCQAA
    objectset.rio.cattle.io/id: ""
    objectset.rio.cattle.io/owner-gvk: /v1, Kind=Service
    objectset.rio.cattle.io/owner-name: traefik
    objectset.rio.cattle.io/owner-namespace: kube-system
  creationTimestamp: "2024-01-08T17:06:48Z"
  generation: 1
  labels:
    objectset.rio.cattle.io/hash: 836fcbce022d5dae5b36694fe1eaf389c93af7dc
    svccontroller.k3s.cattle.io/nodeselector: "false"
    svccontroller.k3s.cattle.io/svcname: traefik
    svccontroller.k3s.cattle.io/svcnamespace: kube-system
  name: svclb-traefik-bf26f129
  namespace: kube-system
  resourceVersion: "615"
  uid: acc5b475-2181-4d70-b320-8de6f12fd45f
spec:
  revisionHistoryLimit: 10
  selector:
    matchLabels:
      app: svclb-traefik-bf26f129
  template:
    metadata:
      creationTimestamp: ~
      labels:
        app: svclb-traefik-bf26f129
        svccontroller.k3s.cattle.io/svcname: traefik
        svccontroller.k3s.cattle.io/svcnamespace: kube-system
    spec:
      automountServiceAccountToken: false
      containers:
      - name: lb-tcp-80
        image: rancher/klipper-lb:v0.4.4
        ports:
        - name: lb-tcp-80
          hostPort: 80
          containerPort: 80
          protocol: TCP
        env:
        - name: SRC_PORT
          value: XXXXXX
        - name: SRC_RANGES
          value: XXXXXX
        - name: DEST_PROTO
          value: XXXXXX
        - name: DEST_PORT
          value: XXXXXX
        - name: DEST_IPS
          value: XXXXXX
        resources: []
        terminationMessagePath: /dev/termination-log
        terminationMessagePolicy: File
        imagePullPolicy: IfNotPresent
        securityContext:
          capabilities:
            add:
            - NET_ADMIN
      - name: lb-tcp-443
        image: rancher/klipper-lb:v0.4.4
        ports:
        - name: lb-tcp-443
          hostPort: 443
          containerPort: 443
          protocol: TCP
        env:
        - name: SRC_PORT
          value: XXXXXX
        - name: SRC_RANGES
          value: XXXXXX
        - name: DEST_PROTO
          value: XXXXXX
        - name: DEST_PORT
          value: XXXXXX
        - name: DEST_IPS
          value: XXXXXX
        resources: []
        terminationMessagePath: /dev/termination-log
        terminationMessagePolicy: File
        imagePullPolicy: IfNotPresent
        securityContext:
          capabilities:
            add:
            - NET_ADMIN
      dnsPolicy: ClusterFirst
      restartPolicy: Always
      schedulerName: default-scheduler
      securityContext:
        sysctls:
        - name: net.ipv4.ip_forward
          value: "1"
      serviceAccount: svclb
      serviceAccountName: svclb
      terminationGracePeriodSeconds: 30
      tolerations:
      - effect: NoSchedule
        key: node-role.kubernetes.io/master
        operator: Exists
      - effect: NoSchedule
        key: node-role.kubernetes.io/control-plane
        operator: Exists
      - key: CriticalAddonsOnly
        operator: Exists
  updateStrategy:
    rollingUpdate:
      maxSurge: 0
      maxUnavailable: 1
    type: RollingUpdate
...
</pre></div></li><li class='expandable detail-hide'>kube-system Deployment local-path-provisioner<div class='details'><pre>---
apiVersion: apps/v1
kind: Deployment
metadata:
  annotations:
    deployment.kubernetes.io/revision: "1"
    objectset.rio.cattle.io/applied: H4sIAAAAAAAA/6xU3W7yRhB9lWqubQMfBCFLvUBJqlZNCEqU3kSoGtZj2LDeXe0Obizkd68Gm/yoIWmlXnl/Zs6emXPGB0Cv/6AQtbOQA3ofB/UIEthpW0AOV+SNayqyDAlUxFggI+QHQGsdI2tno2zd+pkUR+IsaJcpZDaUaTfQAgLJ2Xv3l6WQbuod5LAbx3c39Sj56Xdti5/nReHstxAWK4IcjFNo0sgu4Ib+VVL0qCRzt19TGpvIVEGbgME1mS9L22LcQg6j2bgcX6jpRVmu1Xg4nUyH43IyLkcXs2ExU9MZ/ihwXUwE9ANJj7xNfXC1luZTgO7+DJ/oSQmbQF38r1qKbG50pRnyYQKRDCl2QYIqZLW9ea0AvT//aivgHJBp0xwfcMZou3n0BTJ1YC+PFmvUBteGIB+1CXDjheP9h1g5p8qbU947t5j/wKUvVDnLqC2FCPmTbKsKxZJP59sXGYP4NE2Vs6XeQAIDYjXodv0ne47OwioBsvURuRdleXf152J+e/2wnF9eQwI1mj39ElwlZEpNprin8nW9RBbxTzVmb8q1bbtKQFfivxwCWrWlMPicc14Ps2H2YwJ9wnJvzNIZrRrI4bdy4XgZKHbD9513amf2Fd26veWuY5Use57v2/CG1R2kXSa0KyHug3ZBc3NpMMZFF9e5MLWuoFQFzVqhkXZTqLWiuVLy0uIrfmkfm2IXDAmwMxROP5CnA+xIir7s4Y9DH++saWSIvUSKteH6RUeO0CYHoLIkxZDDwj2oLRV7IwPfwRypBmcokzEKlpiizKyYKjiTeoOW/lfkCiMfdfgEcnVS52RlafstenHTP2Xtvduel6lt278DAAD//8i6p1C4BQAA
    objectset.rio.cattle.io/id: ""
    objectset.rio.cattle.io/owner-gvk: k3s.cattle.io/v1, Kind=Addon
    objectset.rio.cattle.io/owner-name: local-storage
    objectset.rio.cattle.io/owner-namespace: kube-system
  creationTimestamp: "2024-01-08T17:05:58Z"
  generation: 1
  labels:
    objectset.rio.cattle.io/hash: 183f35c65ffbc3064603f43f1580d8c68a2dabd4
  name: local-path-provisioner
  namespace: kube-system
  resourceVersion: "475"
  uid: 718c0dfe-3f1a-4b36-807a-d731f31753f6
spec:
  progressDeadlineSeconds: 600
  replicas: 1
  revisionHistoryLimit: 0
  selector:
    matchLabels:
      app: local-path-provisioner
  strategy:
    rollingUpdate:
      maxSurge: 25%
      maxUnavailable: 1
    type: RollingUpdate
  template:
    metadata:
      creationTimestamp: ~
      labels:
        app: local-path-provisioner
    spec:
      containers:
      - name: local-path-provisioner
        image: rancher/local-path-provisioner:v0.0.24
        command:
        - local-path-provisioner
        - start
        - --config
        - /etc/config/config.json
        env:
        - name: POD_NAMESPACE
          value: XXXXXX
          valueFrom:
            fieldRef:
              apiVersion: v1
              fieldPath: metadata.namespace
        resources: []
        volumeMounts:
        - name: config-volume
          mountPath: /etc/config/
        terminationMessagePath: /dev/termination-log
        terminationMessagePolicy: File
        imagePullPolicy: IfNotPresent
      dnsPolicy: ClusterFirst
      priorityClassName: system-node-critical
      restartPolicy: Always
      schedulerName: default-scheduler
      securityContext: []
      serviceAccount: local-path-provisioner-service-account
      serviceAccountName: local-path-provisioner-service-account
      terminationGracePeriodSeconds: 30
      tolerations:
      - key: CriticalAddonsOnly
        operator: Exists
      - effect: NoSchedule
        key: node-role.kubernetes.io/control-plane
        operator: Exists
      - effect: NoSchedule
        key: node-role.kubernetes.io/master
        operator: Exists
      volumes:
      - configMap:
          defaultMode: 420
          name: local-path-config
        name: config-volume
...
</pre></div></li><li class='expandable detail-hide'>kube-system Job helm-install-traefik<div class='details'><pre>---
apiVersion: batch/v1
kind: Job
metadata:
  annotations:
    batch.kubernetes.io/job-tracking: ""
    objectset.rio.cattle.io/applied: H4sIAAAAAAAA/6xVUY/qNhP9K59Guk9fEgLZbCDSPgQIhd5diAK7alWtkDETcHHsyHZoVyv+e+WQezfb3m5vpb7ZzszxOeM5k1cgFXtCpZkUEMOOGHrsnfvgwImJPcTwo9yBAyUasieGQPwKRAhpiGFSaLuVu1+RGo3GU0x6lBjD0WOyx2z2EXnpUimMkpyjcumRKOMqPDBtVIMBzt8iyN8EKvdwPrVAnU/nvvO/z0zs7+bIy4kF/UccQUqEGIwiWLDTd4XrilCbc6p36OoXbbCEiwNUYUN9w0rUhpQVxKLm3AFOdsiboli6jVbt/Yl5c/pdPI5EHyEG6hejCElEBiEGe6RRfxRGNCLB4KZPgmERYFgQDAvLrNXYVJ0JbQjn7ttFH0jSFVLLe0foSRbFPSuZgbjv+74DBsuKE4P2+wd98IFkKQp2mF/lrOfJILy9C6NJMByPZuPx7ThIg4kfzobRKEgnfhCG09EoDGfRjT9OwptplM4G09HtdBTNhtPb//wBLh35tlMJE6g0xL+8AlEHu4C2lOCA62o0rjaKiQM4cOByR7h3reMUC1Jzk1+b++UOnh1AcW6Q2odZJg8pOHAmvO724sX5GvGU5uvFatk9ytNs1d3P0/uH7TRfPKV5B0sjVWi6cZN5km+29sp1lky6975//PcJnbCjMZWOe71Pr58fx2m+TDfpeptki8unnrYPT6+11L1WhzvoewOv//+6ahb+X0h/Q9wmyX9I/xXL5HEz32bJer2d5Ok0XW4Wyf26k1YQrrGbsFxts3z108+dGE+fqeNRXmuDyuOSEu70fe9m4Pme3+vfNpug3XSxZsni/jFPt9nqfjHpIir80iSXZwdYSQ7NKRH0iKp34qyqULm2FeOz7w29gburGd8P/EHgD/shtDlZzXkmOaMvEMOiWEqTKdQoDLwzNzigUMtaUbTdfnHgLHld4oOshbn2bmmXGTHWc60D3zAa1roR9j6unaRtmLWDvfvybEUJucc1cqRGKmsW+z5KoEHdTE0NMXAm6t+tQ5X1pTJfpazEjDBeKwQHNKozo5hQaq9edkbW26i6ytFd77ScnS+dHr+2qxbh+mu5RrkdczeuLtjhgVQ2R3SjW4Fv4d+S3gwIQ0zdlPryRwAAAP//DrZg0DIHAAA
    objectset.rio.cattle.io/id: helm-controller-chart-registration
    objectset.rio.cattle.io/owner-gvk: helm.cattle.io/v1, Kind=HelmChart
    objectset.rio.cattle.io/owner-name: traefik
    objectset.rio.cattle.io/owner-namespace: kube-system
  creationTimestamp: "2024-01-08T17:06:00Z"
  generation: 1
  labels:
    helmcharts.helm.cattle.io/chart: traefik
    objectset.rio.cattle.io/hash: c0f97ea7a25e3dec71957c7a3241a38f3e5fae5f
  name: helm-install-traefik
  namespace: kube-system
  resourceVersion: "598"
  uid: 2a591629-9af8-4949-b2dd-39bd02b148a4
spec:
  backoffLimit: 1000
  completionMode: NonIndexed
  completions: 1
  parallelism: 1
  selector:
    matchLabels:
      batch.kubernetes.io/controller-uid: 2a591629-9af8-4949-b2dd-39bd02b148a4
  suspend: false
  template:
    metadata:
      annotations:
        helmcharts.helm.cattle.io/configHash: SHA256=57C38B9FBB6B3E3C05F8793EC0355D9955F740BA54D7EF2D96D97F8D678F2B0E
      creationTimestamp: ~
      labels:
        batch.kubernetes.io/controller-uid: 2a591629-9af8-4949-b2dd-39bd02b148a4
        batch.kubernetes.io/job-name: helm-install-traefik
        controller-uid: 2a591629-9af8-4949-b2dd-39bd02b148a4
        helmcharts.helm.cattle.io/chart: traefik
        job-name: helm-install-traefik
    spec:
      containers:
      - name: helm
        image: rancher/klipper-helm:v0.8.2-build20230815
        args:
        - install
        - --set-string
        - global.systemDefaultRegistry=
        env:
        - name: NAME
          value: XXXXXX
        - name: VERSION
          value: XXXXXX
        - name: REPO
          value: XXXXXX
        - name: HELM_DRIVER
          value: XXXXXX
        - name: CHART_NAMESPACE
          value: XXXXXX
        - name: CHART
          value: XXXXXX
        - name: HELM_VERSION
          value: XXXXXX
        - name: TARGET_NAMESPACE
          value: XXXXXX
        - name: AUTH_PASS_CREDENTIALS
          value: XXXXXX
        - name: NO_PROXY
          value: XXXXXX
        - name: FAILURE_POLICY
          value: XXXXXX
        resources: []
        volumeMounts:
        - name: values
          mountPath: /config
        - name: content
          mountPath: /chart
        terminationMessagePath: /dev/termination-log
        terminationMessagePolicy: File
        imagePullPolicy: IfNotPresent
      dnsPolicy: ClusterFirst
      nodeSelector:
        kubernetes.io/os: linux
      restartPolicy: OnFailure
      schedulerName: default-scheduler
      securityContext: []
      serviceAccount: helm-traefik
      serviceAccountName: helm-traefik
      terminationGracePeriodSeconds: 30
      volumes:
      - name: values
        secret:
          defaultMode: 420
          secretName: chart-values-traefik
      - configMap:
          defaultMode: 420
          name: chart-content-traefik
        name: content
...
</pre></div></li><li class='expandable detail-hide'>kube-system Job helm-install-traefik-crd<div class='details'><pre>---
apiVersion: batch/v1
kind: Job
metadata:
  annotations:
    batch.kubernetes.io/job-tracking: ""
    objectset.rio.cattle.io/applied: H4sIAAAAAAAA/7RVUY/iNhD+K9VI99QkJCEsm0j3ELhQ6O0CCuyqVbVCxkzAxbEj26E9If575ZC7hu11e324t9ie7/P3jWcmZyAVe0almRSQwJYYeuidAnDgyMQOEvhZbsGBEg3ZEUMgOQMRQhpimBTaLuX2d6RGo/EUkx4lxnD0mOwxiz4gL10qhVGSc1QuPRBlXIV7po1qOMD5Vwb5h0Dl7k/HlqhzdAqcHz4ysXs/RV6OLel/8ghSIiRgFMGCHV2qdt8E0RWhFnest+jqT9pgCRcHqMJG/pqVqA0pK0hEzbkDnGyRN4mxkhu/2nulvtn9Zi0Hog+QQHRfFP3dgPaDYLjtD8OC7igZ+PEwHhRxEQ79kBT+IA6tutZrk30mtCGcu7eXvWFNV0it/i2hR1kUD6xkBpLA930HDJYVJwbt+Rs18YZ1KQq2n14traZpOLh7n/VH/jiKwvh+Mg7GQRSnk9EkGt/H8d1kFIdROEyzKMiiuygexf1onEbxII6D0fC7PMSlkwJbuYQJVBqS385A1N5+QJtSeHEAxak5ajM+Tx8zcOBEeP262C7Ol6jnLF/NFvPuVp4tF931NHt43HzIZ89Z3uHTSBWabtx4mubrjb12tUzH3btvX/UW0Ak7GFPppNd7d/74NMryebbOVpt0Obu862n7ovSaJN3reHHDwAu94Me6CoN/iP6KuXWa/5T9L5Xp03q6Waar1WacZx+y+XqWPqw6sIJwjV3AfLFZ5otffu3EePpEHY/yWhtUHpeUcCfwvSj0fM/vBXfNot8uulyTdPbwlGeb5eJhNu4yKvz88pcXB1hJ9s0uEfSAqnfkrKpQubbGkpPv3Xuhu60Z34V+2PfvgwG0mGXN+VJyRj9BArNiLs1SoUZh4KZzwQGFWtaKoi3jiwMnyesSH2UtzLUgS/u5JMY2U9taf3M0qnVj7DauHZdtmK1xe/flxZoScocr5EiNVLYD7PsogQZ1MxY1JMCZqP+0radswynzxcpCTAjjtUJwQKM6MYoppfbqeWce3c6hqyXd7aFWt/O52pNz+9WyXP8h1yj3Vec2LVuw/SOpLE50Ea3RW8jX0tBMAENM3aT98lcAAAD//411peIjBwAA
    objectset.rio.cattle.io/id: helm-controller-chart-registration
    objectset.rio.cattle.io/owner-gvk: helm.cattle.io/v1, Kind=HelmChart
    objectset.rio.cattle.io/owner-name: traefik-crd
    objectset.rio.cattle.io/owner-namespace: kube-system
  creationTimestamp: "2024-01-08T17:06:00Z"
  generation: 1
  labels:
    helmcharts.helm.cattle.io/chart: traefik-crd
    objectset.rio.cattle.io/hash: 48ff3d5c3117b372fcdca509795f9f2702af0592
  name: helm-install-traefik-crd
  namespace: kube-system
  resourceVersion: "588"
  uid: 655ceb1b-aaa8-4b24-92ab-fceb2ddd45bd
spec:
  backoffLimit: 1000
  completionMode: NonIndexed
  completions: 1
  parallelism: 1
  selector:
    matchLabels:
      batch.kubernetes.io/controller-uid: 655ceb1b-aaa8-4b24-92ab-fceb2ddd45bd
  suspend: false
  template:
    metadata:
      annotations:
        helmcharts.helm.cattle.io/configHash: SHA256=E3B0C44298FC1C149AFBF4C8996FB92427AE41E4649B934CA495991B7852B855
      creationTimestamp: ~
      labels:
        batch.kubernetes.io/controller-uid: 655ceb1b-aaa8-4b24-92ab-fceb2ddd45bd
        batch.kubernetes.io/job-name: helm-install-traefik-crd
        controller-uid: 655ceb1b-aaa8-4b24-92ab-fceb2ddd45bd
        helmcharts.helm.cattle.io/chart: traefik-crd
        job-name: helm-install-traefik-crd
    spec:
      containers:
      - name: helm
        image: rancher/klipper-helm:v0.8.2-build20230815
        args:
        - install
        env:
        - name: NAME
          value: XXXXXX
        - name: VERSION
          value: XXXXXX
        - name: REPO
          value: XXXXXX
        - name: HELM_DRIVER
          value: XXXXXX
        - name: CHART_NAMESPACE
          value: XXXXXX
        - name: CHART
          value: XXXXXX
        - name: HELM_VERSION
          value: XXXXXX
        - name: TARGET_NAMESPACE
          value: XXXXXX
        - name: AUTH_PASS_CREDENTIALS
          value: XXXXXX
        - name: NO_PROXY
          value: XXXXXX
        - name: FAILURE_POLICY
          value: XXXXXX
        resources: []
        volumeMounts:
        - name: values
          mountPath: /config
        - name: content
          mountPath: /chart
        terminationMessagePath: /dev/termination-log
        terminationMessagePolicy: File
        imagePullPolicy: IfNotPresent
      dnsPolicy: ClusterFirst
      nodeSelector:
        kubernetes.io/os: linux
      restartPolicy: OnFailure
      schedulerName: default-scheduler
      securityContext: []
      serviceAccount: helm-traefik-crd
      serviceAccountName: helm-traefik-crd
      terminationGracePeriodSeconds: 30
      volumes:
      - name: values
        secret:
          defaultMode: 420
          secretName: chart-values-traefik-crd
      - configMap:
          defaultMode: 420
          name: chart-content-traefik-crd
        name: content
...
</pre></div></li></ul></div></div></div><div class='accordion-item'><div class='accordion-header' id='control_11_header'><button class='accordion-button collapsed' type='button' data-bs-toggle='collapse' data-bs-target='#control_11' aria-expanded='false' aria-controls='control_11'><div class='row'><div class='col'><h2 class='fs-4'>C-0030: Ingress and Egress blocked</h2><p class='mb-0'> Disable Ingress and Egress traffic on all pods wherever possible. It is recommended to define restrictive network policy on all new pods, and then enable sources/destinations that this pod must communicate with.</p></div></div></button></div><div id='control_11' class='accordion-collapse collapse' aria-labelledby='control_11_header' data-bs-parent='#report'><div class='accordion-body'><p>Network policies control traffic flow between Pods, namespaces, and external IP addresses. By default, no network policies are applied to Pods or namespaces, resulting in unrestricted ingress and egress traffic within the Pod network. Pods become isolated through a network policy that applies to the Pod or the Pod’s namespace. Once a Pod is selected in a network policy, it rejects any connections that are not specifically allowed by any applicable policy object.Administrators should use a default policy selecting all Pods to deny all ingress and egress traffic and ensure any unselected Pods are isolated. Additional policies could then relax these restrictions for permissible connections.</p><h5>Detection</h5><p>Check for each Pod whether there is an ingress and egress policy defined (whether using Pod or Namespace). </p><h5>Remediation</h5><p>Define a network policy that restricts ingress and egress connections.</p><h5>Example</h5><pre>apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  name: test-network-policy
  namespace: shop
spec:
  podSelector:
    matchLabels:
        app: adservice		#we match it to the workload labels
  policyTypes:
  - Ingress
  - Egress
  ingress:			#we look for this 
  - from:
    - ipBlock:
        cidr: 172.17.0.0/16
        except:
        - 172.17.1.0/24
    - namespaceSelector:
        matchLabels:
          project: myproject
    - podSelector:
        matchLabels:
          role: frontend
    ports:
    - protocol: TCP
      port: 6379
  egress:			
  - to:
    - ipBlock:
        cidr: 10.0.0.0/24
    ports:
    - protocol: TCP
      port: 5978
 </pre><h5>Affected resources</h5><ul><li class='expandable detail-hide'>kube-system DaemonSet svclb-traefik-bf26f129<div class='details'><pre>---
apiVersion: apps/v1
kind: DaemonSet
metadata:
  annotations:
    deprecated.daemonset.template.generation: "1"
    objectset.rio.cattle.io/applied: H4sIAAAAAAAA/8RVwW7jNhD9lWLOsizb2tQR0EOQBEXQrmPY3l4WRjCiRjFriiTIkTZGoH8vKDtZpWsnQYFm4YNBzptH8r3RzCOglX+R89JoyACt9cNmBBFspS4ggyukyuglMURQEWOBjJA9AmptGFka7cPS5H+TYE8cO2ligcyKYmmGMnBAdDJuvmlyg/tmCxkMm1H0yx9SF78tyTVS0Jt5GiuCDNghlXL7Lri3KELOts5p4HeeqYI2AuGoe8xKVuQZKwuZrpWKQGFO6tUnbtBvIIPp5KwUuaBkPC4+FUif8snZ2Xla0oiwnEzPxfkEy18LARH4Rgij2RmlyMXbie+xaVOQJ0WCjYMMSlSe3kjxjfhBiHfgTyhxoPKNUPngQDjIy/FZORqfwz5+ItVbEkGp7/d/hApZbP58FhGtPU3ethEwVVYhU5fbq7d3GPQq98dJ2BMCazaVqTUfCvpCiLBamS1pyDpvIwiHoNTkPGRfH4F00/0f7rNcXN7NbxcriKBBVYetaQJt9AKwuJj9fr3sQZK4+w1fIK+ul6u7+eJ2ddtDri7nP2JeO69D3Mz7p42SOJ3Eo/EoHo8SaNcRyArvQ8ShFhtyw62S1pIbqDxrkjiNUzhg5rVSc6Ok2EEGN+XM8NyRJ83wXInBTWEH0wQisMbxXqZn1ebGMWTTJIKN8fx9dSzbGTbCqKdnryNw5E3tBIUCCsaRqJ3k3aXRTA/cFR5azKWSLGlfZUUB2VeYXa/uLq4+38xg3bZBnrd9S9PJxxr3rwN/lnPhGq9Yl6aTvnfd8ijB/+be+miq33nByvdN1cSxtE0aS3tXGvcNXdEXE9p1d4v+tz7rtVOIgI0i9zQ2w9deliQYMpiZpdhQUavQ7bcURA2jYOCMojj0F6eJyYfmU6FncmHa2cDVzYnrB+nZd27/F8pDoxtYhZpOMu85Lp1kKVBdFIXR/lar3fGEdeiEtS2QackOme53QdbQT6W+/9IF9hPi4YvGBqXCXBFkozAFdjaotniB7TorI9edk6J2jjTP6ion9/TQArIkgoK8dFQcC+lu77P0/sj2grDYQZa07T8BAAD//yoC/PIWCQAA
    objectset.rio.cattle.io/id: ""
    objectset.rio.cattle.io/owner-gvk: /v1, Kind=Service
    objectset.rio.cattle.io/owner-name: traefik
    objectset.rio.cattle.io/owner-namespace: kube-system
  creationTimestamp: "2024-01-08T17:06:48Z"
  generation: 1
  labels:
    objectset.rio.cattle.io/hash: 836fcbce022d5dae5b36694fe1eaf389c93af7dc
    svccontroller.k3s.cattle.io/nodeselector: "false"
    svccontroller.k3s.cattle.io/svcname: traefik
    svccontroller.k3s.cattle.io/svcnamespace: kube-system
  name: svclb-traefik-bf26f129
  namespace: kube-system
  resourceVersion: "615"
  uid: acc5b475-2181-4d70-b320-8de6f12fd45f
spec:
  revisionHistoryLimit: 10
  selector:
    matchLabels:
      app: svclb-traefik-bf26f129
  template:
    metadata:
      creationTimestamp: ~
      labels:
        app: svclb-traefik-bf26f129
        svccontroller.k3s.cattle.io/svcname: traefik
        svccontroller.k3s.cattle.io/svcnamespace: kube-system
    spec:
      automountServiceAccountToken: false
      containers:
      - name: lb-tcp-80
        image: rancher/klipper-lb:v0.4.4
        ports:
        - name: lb-tcp-80
          hostPort: 80
          containerPort: 80
          protocol: TCP
        env:
        - name: SRC_PORT
          value: XXXXXX
        - name: SRC_RANGES
          value: XXXXXX
        - name: DEST_PROTO
          value: XXXXXX
        - name: DEST_PORT
          value: XXXXXX
        - name: DEST_IPS
          value: XXXXXX
        resources: []
        terminationMessagePath: /dev/termination-log
        terminationMessagePolicy: File
        imagePullPolicy: IfNotPresent
        securityContext:
          capabilities:
            add:
            - NET_ADMIN
      - name: lb-tcp-443
        image: rancher/klipper-lb:v0.4.4
        ports:
        - name: lb-tcp-443
          hostPort: 443
          containerPort: 443
          protocol: TCP
        env:
        - name: SRC_PORT
          value: XXXXXX
        - name: SRC_RANGES
          value: XXXXXX
        - name: DEST_PROTO
          value: XXXXXX
        - name: DEST_PORT
          value: XXXXXX
        - name: DEST_IPS
          value: XXXXXX
        resources: []
        terminationMessagePath: /dev/termination-log
        terminationMessagePolicy: File
        imagePullPolicy: IfNotPresent
        securityContext:
          capabilities:
            add:
            - NET_ADMIN
      dnsPolicy: ClusterFirst
      restartPolicy: Always
      schedulerName: default-scheduler
      securityContext:
        sysctls:
        - name: net.ipv4.ip_forward
          value: "1"
      serviceAccount: svclb
      serviceAccountName: svclb
      terminationGracePeriodSeconds: 30
      tolerations:
      - effect: NoSchedule
        key: node-role.kubernetes.io/master
        operator: Exists
      - effect: NoSchedule
        key: node-role.kubernetes.io/control-plane
        operator: Exists
      - key: CriticalAddonsOnly
        operator: Exists
  updateStrategy:
    rollingUpdate:
      maxSurge: 0
      maxUnavailable: 1
    type: RollingUpdate
...
</pre></div></li><li class='expandable detail-hide'>kube-system Deployment local-path-provisioner<div class='details'><pre>---
apiVersion: apps/v1
kind: Deployment
metadata:
  annotations:
    deployment.kubernetes.io/revision: "1"
    objectset.rio.cattle.io/applied: H4sIAAAAAAAA/6xU3W7yRhB9lWqubQMfBCFLvUBJqlZNCEqU3kSoGtZj2LDeXe0Obizkd68Gm/yoIWmlXnl/Zs6emXPGB0Cv/6AQtbOQA3ofB/UIEthpW0AOV+SNayqyDAlUxFggI+QHQGsdI2tno2zd+pkUR+IsaJcpZDaUaTfQAgLJ2Xv3l6WQbuod5LAbx3c39Sj56Xdti5/nReHstxAWK4IcjFNo0sgu4Ib+VVL0qCRzt19TGpvIVEGbgME1mS9L22LcQg6j2bgcX6jpRVmu1Xg4nUyH43IyLkcXs2ExU9MZ/ihwXUwE9ANJj7xNfXC1luZTgO7+DJ/oSQmbQF38r1qKbG50pRnyYQKRDCl2QYIqZLW9ea0AvT//aivgHJBp0xwfcMZou3n0BTJ1YC+PFmvUBteGIB+1CXDjheP9h1g5p8qbU947t5j/wKUvVDnLqC2FCPmTbKsKxZJP59sXGYP4NE2Vs6XeQAIDYjXodv0ne47OwioBsvURuRdleXf152J+e/2wnF9eQwI1mj39ElwlZEpNprin8nW9RBbxTzVmb8q1bbtKQFfivxwCWrWlMPicc14Ps2H2YwJ9wnJvzNIZrRrI4bdy4XgZKHbD9513amf2Fd26veWuY5Use57v2/CG1R2kXSa0KyHug3ZBc3NpMMZFF9e5MLWuoFQFzVqhkXZTqLWiuVLy0uIrfmkfm2IXDAmwMxROP5CnA+xIir7s4Y9DH++saWSIvUSKteH6RUeO0CYHoLIkxZDDwj2oLRV7IwPfwRypBmcokzEKlpiizKyYKjiTeoOW/lfkCiMfdfgEcnVS52RlafstenHTP2Xtvduel6lt278DAAD//8i6p1C4BQAA
    objectset.rio.cattle.io/id: ""
    objectset.rio.cattle.io/owner-gvk: k3s.cattle.io/v1, Kind=Addon
    objectset.rio.cattle.io/owner-name: local-storage
    objectset.rio.cattle.io/owner-namespace: kube-system
  creationTimestamp: "2024-01-08T17:05:58Z"
  generation: 1
  labels:
    objectset.rio.cattle.io/hash: 183f35c65ffbc3064603f43f1580d8c68a2dabd4
  name: local-path-provisioner
  namespace: kube-system
  resourceVersion: "475"
  uid: 718c0dfe-3f1a-4b36-807a-d731f31753f6
spec:
  progressDeadlineSeconds: 600
  replicas: 1
  revisionHistoryLimit: 0
  selector:
    matchLabels:
      app: local-path-provisioner
  strategy:
    rollingUpdate:
      maxSurge: 25%
      maxUnavailable: 1
    type: RollingUpdate
  template:
    metadata:
      creationTimestamp: ~
      labels:
        app: local-path-provisioner
    spec:
      containers:
      - name: local-path-provisioner
        image: rancher/local-path-provisioner:v0.0.24
        command:
        - local-path-provisioner
        - start
        - --config
        - /etc/config/config.json
        env:
        - name: POD_NAMESPACE
          value: XXXXXX
          valueFrom:
            fieldRef:
              apiVersion: v1
              fieldPath: metadata.namespace
        resources: []
        volumeMounts:
        - name: config-volume
          mountPath: /etc/config/
        terminationMessagePath: /dev/termination-log
        terminationMessagePolicy: File
        imagePullPolicy: IfNotPresent
      dnsPolicy: ClusterFirst
      priorityClassName: system-node-critical
      restartPolicy: Always
      schedulerName: default-scheduler
      securityContext: []
      serviceAccount: local-path-provisioner-service-account
      serviceAccountName: local-path-provisioner-service-account
      terminationGracePeriodSeconds: 30
      tolerations:
      - key: CriticalAddonsOnly
        operator: Exists
      - effect: NoSchedule
        key: node-role.kubernetes.io/control-plane
        operator: Exists
      - effect: NoSchedule
        key: node-role.kubernetes.io/master
        operator: Exists
      volumes:
      - configMap:
          defaultMode: 420
          name: local-path-config
        name: config-volume
...
</pre></div></li><li class='expandable detail-hide'>kube-system Deployment traefik<div class='details'><pre>---
apiVersion: apps/v1
kind: Deployment
metadata:
  annotations:
    deployment.kubernetes.io/revision: "1"
    meta.helm.sh/release-name: traefik
    meta.helm.sh/release-namespace: kube-system
  creationTimestamp: "2024-01-08T17:06:48Z"
  generation: 1
  labels:
    app.kubernetes.io/instance: traefik-kube-system
    app.kubernetes.io/managed-by: Helm
    app.kubernetes.io/name: traefik
    helm.sh/chart: traefik-21.2.1_up21.2.0
  name: traefik
  namespace: kube-system
  resourceVersion: "629"
  uid: ec30998f-e81b-47de-aeae-3970de0b73a4
spec:
  progressDeadlineSeconds: 600
  replicas: 1
  revisionHistoryLimit: 10
  selector:
    matchLabels:
      app.kubernetes.io/instance: traefik-kube-system
      app.kubernetes.io/name: traefik
  strategy:
    rollingUpdate:
      maxSurge: 1
      maxUnavailable: 0
    type: RollingUpdate
  template:
    metadata:
      annotations:
        prometheus.io/path: /metrics
        prometheus.io/port: "9100"
        prometheus.io/scrape: "true"
      creationTimestamp: ~
      labels:
        app.kubernetes.io/instance: traefik-kube-system
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: traefik
        helm.sh/chart: traefik-21.2.1_up21.2.0
    spec:
      containers:
      - name: traefik
        image: rancher/mirrored-library-traefik:2.9.10
        args:
        - --global.checknewversion
        - --global.sendanonymoususage
        - --entrypoints.metrics.address=:9100/tcp
        - --entrypoints.traefik.address=:9000/tcp
        - --entrypoints.web.address=:8000/tcp
        - --entrypoints.websecure.address=:8443/tcp
        - --api.dashboard=true
        - --ping=true
        - --metrics.prometheus=true
        - --metrics.prometheus.entrypoint=metrics
        - --providers.kubernetescrd
        - --providers.kubernetesingress
        - --providers.kubernetesingress.ingressendpoint.publishedservice=kube-system/traefik
        - --entrypoints.websecure.http.tls=true
        ports:
        - name: metrics
          containerPort: 9100
          protocol: TCP
        - name: traefik
          containerPort: 9000
          protocol: TCP
        - name: web
          containerPort: 8000
          protocol: TCP
        - name: websecure
          containerPort: 8443
          protocol: TCP
        resources: []
        volumeMounts:
        - name: data
          mountPath: /data
        - name: tmp
          mountPath: /tmp
        livenessProbe:
          httpGet:
            path: /ping
            port: 9000
            scheme: HTTP
          initialDelaySeconds: 2
          timeoutSeconds: 2
          periodSeconds: 10
          successThreshold: 1
          failureThreshold: 3
        readinessProbe:
          httpGet:
            path: /ping
            port: 9000
            scheme: HTTP
          initialDelaySeconds: 2
          timeoutSeconds: 2
          periodSeconds: 10
          successThreshold: 1
          failureThreshold: 1
        terminationMessagePath: /dev/termination-log
        terminationMessagePolicy: File
        imagePullPolicy: IfNotPresent
        securityContext:
          capabilities:
            drop:
            - ALL
          runAsUser: 65532
          runAsGroup: 65532
          runAsNonRoot: true
          readOnlyRootFilesystem: true
      dnsPolicy: ClusterFirst
      priorityClassName: system-cluster-critical
      restartPolicy: Always
      schedulerName: default-scheduler
      securityContext:
        fsGroup: 65532
      serviceAccount: traefik
      serviceAccountName: traefik
      terminationGracePeriodSeconds: 60
      tolerations:
      - key: CriticalAddonsOnly
        operator: Exists
      - effect: NoSchedule
        key: node-role.kubernetes.io/control-plane
        operator: Exists
      - effect: NoSchedule
        key: node-role.kubernetes.io/master
        operator: Exists
      volumes:
      - emptyDir: []
        name: data
      - emptyDir: []
        name: tmp
...
</pre></div></li><li class='expandable detail-hide'>kube-system Job helm-install-traefik<div class='details'><pre>---
apiVersion: batch/v1
kind: Job
metadata:
  annotations:
    batch.kubernetes.io/job-tracking: ""
    objectset.rio.cattle.io/applied: H4sIAAAAAAAA/6xVUY/qNhP9K59Guk9fEgLZbCDSPgQIhd5diAK7alWtkDETcHHsyHZoVyv+e+WQezfb3m5vpb7ZzszxOeM5k1cgFXtCpZkUEMOOGHrsnfvgwImJPcTwo9yBAyUasieGQPwKRAhpiGFSaLuVu1+RGo3GU0x6lBjD0WOyx2z2EXnpUimMkpyjcumRKOMqPDBtVIMBzt8iyN8EKvdwPrVAnU/nvvO/z0zs7+bIy4kF/UccQUqEGIwiWLDTd4XrilCbc6p36OoXbbCEiwNUYUN9w0rUhpQVxKLm3AFOdsiboli6jVbt/Yl5c/pdPI5EHyEG6hejCElEBiEGe6RRfxRGNCLB4KZPgmERYFgQDAvLrNXYVJ0JbQjn7ttFH0jSFVLLe0foSRbFPSuZgbjv+74DBsuKE4P2+wd98IFkKQp2mF/lrOfJILy9C6NJMByPZuPx7ThIg4kfzobRKEgnfhCG09EoDGfRjT9OwptplM4G09HtdBTNhtPb//wBLh35tlMJE6g0xL+8AlEHu4C2lOCA62o0rjaKiQM4cOByR7h3reMUC1Jzk1+b++UOnh1AcW6Q2odZJg8pOHAmvO724sX5GvGU5uvFatk9ytNs1d3P0/uH7TRfPKV5B0sjVWi6cZN5km+29sp1lky6975//PcJnbCjMZWOe71Pr58fx2m+TDfpeptki8unnrYPT6+11L1WhzvoewOv//+6ahb+X0h/Q9wmyX9I/xXL5HEz32bJer2d5Ok0XW4Wyf26k1YQrrGbsFxts3z108+dGE+fqeNRXmuDyuOSEu70fe9m4Pme3+vfNpug3XSxZsni/jFPt9nqfjHpIir80iSXZwdYSQ7NKRH0iKp34qyqULm2FeOz7w29gburGd8P/EHgD/shtDlZzXkmOaMvEMOiWEqTKdQoDLwzNzigUMtaUbTdfnHgLHld4oOshbn2bmmXGTHWc60D3zAa1roR9j6unaRtmLWDvfvybEUJucc1cqRGKmsW+z5KoEHdTE0NMXAm6t+tQ5X1pTJfpazEjDBeKwQHNKozo5hQaq9edkbW26i6ytFd77ScnS+dHr+2qxbh+mu5RrkdczeuLtjhgVQ2R3SjW4Fv4d+S3gwIQ0zdlPryRwAAAP//DrZg0DIHAAA
    objectset.rio.cattle.io/id: helm-controller-chart-registration
    objectset.rio.cattle.io/owner-gvk: helm.cattle.io/v1, Kind=HelmChart
    objectset.rio.cattle.io/owner-name: traefik
    objectset.rio.cattle.io/owner-namespace: kube-system
  creationTimestamp: "2024-01-08T17:06:00Z"
  generation: 1
  labels:
    helmcharts.helm.cattle.io/chart: traefik
    objectset.rio.cattle.io/hash: c0f97ea7a25e3dec71957c7a3241a38f3e5fae5f
  name: helm-install-traefik
  namespace: kube-system
  resourceVersion: "598"
  uid: 2a591629-9af8-4949-b2dd-39bd02b148a4
spec:
  backoffLimit: 1000
  completionMode: NonIndexed
  completions: 1
  parallelism: 1
  selector:
    matchLabels:
      batch.kubernetes.io/controller-uid: 2a591629-9af8-4949-b2dd-39bd02b148a4
  suspend: false
  template:
    metadata:
      annotations:
        helmcharts.helm.cattle.io/configHash: SHA256=57C38B9FBB6B3E3C05F8793EC0355D9955F740BA54D7EF2D96D97F8D678F2B0E
      creationTimestamp: ~
      labels:
        batch.kubernetes.io/controller-uid: 2a591629-9af8-4949-b2dd-39bd02b148a4
        batch.kubernetes.io/job-name: helm-install-traefik
        controller-uid: 2a591629-9af8-4949-b2dd-39bd02b148a4
        helmcharts.helm.cattle.io/chart: traefik
        job-name: helm-install-traefik
    spec:
      containers:
      - name: helm
        image: rancher/klipper-helm:v0.8.2-build20230815
        args:
        - install
        - --set-string
        - global.systemDefaultRegistry=
        env:
        - name: NAME
          value: XXXXXX
        - name: VERSION
          value: XXXXXX
        - name: REPO
          value: XXXXXX
        - name: HELM_DRIVER
          value: XXXXXX
        - name: CHART_NAMESPACE
          value: XXXXXX
        - name: CHART
          value: XXXXXX
        - name: HELM_VERSION
          value: XXXXXX
        - name: TARGET_NAMESPACE
          value: XXXXXX
        - name: AUTH_PASS_CREDENTIALS
          value: XXXXXX
        - name: NO_PROXY
          value: XXXXXX
        - name: FAILURE_POLICY
          value: XXXXXX
        resources: []
        volumeMounts:
        - name: values
          mountPath: /config
        - name: content
          mountPath: /chart
        terminationMessagePath: /dev/termination-log
        terminationMessagePolicy: File
        imagePullPolicy: IfNotPresent
      dnsPolicy: ClusterFirst
      nodeSelector:
        kubernetes.io/os: linux
      restartPolicy: OnFailure
      schedulerName: default-scheduler
      securityContext: []
      serviceAccount: helm-traefik
      serviceAccountName: helm-traefik
      terminationGracePeriodSeconds: 30
      volumes:
      - name: values
        secret:
          defaultMode: 420
          secretName: chart-values-traefik
      - configMap:
          defaultMode: 420
          name: chart-content-traefik
        name: content
...
</pre></div></li><li class='expandable detail-hide'>kube-system Job helm-install-traefik-crd<div class='details'><pre>---
apiVersion: batch/v1
kind: Job
metadata:
  annotations:
    batch.kubernetes.io/job-tracking: ""
    objectset.rio.cattle.io/applied: H4sIAAAAAAAA/7RVUY/iNhD+K9VI99QkJCEsm0j3ELhQ6O0CCuyqVbVCxkzAxbEj26E9If575ZC7hu11e324t9ie7/P3jWcmZyAVe0almRSQwJYYeuidAnDgyMQOEvhZbsGBEg3ZEUMgOQMRQhpimBTaLuX2d6RGo/EUkx4lxnD0mOwxiz4gL10qhVGSc1QuPRBlXIV7po1qOMD5Vwb5h0Dl7k/HlqhzdAqcHz4ysXs/RV6OLel/8ghSIiRgFMGCHV2qdt8E0RWhFnest+jqT9pgCRcHqMJG/pqVqA0pK0hEzbkDnGyRN4mxkhu/2nulvtn9Zi0Hog+QQHRfFP3dgPaDYLjtD8OC7igZ+PEwHhRxEQ79kBT+IA6tutZrk30mtCGcu7eXvWFNV0it/i2hR1kUD6xkBpLA930HDJYVJwbt+Rs18YZ1KQq2n14traZpOLh7n/VH/jiKwvh+Mg7GQRSnk9EkGt/H8d1kFIdROEyzKMiiuygexf1onEbxII6D0fC7PMSlkwJbuYQJVBqS385A1N5+QJtSeHEAxak5ajM+Tx8zcOBEeP262C7Ol6jnLF/NFvPuVp4tF931NHt43HzIZ89Z3uHTSBWabtx4mubrjb12tUzH3btvX/UW0Ak7GFPppNd7d/74NMryebbOVpt0Obu862n7ovSaJN3reHHDwAu94Me6CoN/iP6KuXWa/5T9L5Xp03q6Waar1WacZx+y+XqWPqw6sIJwjV3AfLFZ5otffu3EePpEHY/yWhtUHpeUcCfwvSj0fM/vBXfNot8uulyTdPbwlGeb5eJhNu4yKvz88pcXB1hJ9s0uEfSAqnfkrKpQubbGkpPv3Xuhu60Z34V+2PfvgwG0mGXN+VJyRj9BArNiLs1SoUZh4KZzwQGFWtaKoi3jiwMnyesSH2UtzLUgS/u5JMY2U9taf3M0qnVj7DauHZdtmK1xe/flxZoScocr5EiNVLYD7PsogQZ1MxY1JMCZqP+0radswynzxcpCTAjjtUJwQKM6MYoppfbqeWce3c6hqyXd7aFWt/O52pNz+9WyXP8h1yj3Vec2LVuw/SOpLE50Ea3RW8jX0tBMAENM3aT98lcAAAD//411peIjBwAA
    objectset.rio.cattle.io/id: helm-controller-chart-registration
    objectset.rio.cattle.io/owner-gvk: helm.cattle.io/v1, Kind=HelmChart
    objectset.rio.cattle.io/owner-name: traefik-crd
    objectset.rio.cattle.io/owner-namespace: kube-system
  creationTimestamp: "2024-01-08T17:06:00Z"
  generation: 1
  labels:
    helmcharts.helm.cattle.io/chart: traefik-crd
    objectset.rio.cattle.io/hash: 48ff3d5c3117b372fcdca509795f9f2702af0592
  name: helm-install-traefik-crd
  namespace: kube-system
  resourceVersion: "588"
  uid: 655ceb1b-aaa8-4b24-92ab-fceb2ddd45bd
spec:
  backoffLimit: 1000
  completionMode: NonIndexed
  completions: 1
  parallelism: 1
  selector:
    matchLabels:
      batch.kubernetes.io/controller-uid: 655ceb1b-aaa8-4b24-92ab-fceb2ddd45bd
  suspend: false
  template:
    metadata:
      annotations:
        helmcharts.helm.cattle.io/configHash: SHA256=E3B0C44298FC1C149AFBF4C8996FB92427AE41E4649B934CA495991B7852B855
      creationTimestamp: ~
      labels:
        batch.kubernetes.io/controller-uid: 655ceb1b-aaa8-4b24-92ab-fceb2ddd45bd
        batch.kubernetes.io/job-name: helm-install-traefik-crd
        controller-uid: 655ceb1b-aaa8-4b24-92ab-fceb2ddd45bd
        helmcharts.helm.cattle.io/chart: traefik-crd
        job-name: helm-install-traefik-crd
    spec:
      containers:
      - name: helm
        image: rancher/klipper-helm:v0.8.2-build20230815
        args:
        - install
        env:
        - name: NAME
          value: XXXXXX
        - name: VERSION
          value: XXXXXX
        - name: REPO
          value: XXXXXX
        - name: HELM_DRIVER
          value: XXXXXX
        - name: CHART_NAMESPACE
          value: XXXXXX
        - name: CHART
          value: XXXXXX
        - name: HELM_VERSION
          value: XXXXXX
        - name: TARGET_NAMESPACE
          value: XXXXXX
        - name: AUTH_PASS_CREDENTIALS
          value: XXXXXX
        - name: NO_PROXY
          value: XXXXXX
        - name: FAILURE_POLICY
          value: XXXXXX
        resources: []
        volumeMounts:
        - name: values
          mountPath: /config
        - name: content
          mountPath: /chart
        terminationMessagePath: /dev/termination-log
        terminationMessagePolicy: File
        imagePullPolicy: IfNotPresent
      dnsPolicy: ClusterFirst
      nodeSelector:
        kubernetes.io/os: linux
      restartPolicy: OnFailure
      schedulerName: default-scheduler
      securityContext: []
      serviceAccount: helm-traefik-crd
      serviceAccountName: helm-traefik-crd
      terminationGracePeriodSeconds: 30
      volumes:
      - name: values
        secret:
          defaultMode: 420
          secretName: chart-values-traefik-crd
      - configMap:
          defaultMode: 420
          name: chart-content-traefik-crd
        name: content
...
</pre></div></li></ul></div></div></div><div class='accordion-item'><div class='accordion-header' id='control_12_header'><button class='accordion-button collapsed' type='button' data-bs-toggle='collapse' data-bs-target='#control_12' aria-expanded='false' aria-controls='control_12'><div class='row'><div class='col'><h2 class='fs-4'>C-0031: Delete Kubernetes events</h2><p class='mb-0'> Attackers may delete Kubernetes events to avoid detection of their activity in the cluster. This control identifies all the subjects that can delete Kubernetes events.</p></div></div></button></div><div id='control_12' class='accordion-collapse collapse' aria-labelledby='control_12_header' data-bs-parent='#report'><div class='accordion-body'><p>A Kubernetes event is a Kubernetes object that logs state changes and failures of the resources in the cluster. Example events are a container creation, an image pull, or a pod scheduling on a node. Kubernetes events can be very useful for identifying changes that occur in the cluster. Therefore, attackers may want to delete these events (e.g., by using: “kubectl delete events–all”) in an attempt to avoid detection of their activity in the cluster.</p><h5>Detection</h5><p>List who has delete/deletecollection RBAC permissions on events.</p><h5>Remediation</h5><p>You should follow the least privilege principle. Minimize the number of subjects who can delete Kubernetes events. Avoid using these subjects in the daily operations.</p><h5>Checked paths and expected values</h5><ul><li>relatedObjects[*].roleRef.name</li><li>relatedObjects[*].rules[*].apiGroups[*]</li><li>relatedObjects[*].rules[*].resources[*]</li><li>relatedObjects[*].rules[*].verbs[*]</li><li>relatedObjects[*].subjects[*]</li></ul><h5>Example</h5><pre>kind: Role
apiVersion: rbac.authorization.k8s.io/v1
metadata:
  namespace: default
  name: pod-exec
rules:
- apiGroups: ["*"]
  resources: ["events"]  		   # we look for this resource or *
  verbs: ["delete","deletecollection"]	   # we look for this verb or * 	</pre><h5>Affected resources</h5><ul><li class='expandable detail-hide'>kube-system ServiceAccount helm-traefik<div class='details'><pre>---
kind: ServiceAccount
name: helm-traefik
namespace: kube-system
relatedObjects:
- apiVersion: rbac.authorization.k8s.io/v1
  kind: ClusterRoleBinding
  metadata:
    annotations:
      objectset.rio.cattle.io/applied: H4sIAAAAAAAA/4yRze6TUBDFX8XMGlD+SGhJXGgXmrirxo1xMVyGMnI/yNwBo03f3UBbrYmtLu/H+c2Zc46AI38iiRw81CANmgwn7YPwD1QOPhs2MePwfM4hgYF9CzXs7BSVZB8svWHfsj9AAo4UW1SE+gjofdBVHpdjaL6S0UiaCYfMoKqlhckLrCfrUhO8SrCWJDU9iqZCB44qKwOSu4TwzZOkh3m4gG6e5jx59p59++odWbdboP/keHQENaggdTz81/c4olk0w9RQGr9HJQenBIzQav0jO4qKboTaT9YmYLEh+zCUHmMPNZgX3bYirPCppKIlU+XbsjIVFk8vcyw2XUFlh1R2y7SL7zXJGyPpdZFTAhIs7albyxn5rYRpfFT3X7uGX5PM+TLF1rFf8HE6bwP15+NV+YFkZkOvjQmTV/jT5u+M76b45fQzAAD//6tHuTCdAgAA
      objectset.rio.cattle.io/id: helm-controller-chart-registration
      objectset.rio.cattle.io/owner-gvk: helm.cattle.io/v1, Kind=HelmChart
      objectset.rio.cattle.io/owner-name: traefik
      objectset.rio.cattle.io/owner-namespace: kube-system
    creationTimestamp: "2024-01-08T17:06:00Z"
    labels:
      objectset.rio.cattle.io/hash: c0f97ea7a25e3dec71957c7a3241a38f3e5fae5f
    name: helm-kube-system-traefik
    resourceVersion: "349"
    uid: a815f9db-1d48-4564-a669-936f12c9a7ec
  roleRef:
    apiGroup: rbac.authorization.k8s.io
    kind: ClusterRole
    name: cluster-admin
  subjects:
  - kind: ServiceAccount
    name: helm-traefik
    namespace: kube-system
- apiVersion: rbac.authorization.k8s.io/v1
  kind: ClusterRole
  metadata:
    annotations:
      rbac.authorization.kubernetes.io/autoupdate: "true"
    creationTimestamp: "2024-01-08T17:05:54Z"
    labels:
      kubernetes.io/bootstrapping: rbac-defaults
    name: cluster-admin
    resourceVersion: "72"
    uid: 7a564a7b-9ca4-49ce-8a42-78660cb44f4c
  rules:
  - apiGroups:
    - '*'
    resources:
    - '*'
    verbs:
    - '*'
  - nonResourceURLs:
    - '*'
    verbs:
    - '*'
...
</pre></div></li><li class='expandable detail-hide'>kube-system ServiceAccount helm-traefik-crd<div class='details'><pre>---
kind: ServiceAccount
name: helm-traefik-crd
namespace: kube-system
relatedObjects:
- apiVersion: rbac.authorization.k8s.io/v1
  kind: ClusterRoleBinding
  metadata:
    annotations:
      objectset.rio.cattle.io/applied: H4sIAAAAAAAA/4yRzY7UQAyEXwX5nA7zw2g2kTjAHkDitiAuiIPT7Z6Y9E/kdoJgNO+Okl3QrMQuHLut+lyuOgOO/JmkcE7QgnRoa5y0z8I/UTmnergpNeeX8xYqGDg5aOE2TEVJ7nKgt5wcpxNUEEnRoSK0Z8CUsq7ysjxz942sFtJaONcWVQMtTF5gPYVobE4qOQQSY3sUNUInLiorA6onCfl7IjGneXgAXY3mbfXiAyf3+j2FeLtA/8lJGAlaUEHyPBgr7r8kZUS76IapI1N+FKUIlwqs0Gr/E0cqinGENk0hVBCwo/BsMD2WHlp4deP93h3sfrs9dvvjzltn8bBpjs3BN3533OzQbw7Nbtn24H1N88qIuT7mUoHkQHfk15JGfid5Gp+r/a+dw59t9v7ToIucFnyZ7i+C9sv5t/IjycyW3libp6Tw2OrjrJ9M8+vlVwAAAP//b1bdJakCAAA
      objectset.rio.cattle.io/id: helm-controller-chart-registration
      objectset.rio.cattle.io/owner-gvk: helm.cattle.io/v1, Kind=HelmChart
      objectset.rio.cattle.io/owner-name: traefik-crd
      objectset.rio.cattle.io/owner-namespace: kube-system
    creationTimestamp: "2024-01-08T17:06:00Z"
    labels:
      objectset.rio.cattle.io/hash: 48ff3d5c3117b372fcdca509795f9f2702af0592
    name: helm-kube-system-traefik-crd
    resourceVersion: "348"
    uid: 31be0c7e-dd79-49c6-9a13-77f5f124746c
  roleRef:
    apiGroup: rbac.authorization.k8s.io
    kind: ClusterRole
    name: cluster-admin
  subjects:
  - kind: ServiceAccount
    name: helm-traefik-crd
    namespace: kube-system
- apiVersion: rbac.authorization.k8s.io/v1
  kind: ClusterRole
  metadata:
    annotations:
      rbac.authorization.kubernetes.io/autoupdate: "true"
    creationTimestamp: "2024-01-08T17:05:54Z"
    labels:
      kubernetes.io/bootstrapping: rbac-defaults
    name: cluster-admin
    resourceVersion: "72"
    uid: 7a564a7b-9ca4-49ce-8a42-78660cb44f4c
  rules:
  - apiGroups:
    - '*'
    resources:
    - '*'
    verbs:
    - '*'
  - nonResourceURLs:
    - '*'
    verbs:
    - '*'
...
</pre></div></li></ul></div></div></div><div class='accordion-item'><div class='accordion-header' id='control_13_header'><button class='accordion-button collapsed' type='button' data-bs-toggle='collapse' data-bs-target='#control_13' aria-expanded='false' aria-controls='control_13'><div class='row'><div class='col'><h2 class='fs-4'>C-0034: Automatic mapping of service account</h2><p class='mb-0'> Potential attacker may gain access to a pod and steal its service account token. Therefore, it is recommended to disable automatic mapping of the service account tokens in service account configuration and enable it only for pods that need to use them.</p></div></div></button></div><div id='control_13' class='accordion-collapse collapse' aria-labelledby='control_13_header' data-bs-parent='#report'><div class='accordion-body'><p>We have it in Armo best (Automatic mapping of service account token).</p><h5>Detection</h5><p>Check all service accounts on which automount is not disabled.  Check all workloads on which they and their service account don't disable automount </p><h5>Remediation</h5><p>Disable automatic mounting of service account tokens to pods either at the service account level or at the individual pod level, by specifying the automountServiceAccountToken: false. Note that pod level takes precedence.</p><h5>Checked paths and expected values</h5><ul><li>automountServiceAccountToken</li><li>automountServiceAccountToken = false</li></ul><h5>Example</h5><pre>apiVersion: v1
kind: ServiceAccount
metadata:
  name: build-robot
automountServiceAccountToken: false # we look for this attribute</pre><h5>Affected resources</h5><ul><li class='expandable detail-hide'>kube-system ServiceAccount helm-traefik<div class='details'><pre>---
apiVersion: v1
automountServiceAccountToken: true
kind: ServiceAccount
metadata:
  annotations:
    objectset.rio.cattle.io/applied: H4sIAAAAAAAA/4yQzUrDQBSFX0XuelJNY4gdcCFuBJcW97eTk2bM/JSZm4iUvrskFNRF1eVhznz34xyJD/YVKdsYSNNUkiIeJfo4BnlBmqzBgzFz2sYBgbSkEYoGG1rS9LNBijyEWxYmfSQOIQqLjSHPMe7eYCRDVsnGlWERh5WN13YG9XC+MDFIis4hFabnJEXC3mZJC4PURUJ8D0jFfhrOoG9PU6munm1o75/g/OMM/ZMT2IM0SWJ0dvhXPR/YzH+GcYcif2SBp5Mik7Cob61HFvYH0mF0TpHjHdyvo/Sce9JkbrpNA254XaNqYZpyUzem4Wp9W3J111WoO0bdzdfO3suSX/IX9U6fAQAA//8OYeye+wEAAA
    objectset.rio.cattle.io/id: helm-controller-chart-registration
    objectset.rio.cattle.io/owner-gvk: helm.cattle.io/v1, Kind=HelmChart
    objectset.rio.cattle.io/owner-name: traefik
    objectset.rio.cattle.io/owner-namespace: kube-system
  creationTimestamp: "2024-01-08T17:06:00Z"
  labels:
    objectset.rio.cattle.io/hash: c0f97ea7a25e3dec71957c7a3241a38f3e5fae5f
  name: helm-traefik
  namespace: kube-system
  resourceVersion: "347"
  uid: d927443d-b78a-4508-a7db-7d9ddfe57f62
...
</pre></div></li><li class='expandable detail-hide'>kube-system ServiceAccount helm-traefik-crd<div class='details'><pre>---
apiVersion: v1
automountServiceAccountToken: true
kind: ServiceAccount
metadata:
  annotations:
    objectset.rio.cattle.io/applied: H4sIAAAAAAAA/4yQz07zQAzEX+WTz5t+TUoUshIHxAWJIxV3Z+NtluyfyusEoarvjhL1QA8FjiN7fh7PCfDo3oizSxE0zCUowElSSFOUV+LZGXo0ZlH7NFIELTyRgtHFHjRcb4CCQII9CoI+AcaYBMWlmBeZuncykkk27NLGoIinjUv/3QIayIfCpCicvCcuzIAsBdPBZeGVAeomIX1E4uIwjxfQt9Fcqn8vLvYPz+TD0wL9lRMxEGgQRrJuLAz3f7LkI5rFN04dFfkzCwU4KzBMa/y9C5QFwxF0nLxX4LEj/2MxA+YBNNzdW7vra7Mry6bbNZU1vcF62zZtbVtbNdsK7bZuq+XaJfva5vUDNyOevwIAAP//D+VkGwMCAAA
    objectset.rio.cattle.io/id: helm-controller-chart-registration
    objectset.rio.cattle.io/owner-gvk: helm.cattle.io/v1, Kind=HelmChart
    objectset.rio.cattle.io/owner-name: traefik-crd
    objectset.rio.cattle.io/owner-namespace: kube-system
  creationTimestamp: "2024-01-08T17:06:00Z"
  labels:
    objectset.rio.cattle.io/hash: 48ff3d5c3117b372fcdca509795f9f2702af0592
  name: helm-traefik-crd
  namespace: kube-system
  resourceVersion: "346"
  uid: 8b5adf3c-86f1-4eb5-b368-424a083d7fdf
...
</pre></div></li><li class='expandable detail-hide'>kube-system ServiceAccount local-path-provisioner-service-account<div class='details'><pre>---
apiVersion: v1
kind: ServiceAccount
metadata:
  annotations:
    objectset.rio.cattle.io/applied: H4sIAAAAAAAA/4yQQUvEMBCF/4rMuVlb05YS8LBnj4L3aTLdxraZkpmtyLL/XYogelj1ODzex5vvArjGF8oSOYGDrYICppgCOHimvEVPR+/5nBQKWEgxoCK4C2BKrKiRk+wn96/kVUgPOfLBo+pMh8j3cQdBcTPnt0TZnLYJHExWviVbVdw9xRQejyFw+hORcCFwMLPH2YhyxhP9qyQr+r05nXsy8i5KC1wLmLGn+dfXRpQRHFSdHWzj22YYem/Ltm5LO9R2qJquDJ1vO3wI2Id6h/4YuaKOZs28xd09ZSOfvg1+Cb+57/oRAAD///h+7Ma3AQAA
    objectset.rio.cattle.io/id: ""
    objectset.rio.cattle.io/owner-gvk: k3s.cattle.io/v1, Kind=Addon
    objectset.rio.cattle.io/owner-name: local-storage
    objectset.rio.cattle.io/owner-namespace: kube-system
  creationTimestamp: "2024-01-08T17:05:58Z"
  labels:
    objectset.rio.cattle.io/hash: 183f35c65ffbc3064603f43f1580d8c68a2dabd4
  name: local-path-provisioner-service-account
  namespace: kube-system
  resourceVersion: "268"
  uid: 3a0117f5-0601-4b4b-818c-71263aeed29c
...
</pre></div></li><li class='expandable detail-hide'>kube-system ServiceAccount svclb<div class='details'><pre>---
apiVersion: v1
kind: ServiceAccount
metadata:
  creationTimestamp: "2024-01-08T17:05:59Z"
  name: svclb
  namespace: kube-system
  resourceVersion: "307"
  uid: 91b3fe63-0ab5-4d42-bc9b-8888ac1763bf
...
</pre></div></li><li class='expandable detail-hide'>kube-system ServiceAccount traefik<div class='details'><pre>---
apiVersion: v1
kind: ServiceAccount
metadata:
  annotations:
    meta.helm.sh/release-name: traefik
    meta.helm.sh/release-namespace: kube-system
  creationTimestamp: "2024-01-08T17:06:48Z"
  labels:
    app.kubernetes.io/instance: traefik-kube-system
    app.kubernetes.io/managed-by: Helm
    app.kubernetes.io/name: traefik
    helm.sh/chart: traefik-21.2.1_up21.2.0
  name: traefik
  namespace: kube-system
  resourceVersion: "544"
  uid: b460680a-d16c-4973-9d2a-9b9648431fad
...
</pre></div></li></ul></div></div></div><div class='accordion-item'><div class='accordion-header' id='control_14_header'><button class='accordion-button collapsed' type='button' data-bs-toggle='collapse' data-bs-target='#control_14' aria-expanded='false' aria-controls='control_14'><div class='row'><div class='col'><h2 class='fs-4'>C-0035: Cluster-admin binding</h2><p class='mb-0'> Attackers who have cluster admin permissions (can perform any action on any resource), can take advantage of their privileges for malicious activities. This control determines which subjects have cluster admin permissions.</p></div></div></button></div><div id='control_14' class='accordion-collapse collapse' aria-labelledby='control_14_header' data-bs-parent='#report'><div class='accordion-body'><p>Role-based access control (RBAC) is a key security feature in Kubernetes. RBAC can restrict the allowed actions of the various identities in the cluster. Cluster-admin is a built-in high privileged role in Kubernetes. Attackers who have permissions to create bindings and cluster-bindings in the cluster can create a binding to the cluster-admin ClusterRole or to other high privileges roles.</p><h5>Detection</h5><p>Check which subjects have cluster-admin RBAC permissions – either by being bound to the cluster-admin clusterrole, or by having equivalent high privileges.  </p><h5>Remediation</h5><p>You should apply least privilege principle. Make sure cluster admin permissions are granted only when it is absolutely necessary. Don't use subjects with such high permissions for daily operations.</p><h5>Checked paths and expected values</h5><ul><li>relatedObjects[*].roleRef.name</li><li>relatedObjects[*].rules[*].apiGroups[*]</li><li>relatedObjects[*].rules[*].resources[*]</li><li>relatedObjects[*].rules[*].verbs[*]</li><li>relatedObjects[*].subjects[*]</li></ul><h5>Affected resources</h5><ul><li class='expandable detail-hide'>kube-system ServiceAccount helm-traefik<div class='details'><pre>---
kind: ServiceAccount
name: helm-traefik
namespace: kube-system
relatedObjects:
- apiVersion: rbac.authorization.k8s.io/v1
  kind: ClusterRoleBinding
  metadata:
    annotations:
      objectset.rio.cattle.io/applied: H4sIAAAAAAAA/4yRze6TUBDFX8XMGlD+SGhJXGgXmrirxo1xMVyGMnI/yNwBo03f3UBbrYmtLu/H+c2Zc46AI38iiRw81CANmgwn7YPwD1QOPhs2MePwfM4hgYF9CzXs7BSVZB8svWHfsj9AAo4UW1SE+gjofdBVHpdjaL6S0UiaCYfMoKqlhckLrCfrUhO8SrCWJDU9iqZCB44qKwOSu4TwzZOkh3m4gG6e5jx59p59++odWbdboP/keHQENaggdTz81/c4olk0w9RQGr9HJQenBIzQav0jO4qKboTaT9YmYLEh+zCUHmMPNZgX3bYirPCppKIlU+XbsjIVFk8vcyw2XUFlh1R2y7SL7zXJGyPpdZFTAhIs7albyxn5rYRpfFT3X7uGX5PM+TLF1rFf8HE6bwP15+NV+YFkZkOvjQmTV/jT5u+M76b45fQzAAD//6tHuTCdAgAA
      objectset.rio.cattle.io/id: helm-controller-chart-registration
      objectset.rio.cattle.io/owner-gvk: helm.cattle.io/v1, Kind=HelmChart
      objectset.rio.cattle.io/owner-name: traefik
      objectset.rio.cattle.io/owner-namespace: kube-system
    creationTimestamp: "2024-01-08T17:06:00Z"
    labels:
      objectset.rio.cattle.io/hash: c0f97ea7a25e3dec71957c7a3241a38f3e5fae5f
    name: helm-kube-system-traefik
    resourceVersion: "349"
    uid: a815f9db-1d48-4564-a669-936f12c9a7ec
  roleRef:
    apiGroup: rbac.authorization.k8s.io
    kind: ClusterRole
    name: cluster-admin
  subjects:
  - kind: ServiceAccount
    name: helm-traefik
    namespace: kube-system
- apiVersion: rbac.authorization.k8s.io/v1
  kind: ClusterRole
  metadata:
    annotations:
      rbac.authorization.kubernetes.io/autoupdate: "true"
    creationTimestamp: "2024-01-08T17:05:54Z"
    labels:
      kubernetes.io/bootstrapping: rbac-defaults
    name: cluster-admin
    resourceVersion: "72"
    uid: 7a564a7b-9ca4-49ce-8a42-78660cb44f4c
  rules:
  - apiGroups:
    - '*'
    resources:
    - '*'
    verbs:
    - '*'
  - nonResourceURLs:
    - '*'
    verbs:
    - '*'
...
</pre></div></li><li class='expandable detail-hide'>kube-system ServiceAccount helm-traefik-crd<div class='details'><pre>---
kind: ServiceAccount
name: helm-traefik-crd
namespace: kube-system
relatedObjects:
- apiVersion: rbac.authorization.k8s.io/v1
  kind: ClusterRoleBinding
  metadata:
    annotations:
      objectset.rio.cattle.io/applied: H4sIAAAAAAAA/4yRzY7UQAyEXwX5nA7zw2g2kTjAHkDitiAuiIPT7Z6Y9E/kdoJgNO+Okl3QrMQuHLut+lyuOgOO/JmkcE7QgnRoa5y0z8I/UTmnergpNeeX8xYqGDg5aOE2TEVJ7nKgt5wcpxNUEEnRoSK0Z8CUsq7ysjxz942sFtJaONcWVQMtTF5gPYVobE4qOQQSY3sUNUInLiorA6onCfl7IjGneXgAXY3mbfXiAyf3+j2FeLtA/8lJGAlaUEHyPBgr7r8kZUS76IapI1N+FKUIlwqs0Gr/E0cqinGENk0hVBCwo/BsMD2WHlp4deP93h3sfrs9dvvjzltn8bBpjs3BN3533OzQbw7Nbtn24H1N88qIuT7mUoHkQHfk15JGfid5Gp+r/a+dw59t9v7ToIucFnyZ7i+C9sv5t/IjycyW3libp6Tw2OrjrJ9M8+vlVwAAAP//b1bdJakCAAA
      objectset.rio.cattle.io/id: helm-controller-chart-registration
      objectset.rio.cattle.io/owner-gvk: helm.cattle.io/v1, Kind=HelmChart
      objectset.rio.cattle.io/owner-name: traefik-crd
      objectset.rio.cattle.io/owner-namespace: kube-system
    creationTimestamp: "2024-01-08T17:06:00Z"
    labels:
      objectset.rio.cattle.io/hash: 48ff3d5c3117b372fcdca509795f9f2702af0592
    name: helm-kube-system-traefik-crd
    resourceVersion: "348"
    uid: 31be0c7e-dd79-49c6-9a13-77f5f124746c
  roleRef:
    apiGroup: rbac.authorization.k8s.io
    kind: ClusterRole
    name: cluster-admin
  subjects:
  - kind: ServiceAccount
    name: helm-traefik-crd
    namespace: kube-system
- apiVersion: rbac.authorization.k8s.io/v1
  kind: ClusterRole
  metadata:
    annotations:
      rbac.authorization.kubernetes.io/autoupdate: "true"
    creationTimestamp: "2024-01-08T17:05:54Z"
    labels:
      kubernetes.io/bootstrapping: rbac-defaults
    name: cluster-admin
    resourceVersion: "72"
    uid: 7a564a7b-9ca4-49ce-8a42-78660cb44f4c
  rules:
  - apiGroups:
    - '*'
    resources:
    - '*'
    verbs:
    - '*'
  - nonResourceURLs:
    - '*'
    verbs:
    - '*'
...
</pre></div></li></ul></div></div></div><div class='accordion-item'><div class='accordion-header' id='control_15_header'><button class='accordion-button collapsed' type='button' data-bs-toggle='collapse' data-bs-target='#control_15' aria-expanded='false' aria-controls='control_15'><div class='row'><div class='col'><h2 class='fs-4'>C-0044: Container hostPort</h2><p class='mb-0'> Configuring hostPort requires a particular port number. If two objects specify the same HostPort, they could not be deployed to the same node. It may prevent the second object from starting, even if Kubernetes will try reschedule it on another node, provided there are available nodes with sufficient amount of resources. Also, if the number of replicas of such workload is higher than the number of nodes, the deployment will consistently fail.</p></div></div></button></div><div id='control_15' class='accordion-collapse collapse' aria-labelledby='control_15_header' data-bs-parent='#report'><div class='accordion-body'><p>Workloads (like pod, deployment, etc) that contain a container with hostport. The problem that arises is that if the scale of your workload is larger than the number of nodes in your Kubernetes cluster, the deployment fails. And any two workloads that specify the same HostPort cannot be deployed to the same node. In addition, if the host where your pods are running becomes unavailable, Kubernetes reschedules the pods to different nodes. Thus, if the IP address for your workload changes, external clients of your application will lose access to the pod. The same thing happens when you restart your pods — Kubernetes reschedules them to a different node if available. </p><h5>Detection</h5><p>Check for each workload (with container) if it exists inside the container hostPort.  </p><h5>Remediation</h5><p>Avoid usage of hostPort unless it is absolutely necessary, in which case define appropriate exception. Use NodePort / ClusterIP instead.</p><h5>Checked paths and expected values</h5><ul><li>spec.template.spec.containers[*].ports[*].hostPort</li></ul><h5>Example</h5><pre>apiVersion: v1
kind: Pod
metadata:
  name: firstpod
spec:
  containers:
  - name: container
    image: nginx
    ports:
    - containerPort: 80
      hostIP: 10.0.0.1
      hostPort: 8080 #we look for this attribute</pre><h5>Affected resources</h5><ul><li class='expandable detail-hide'>kube-system DaemonSet svclb-traefik-bf26f129<div class='details'><pre>---
apiVersion: apps/v1
kind: DaemonSet
metadata:
  annotations:
    deprecated.daemonset.template.generation: "1"
    objectset.rio.cattle.io/applied: H4sIAAAAAAAA/8RVwW7jNhD9lWLOsizb2tQR0EOQBEXQrmPY3l4WRjCiRjFriiTIkTZGoH8vKDtZpWsnQYFm4YNBzptH8r3RzCOglX+R89JoyACt9cNmBBFspS4ggyukyuglMURQEWOBjJA9AmptGFka7cPS5H+TYE8cO2ligcyKYmmGMnBAdDJuvmlyg/tmCxkMm1H0yx9SF78tyTVS0Jt5GiuCDNghlXL7Lri3KELOts5p4HeeqYI2AuGoe8xKVuQZKwuZrpWKQGFO6tUnbtBvIIPp5KwUuaBkPC4+FUif8snZ2Xla0oiwnEzPxfkEy18LARH4Rgij2RmlyMXbie+xaVOQJ0WCjYMMSlSe3kjxjfhBiHfgTyhxoPKNUPngQDjIy/FZORqfwz5+ItVbEkGp7/d/hApZbP58FhGtPU3ethEwVVYhU5fbq7d3GPQq98dJ2BMCazaVqTUfCvpCiLBamS1pyDpvIwiHoNTkPGRfH4F00/0f7rNcXN7NbxcriKBBVYetaQJt9AKwuJj9fr3sQZK4+w1fIK+ul6u7+eJ2ddtDri7nP2JeO69D3Mz7p42SOJ3Eo/EoHo8SaNcRyArvQ8ShFhtyw62S1pIbqDxrkjiNUzhg5rVSc6Ok2EEGN+XM8NyRJ83wXInBTWEH0wQisMbxXqZn1ebGMWTTJIKN8fx9dSzbGTbCqKdnryNw5E3tBIUCCsaRqJ3k3aXRTA/cFR5azKWSLGlfZUUB2VeYXa/uLq4+38xg3bZBnrd9S9PJxxr3rwN/lnPhGq9Yl6aTvnfd8ijB/+be+miq33nByvdN1cSxtE0aS3tXGvcNXdEXE9p1d4v+tz7rtVOIgI0i9zQ2w9deliQYMpiZpdhQUavQ7bcURA2jYOCMojj0F6eJyYfmU6FncmHa2cDVzYnrB+nZd27/F8pDoxtYhZpOMu85Lp1kKVBdFIXR/lar3fGEdeiEtS2QackOme53QdbQT6W+/9IF9hPi4YvGBqXCXBFkozAFdjaotniB7TorI9edk6J2jjTP6ion9/TQArIkgoK8dFQcC+lu77P0/sj2grDYQZa07T8BAAD//yoC/PIWCQAA
    objectset.rio.cattle.io/id: ""
    objectset.rio.cattle.io/owner-gvk: /v1, Kind=Service
    objectset.rio.cattle.io/owner-name: traefik
    objectset.rio.cattle.io/owner-namespace: kube-system
  creationTimestamp: "2024-01-08T17:06:48Z"
  generation: 1
  labels:
    objectset.rio.cattle.io/hash: 836fcbce022d5dae5b36694fe1eaf389c93af7dc
    svccontroller.k3s.cattle.io/nodeselector: "false"
    svccontroller.k3s.cattle.io/svcname: traefik
    svccontroller.k3s.cattle.io/svcnamespace: kube-system
  name: svclb-traefik-bf26f129
  namespace: kube-system
  resourceVersion: "615"
  uid: acc5b475-2181-4d70-b320-8de6f12fd45f
spec:
  revisionHistoryLimit: 10
  selector:
    matchLabels:
      app: svclb-traefik-bf26f129
  template:
    metadata:
      creationTimestamp: ~
      labels:
        app: svclb-traefik-bf26f129
        svccontroller.k3s.cattle.io/svcname: traefik
        svccontroller.k3s.cattle.io/svcnamespace: kube-system
    spec:
      automountServiceAccountToken: false
      containers:
      - name: lb-tcp-80
        image: rancher/klipper-lb:v0.4.4
        ports:
        - name: lb-tcp-80
          hostPort: 80
          containerPort: 80
          protocol: TCP
        env:
        - name: SRC_PORT
          value: XXXXXX
        - name: SRC_RANGES
          value: XXXXXX
        - name: DEST_PROTO
          value: XXXXXX
        - name: DEST_PORT
          value: XXXXXX
        - name: DEST_IPS
          value: XXXXXX
        resources: []
        terminationMessagePath: /dev/termination-log
        terminationMessagePolicy: File
        imagePullPolicy: IfNotPresent
        securityContext:
          capabilities:
            add:
            - NET_ADMIN
      - name: lb-tcp-443
        image: rancher/klipper-lb:v0.4.4
        ports:
        - name: lb-tcp-443
          hostPort: 443
          containerPort: 443
          protocol: TCP
        env:
        - name: SRC_PORT
          value: XXXXXX
        - name: SRC_RANGES
          value: XXXXXX
        - name: DEST_PROTO
          value: XXXXXX
        - name: DEST_PORT
          value: XXXXXX
        - name: DEST_IPS
          value: XXXXXX
        resources: []
        terminationMessagePath: /dev/termination-log
        terminationMessagePolicy: File
        imagePullPolicy: IfNotPresent
        securityContext:
          capabilities:
            add:
            - NET_ADMIN
      dnsPolicy: ClusterFirst
      restartPolicy: Always
      schedulerName: default-scheduler
      securityContext:
        sysctls:
        - name: net.ipv4.ip_forward
          value: "1"
      serviceAccount: svclb
      serviceAccountName: svclb
      terminationGracePeriodSeconds: 30
      tolerations:
      - effect: NoSchedule
        key: node-role.kubernetes.io/master
        operator: Exists
      - effect: NoSchedule
        key: node-role.kubernetes.io/control-plane
        operator: Exists
      - key: CriticalAddonsOnly
        operator: Exists
  updateStrategy:
    rollingUpdate:
      maxSurge: 0
      maxUnavailable: 1
    type: RollingUpdate
...
</pre></div></li></ul></div></div></div><div class='accordion-item'><div class='accordion-header' id='control_16_header'><button class='accordion-button collapsed' type='button' data-bs-toggle='collapse' data-bs-target='#control_16' aria-expanded='false' aria-controls='control_16'><div class='row'><div class='col'><h2 class='fs-4'>C-0046: Insecure capabilities</h2><p class='mb-0'> Giving insecure or excessive capabilities to a container can increase the impact of the container compromise. This control identifies all the pods with dangerous capabilities (see documentation pages for details).</p></div></div></button></div><div id='control_16' class='accordion-collapse collapse' aria-labelledby='control_16_header' data-bs-parent='#report'><div class='accordion-body'><p>Giving  insecure and unnecessary capabilities for a container can increase the impact of a container compromise.</p><h5>Detection</h5><p>Check capabilities given against a configurable blacklist of insecure capabilities (https://man7.org/linux/man-pages/man7/capabilities.7.html). </p><h5>Remediation</h5><p>Remove all insecure capabilities which are not necessary for the container.</p><h5>Checked paths and expected values</h5><ul><li>spec.template.spec.containers[*].securityContext.capabilities.add[*]</li></ul><h5>Example</h5><pre>apiVersion: v1
kind: Pod
metadata:
  name: security-context-demo-4
spec:
  containers:
  - name: sec-ctx-4
    image: gcr.io/google-samples/node-hello:1.0
    securityContext:
      capabilities:
        add: ["NET_ADMIN", "SYS_TIME"] # we look at these capabilities against the configured list in the control settings (settings-> control -> c46)</pre><h5>Affected resources</h5><ul><li class='expandable detail-hide'>kube-system DaemonSet svclb-traefik-bf26f129<div class='details'><pre>---
apiVersion: apps/v1
kind: DaemonSet
metadata:
  annotations:
    deprecated.daemonset.template.generation: "1"
    objectset.rio.cattle.io/applied: H4sIAAAAAAAA/8RVwW7jNhD9lWLOsizb2tQR0EOQBEXQrmPY3l4WRjCiRjFriiTIkTZGoH8vKDtZpWsnQYFm4YNBzptH8r3RzCOglX+R89JoyACt9cNmBBFspS4ggyukyuglMURQEWOBjJA9AmptGFka7cPS5H+TYE8cO2ligcyKYmmGMnBAdDJuvmlyg/tmCxkMm1H0yx9SF78tyTVS0Jt5GiuCDNghlXL7Lri3KELOts5p4HeeqYI2AuGoe8xKVuQZKwuZrpWKQGFO6tUnbtBvIIPp5KwUuaBkPC4+FUif8snZ2Xla0oiwnEzPxfkEy18LARH4Rgij2RmlyMXbie+xaVOQJ0WCjYMMSlSe3kjxjfhBiHfgTyhxoPKNUPngQDjIy/FZORqfwz5+ItVbEkGp7/d/hApZbP58FhGtPU3ethEwVVYhU5fbq7d3GPQq98dJ2BMCazaVqTUfCvpCiLBamS1pyDpvIwiHoNTkPGRfH4F00/0f7rNcXN7NbxcriKBBVYetaQJt9AKwuJj9fr3sQZK4+w1fIK+ul6u7+eJ2ddtDri7nP2JeO69D3Mz7p42SOJ3Eo/EoHo8SaNcRyArvQ8ShFhtyw62S1pIbqDxrkjiNUzhg5rVSc6Ok2EEGN+XM8NyRJ83wXInBTWEH0wQisMbxXqZn1ebGMWTTJIKN8fx9dSzbGTbCqKdnryNw5E3tBIUCCsaRqJ3k3aXRTA/cFR5azKWSLGlfZUUB2VeYXa/uLq4+38xg3bZBnrd9S9PJxxr3rwN/lnPhGq9Yl6aTvnfd8ijB/+be+miq33nByvdN1cSxtE0aS3tXGvcNXdEXE9p1d4v+tz7rtVOIgI0i9zQ2w9deliQYMpiZpdhQUavQ7bcURA2jYOCMojj0F6eJyYfmU6FncmHa2cDVzYnrB+nZd27/F8pDoxtYhZpOMu85Lp1kKVBdFIXR/lar3fGEdeiEtS2QackOme53QdbQT6W+/9IF9hPi4YvGBqXCXBFkozAFdjaotniB7TorI9edk6J2jjTP6ion9/TQArIkgoK8dFQcC+lu77P0/sj2grDYQZa07T8BAAD//yoC/PIWCQAA
    objectset.rio.cattle.io/id: ""
    objectset.rio.cattle.io/owner-gvk: /v1, Kind=Service
    objectset.rio.cattle.io/owner-name: traefik
    objectset.rio.cattle.io/owner-namespace: kube-system
  creationTimestamp: "2024-01-08T17:06:48Z"
  generation: 1
  labels:
    objectset.rio.cattle.io/hash: 836fcbce022d5dae5b36694fe1eaf389c93af7dc
    svccontroller.k3s.cattle.io/nodeselector: "false"
    svccontroller.k3s.cattle.io/svcname: traefik
    svccontroller.k3s.cattle.io/svcnamespace: kube-system
  name: svclb-traefik-bf26f129
  namespace: kube-system
  resourceVersion: "615"
  uid: acc5b475-2181-4d70-b320-8de6f12fd45f
spec:
  revisionHistoryLimit: 10
  selector:
    matchLabels:
      app: svclb-traefik-bf26f129
  template:
    metadata:
      creationTimestamp: ~
      labels:
        app: svclb-traefik-bf26f129
        svccontroller.k3s.cattle.io/svcname: traefik
        svccontroller.k3s.cattle.io/svcnamespace: kube-system
    spec:
      automountServiceAccountToken: false
      containers:
      - name: lb-tcp-80
        image: rancher/klipper-lb:v0.4.4
        ports:
        - name: lb-tcp-80
          hostPort: 80
          containerPort: 80
          protocol: TCP
        env:
        - name: SRC_PORT
          value: XXXXXX
        - name: SRC_RANGES
          value: XXXXXX
        - name: DEST_PROTO
          value: XXXXXX
        - name: DEST_PORT
          value: XXXXXX
        - name: DEST_IPS
          value: XXXXXX
        resources: []
        terminationMessagePath: /dev/termination-log
        terminationMessagePolicy: File
        imagePullPolicy: IfNotPresent
        securityContext:
          capabilities:
            add:
            - NET_ADMIN
      - name: lb-tcp-443
        image: rancher/klipper-lb:v0.4.4
        ports:
        - name: lb-tcp-443
          hostPort: 443
          containerPort: 443
          protocol: TCP
        env:
        - name: SRC_PORT
          value: XXXXXX
        - name: SRC_RANGES
          value: XXXXXX
        - name: DEST_PROTO
          value: XXXXXX
        - name: DEST_PORT
          value: XXXXXX
        - name: DEST_IPS
          value: XXXXXX
        resources: []
        terminationMessagePath: /dev/termination-log
        terminationMessagePolicy: File
        imagePullPolicy: IfNotPresent
        securityContext:
          capabilities:
            add:
            - NET_ADMIN
      dnsPolicy: ClusterFirst
      restartPolicy: Always
      schedulerName: default-scheduler
      securityContext:
        sysctls:
        - name: net.ipv4.ip_forward
          value: "1"
      serviceAccount: svclb
      serviceAccountName: svclb
      terminationGracePeriodSeconds: 30
      tolerations:
      - effect: NoSchedule
        key: node-role.kubernetes.io/master
        operator: Exists
      - effect: NoSchedule
        key: node-role.kubernetes.io/control-plane
        operator: Exists
      - key: CriticalAddonsOnly
        operator: Exists
  updateStrategy:
    rollingUpdate:
      maxSurge: 0
      maxUnavailable: 1
    type: RollingUpdate
...
</pre></div></li></ul></div></div></div><div class='accordion-item'><div class='accordion-header' id='control_17_header'><button class='accordion-button collapsed' type='button' data-bs-toggle='collapse' data-bs-target='#control_17' aria-expanded='false' aria-controls='control_17'><div class='row'><div class='col'><h2 class='fs-4'>C-0050: Resources CPU limit and request</h2><p class='mb-0'> This control identifies all Pods for which the CPU limit is not set.</p></div></div></button></div><div id='control_17' class='accordion-collapse collapse' aria-labelledby='control_17_header' data-bs-parent='#report'><div class='accordion-body'><h5>Remediation</h5><p>Set the CPU limit or use exception mechanism to avoid unnecessary notifications.</p><h5>Checked paths and expected values</h5><ul><li>spec.template.spec.containers[*].resources.limits.cpu = YOUR_VALUE</li><li>spec.template.spec.containers[*].resources.requests.cpu = YOUR_VALUE</li></ul><h5>Affected resources</h5><ul><li class='expandable detail-hide'>kube-system DaemonSet svclb-traefik-bf26f129<div class='details'><pre>---
apiVersion: apps/v1
kind: DaemonSet
metadata:
  annotations:
    deprecated.daemonset.template.generation: "1"
    objectset.rio.cattle.io/applied: H4sIAAAAAAAA/8RVwW7jNhD9lWLOsizb2tQR0EOQBEXQrmPY3l4WRjCiRjFriiTIkTZGoH8vKDtZpWsnQYFm4YNBzptH8r3RzCOglX+R89JoyACt9cNmBBFspS4ggyukyuglMURQEWOBjJA9AmptGFka7cPS5H+TYE8cO2ligcyKYmmGMnBAdDJuvmlyg/tmCxkMm1H0yx9SF78tyTVS0Jt5GiuCDNghlXL7Lri3KELOts5p4HeeqYI2AuGoe8xKVuQZKwuZrpWKQGFO6tUnbtBvIIPp5KwUuaBkPC4+FUif8snZ2Xla0oiwnEzPxfkEy18LARH4Rgij2RmlyMXbie+xaVOQJ0WCjYMMSlSe3kjxjfhBiHfgTyhxoPKNUPngQDjIy/FZORqfwz5+ItVbEkGp7/d/hApZbP58FhGtPU3ethEwVVYhU5fbq7d3GPQq98dJ2BMCazaVqTUfCvpCiLBamS1pyDpvIwiHoNTkPGRfH4F00/0f7rNcXN7NbxcriKBBVYetaQJt9AKwuJj9fr3sQZK4+w1fIK+ul6u7+eJ2ddtDri7nP2JeO69D3Mz7p42SOJ3Eo/EoHo8SaNcRyArvQ8ShFhtyw62S1pIbqDxrkjiNUzhg5rVSc6Ok2EEGN+XM8NyRJ83wXInBTWEH0wQisMbxXqZn1ebGMWTTJIKN8fx9dSzbGTbCqKdnryNw5E3tBIUCCsaRqJ3k3aXRTA/cFR5azKWSLGlfZUUB2VeYXa/uLq4+38xg3bZBnrd9S9PJxxr3rwN/lnPhGq9Yl6aTvnfd8ijB/+be+miq33nByvdN1cSxtE0aS3tXGvcNXdEXE9p1d4v+tz7rtVOIgI0i9zQ2w9deliQYMpiZpdhQUavQ7bcURA2jYOCMojj0F6eJyYfmU6FncmHa2cDVzYnrB+nZd27/F8pDoxtYhZpOMu85Lp1kKVBdFIXR/lar3fGEdeiEtS2QackOme53QdbQT6W+/9IF9hPi4YvGBqXCXBFkozAFdjaotniB7TorI9edk6J2jjTP6ion9/TQArIkgoK8dFQcC+lu77P0/sj2grDYQZa07T8BAAD//yoC/PIWCQAA
    objectset.rio.cattle.io/id: ""
    objectset.rio.cattle.io/owner-gvk: /v1, Kind=Service
    objectset.rio.cattle.io/owner-name: traefik
    objectset.rio.cattle.io/owner-namespace: kube-system
  creationTimestamp: "2024-01-08T17:06:48Z"
  generation: 1
  labels:
    objectset.rio.cattle.io/hash: 836fcbce022d5dae5b36694fe1eaf389c93af7dc
    svccontroller.k3s.cattle.io/nodeselector: "false"
    svccontroller.k3s.cattle.io/svcname: traefik
    svccontroller.k3s.cattle.io/svcnamespace: kube-system
  name: svclb-traefik-bf26f129
  namespace: kube-system
  resourceVersion: "615"
  uid: acc5b475-2181-4d70-b320-8de6f12fd45f
spec:
  revisionHistoryLimit: 10
  selector:
    matchLabels:
      app: svclb-traefik-bf26f129
  template:
    metadata:
      creationTimestamp: ~
      labels:
        app: svclb-traefik-bf26f129
        svccontroller.k3s.cattle.io/svcname: traefik
        svccontroller.k3s.cattle.io/svcnamespace: kube-system
    spec:
      automountServiceAccountToken: false
      containers:
      - name: lb-tcp-80
        image: rancher/klipper-lb:v0.4.4
        ports:
        - name: lb-tcp-80
          hostPort: 80
          containerPort: 80
          protocol: TCP
        env:
        - name: SRC_PORT
          value: XXXXXX
        - name: SRC_RANGES
          value: XXXXXX
        - name: DEST_PROTO
          value: XXXXXX
        - name: DEST_PORT
          value: XXXXXX
        - name: DEST_IPS
          value: XXXXXX
        resources: []
        terminationMessagePath: /dev/termination-log
        terminationMessagePolicy: File
        imagePullPolicy: IfNotPresent
        securityContext:
          capabilities:
            add:
            - NET_ADMIN
      - name: lb-tcp-443
        image: rancher/klipper-lb:v0.4.4
        ports:
        - name: lb-tcp-443
          hostPort: 443
          containerPort: 443
          protocol: TCP
        env:
        - name: SRC_PORT
          value: XXXXXX
        - name: SRC_RANGES
          value: XXXXXX
        - name: DEST_PROTO
          value: XXXXXX
        - name: DEST_PORT
          value: XXXXXX
        - name: DEST_IPS
          value: XXXXXX
        resources: []
        terminationMessagePath: /dev/termination-log
        terminationMessagePolicy: File
        imagePullPolicy: IfNotPresent
        securityContext:
          capabilities:
            add:
            - NET_ADMIN
      dnsPolicy: ClusterFirst
      restartPolicy: Always
      schedulerName: default-scheduler
      securityContext:
        sysctls:
        - name: net.ipv4.ip_forward
          value: "1"
      serviceAccount: svclb
      serviceAccountName: svclb
      terminationGracePeriodSeconds: 30
      tolerations:
      - effect: NoSchedule
        key: node-role.kubernetes.io/master
        operator: Exists
      - effect: NoSchedule
        key: node-role.kubernetes.io/control-plane
        operator: Exists
      - key: CriticalAddonsOnly
        operator: Exists
  updateStrategy:
    rollingUpdate:
      maxSurge: 0
      maxUnavailable: 1
    type: RollingUpdate
...
</pre></div></li><li class='expandable detail-hide'>kube-system Deployment local-path-provisioner<div class='details'><pre>---
apiVersion: apps/v1
kind: Deployment
metadata:
  annotations:
    deployment.kubernetes.io/revision: "1"
    objectset.rio.cattle.io/applied: H4sIAAAAAAAA/6xU3W7yRhB9lWqubQMfBCFLvUBJqlZNCEqU3kSoGtZj2LDeXe0Obizkd68Gm/yoIWmlXnl/Zs6emXPGB0Cv/6AQtbOQA3ofB/UIEthpW0AOV+SNayqyDAlUxFggI+QHQGsdI2tno2zd+pkUR+IsaJcpZDaUaTfQAgLJ2Xv3l6WQbuod5LAbx3c39Sj56Xdti5/nReHstxAWK4IcjFNo0sgu4Ib+VVL0qCRzt19TGpvIVEGbgME1mS9L22LcQg6j2bgcX6jpRVmu1Xg4nUyH43IyLkcXs2ExU9MZ/ihwXUwE9ANJj7xNfXC1luZTgO7+DJ/oSQmbQF38r1qKbG50pRnyYQKRDCl2QYIqZLW9ea0AvT//aivgHJBp0xwfcMZou3n0BTJ1YC+PFmvUBteGIB+1CXDjheP9h1g5p8qbU947t5j/wKUvVDnLqC2FCPmTbKsKxZJP59sXGYP4NE2Vs6XeQAIDYjXodv0ne47OwioBsvURuRdleXf152J+e/2wnF9eQwI1mj39ElwlZEpNprin8nW9RBbxTzVmb8q1bbtKQFfivxwCWrWlMPicc14Ps2H2YwJ9wnJvzNIZrRrI4bdy4XgZKHbD9513amf2Fd26veWuY5Use57v2/CG1R2kXSa0KyHug3ZBc3NpMMZFF9e5MLWuoFQFzVqhkXZTqLWiuVLy0uIrfmkfm2IXDAmwMxROP5CnA+xIir7s4Y9DH++saWSIvUSKteH6RUeO0CYHoLIkxZDDwj2oLRV7IwPfwRypBmcokzEKlpiizKyYKjiTeoOW/lfkCiMfdfgEcnVS52RlafstenHTP2Xtvduel6lt278DAAD//8i6p1C4BQAA
    objectset.rio.cattle.io/id: ""
    objectset.rio.cattle.io/owner-gvk: k3s.cattle.io/v1, Kind=Addon
    objectset.rio.cattle.io/owner-name: local-storage
    objectset.rio.cattle.io/owner-namespace: kube-system
  creationTimestamp: "2024-01-08T17:05:58Z"
  generation: 1
  labels:
    objectset.rio.cattle.io/hash: 183f35c65ffbc3064603f43f1580d8c68a2dabd4
  name: local-path-provisioner
  namespace: kube-system
  resourceVersion: "475"
  uid: 718c0dfe-3f1a-4b36-807a-d731f31753f6
spec:
  progressDeadlineSeconds: 600
  replicas: 1
  revisionHistoryLimit: 0
  selector:
    matchLabels:
      app: local-path-provisioner
  strategy:
    rollingUpdate:
      maxSurge: 25%
      maxUnavailable: 1
    type: RollingUpdate
  template:
    metadata:
      creationTimestamp: ~
      labels:
        app: local-path-provisioner
    spec:
      containers:
      - name: local-path-provisioner
        image: rancher/local-path-provisioner:v0.0.24
        command:
        - local-path-provisioner
        - start
        - --config
        - /etc/config/config.json
        env:
        - name: POD_NAMESPACE
          value: XXXXXX
          valueFrom:
            fieldRef:
              apiVersion: v1
              fieldPath: metadata.namespace
        resources: []
        volumeMounts:
        - name: config-volume
          mountPath: /etc/config/
        terminationMessagePath: /dev/termination-log
        terminationMessagePolicy: File
        imagePullPolicy: IfNotPresent
      dnsPolicy: ClusterFirst
      priorityClassName: system-node-critical
      restartPolicy: Always
      schedulerName: default-scheduler
      securityContext: []
      serviceAccount: local-path-provisioner-service-account
      serviceAccountName: local-path-provisioner-service-account
      terminationGracePeriodSeconds: 30
      tolerations:
      - key: CriticalAddonsOnly
        operator: Exists
      - effect: NoSchedule
        key: node-role.kubernetes.io/control-plane
        operator: Exists
      - effect: NoSchedule
        key: node-role.kubernetes.io/master
        operator: Exists
      volumes:
      - configMap:
          defaultMode: 420
          name: local-path-config
        name: config-volume
...
</pre></div></li><li class='expandable detail-hide'>kube-system Deployment traefik<div class='details'><pre>---
apiVersion: apps/v1
kind: Deployment
metadata:
  annotations:
    deployment.kubernetes.io/revision: "1"
    meta.helm.sh/release-name: traefik
    meta.helm.sh/release-namespace: kube-system
  creationTimestamp: "2024-01-08T17:06:48Z"
  generation: 1
  labels:
    app.kubernetes.io/instance: traefik-kube-system
    app.kubernetes.io/managed-by: Helm
    app.kubernetes.io/name: traefik
    helm.sh/chart: traefik-21.2.1_up21.2.0
  name: traefik
  namespace: kube-system
  resourceVersion: "629"
  uid: ec30998f-e81b-47de-aeae-3970de0b73a4
spec:
  progressDeadlineSeconds: 600
  replicas: 1
  revisionHistoryLimit: 10
  selector:
    matchLabels:
      app.kubernetes.io/instance: traefik-kube-system
      app.kubernetes.io/name: traefik
  strategy:
    rollingUpdate:
      maxSurge: 1
      maxUnavailable: 0
    type: RollingUpdate
  template:
    metadata:
      annotations:
        prometheus.io/path: /metrics
        prometheus.io/port: "9100"
        prometheus.io/scrape: "true"
      creationTimestamp: ~
      labels:
        app.kubernetes.io/instance: traefik-kube-system
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: traefik
        helm.sh/chart: traefik-21.2.1_up21.2.0
    spec:
      containers:
      - name: traefik
        image: rancher/mirrored-library-traefik:2.9.10
        args:
        - --global.checknewversion
        - --global.sendanonymoususage
        - --entrypoints.metrics.address=:9100/tcp
        - --entrypoints.traefik.address=:9000/tcp
        - --entrypoints.web.address=:8000/tcp
        - --entrypoints.websecure.address=:8443/tcp
        - --api.dashboard=true
        - --ping=true
        - --metrics.prometheus=true
        - --metrics.prometheus.entrypoint=metrics
        - --providers.kubernetescrd
        - --providers.kubernetesingress
        - --providers.kubernetesingress.ingressendpoint.publishedservice=kube-system/traefik
        - --entrypoints.websecure.http.tls=true
        ports:
        - name: metrics
          containerPort: 9100
          protocol: TCP
        - name: traefik
          containerPort: 9000
          protocol: TCP
        - name: web
          containerPort: 8000
          protocol: TCP
        - name: websecure
          containerPort: 8443
          protocol: TCP
        resources: []
        volumeMounts:
        - name: data
          mountPath: /data
        - name: tmp
          mountPath: /tmp
        livenessProbe:
          httpGet:
            path: /ping
            port: 9000
            scheme: HTTP
          initialDelaySeconds: 2
          timeoutSeconds: 2
          periodSeconds: 10
          successThreshold: 1
          failureThreshold: 3
        readinessProbe:
          httpGet:
            path: /ping
            port: 9000
            scheme: HTTP
          initialDelaySeconds: 2
          timeoutSeconds: 2
          periodSeconds: 10
          successThreshold: 1
          failureThreshold: 1
        terminationMessagePath: /dev/termination-log
        terminationMessagePolicy: File
        imagePullPolicy: IfNotPresent
        securityContext:
          capabilities:
            drop:
            - ALL
          runAsUser: 65532
          runAsGroup: 65532
          runAsNonRoot: true
          readOnlyRootFilesystem: true
      dnsPolicy: ClusterFirst
      priorityClassName: system-cluster-critical
      restartPolicy: Always
      schedulerName: default-scheduler
      securityContext:
        fsGroup: 65532
      serviceAccount: traefik
      serviceAccountName: traefik
      terminationGracePeriodSeconds: 60
      tolerations:
      - key: CriticalAddonsOnly
        operator: Exists
      - effect: NoSchedule
        key: node-role.kubernetes.io/control-plane
        operator: Exists
      - effect: NoSchedule
        key: node-role.kubernetes.io/master
        operator: Exists
      volumes:
      - emptyDir: []
        name: data
      - emptyDir: []
        name: tmp
...
</pre></div></li><li class='expandable detail-hide'>kube-system Job helm-install-traefik<div class='details'><pre>---
apiVersion: batch/v1
kind: Job
metadata:
  annotations:
    batch.kubernetes.io/job-tracking: ""
    objectset.rio.cattle.io/applied: H4sIAAAAAAAA/6xVUY/qNhP9K59Guk9fEgLZbCDSPgQIhd5diAK7alWtkDETcHHsyHZoVyv+e+WQezfb3m5vpb7ZzszxOeM5k1cgFXtCpZkUEMOOGHrsnfvgwImJPcTwo9yBAyUasieGQPwKRAhpiGFSaLuVu1+RGo3GU0x6lBjD0WOyx2z2EXnpUimMkpyjcumRKOMqPDBtVIMBzt8iyN8EKvdwPrVAnU/nvvO/z0zs7+bIy4kF/UccQUqEGIwiWLDTd4XrilCbc6p36OoXbbCEiwNUYUN9w0rUhpQVxKLm3AFOdsiboli6jVbt/Yl5c/pdPI5EHyEG6hejCElEBiEGe6RRfxRGNCLB4KZPgmERYFgQDAvLrNXYVJ0JbQjn7ttFH0jSFVLLe0foSRbFPSuZgbjv+74DBsuKE4P2+wd98IFkKQp2mF/lrOfJILy9C6NJMByPZuPx7ThIg4kfzobRKEgnfhCG09EoDGfRjT9OwptplM4G09HtdBTNhtPb//wBLh35tlMJE6g0xL+8AlEHu4C2lOCA62o0rjaKiQM4cOByR7h3reMUC1Jzk1+b++UOnh1AcW6Q2odZJg8pOHAmvO724sX5GvGU5uvFatk9ytNs1d3P0/uH7TRfPKV5B0sjVWi6cZN5km+29sp1lky6975//PcJnbCjMZWOe71Pr58fx2m+TDfpeptki8unnrYPT6+11L1WhzvoewOv//+6ahb+X0h/Q9wmyX9I/xXL5HEz32bJer2d5Ok0XW4Wyf26k1YQrrGbsFxts3z108+dGE+fqeNRXmuDyuOSEu70fe9m4Pme3+vfNpug3XSxZsni/jFPt9nqfjHpIir80iSXZwdYSQ7NKRH0iKp34qyqULm2FeOz7w29gburGd8P/EHgD/shtDlZzXkmOaMvEMOiWEqTKdQoDLwzNzigUMtaUbTdfnHgLHld4oOshbn2bmmXGTHWc60D3zAa1roR9j6unaRtmLWDvfvybEUJucc1cqRGKmsW+z5KoEHdTE0NMXAm6t+tQ5X1pTJfpazEjDBeKwQHNKozo5hQaq9edkbW26i6ytFd77ScnS+dHr+2qxbh+mu5RrkdczeuLtjhgVQ2R3SjW4Fv4d+S3gwIQ0zdlPryRwAAAP//DrZg0DIHAAA
    objectset.rio.cattle.io/id: helm-controller-chart-registration
    objectset.rio.cattle.io/owner-gvk: helm.cattle.io/v1, Kind=HelmChart
    objectset.rio.cattle.io/owner-name: traefik
    objectset.rio.cattle.io/owner-namespace: kube-system
  creationTimestamp: "2024-01-08T17:06:00Z"
  generation: 1
  labels:
    helmcharts.helm.cattle.io/chart: traefik
    objectset.rio.cattle.io/hash: c0f97ea7a25e3dec71957c7a3241a38f3e5fae5f
  name: helm-install-traefik
  namespace: kube-system
  resourceVersion: "598"
  uid: 2a591629-9af8-4949-b2dd-39bd02b148a4
spec:
  backoffLimit: 1000
  completionMode: NonIndexed
  completions: 1
  parallelism: 1
  selector:
    matchLabels:
      batch.kubernetes.io/controller-uid: 2a591629-9af8-4949-b2dd-39bd02b148a4
  suspend: false
  template:
    metadata:
      annotations:
        helmcharts.helm.cattle.io/configHash: SHA256=57C38B9FBB6B3E3C05F8793EC0355D9955F740BA54D7EF2D96D97F8D678F2B0E
      creationTimestamp: ~
      labels:
        batch.kubernetes.io/controller-uid: 2a591629-9af8-4949-b2dd-39bd02b148a4
        batch.kubernetes.io/job-name: helm-install-traefik
        controller-uid: 2a591629-9af8-4949-b2dd-39bd02b148a4
        helmcharts.helm.cattle.io/chart: traefik
        job-name: helm-install-traefik
    spec:
      containers:
      - name: helm
        image: rancher/klipper-helm:v0.8.2-build20230815
        args:
        - install
        - --set-string
        - global.systemDefaultRegistry=
        env:
        - name: NAME
          value: XXXXXX
        - name: VERSION
          value: XXXXXX
        - name: REPO
          value: XXXXXX
        - name: HELM_DRIVER
          value: XXXXXX
        - name: CHART_NAMESPACE
          value: XXXXXX
        - name: CHART
          value: XXXXXX
        - name: HELM_VERSION
          value: XXXXXX
        - name: TARGET_NAMESPACE
          value: XXXXXX
        - name: AUTH_PASS_CREDENTIALS
          value: XXXXXX
        - name: NO_PROXY
          value: XXXXXX
        - name: FAILURE_POLICY
          value: XXXXXX
        resources: []
        volumeMounts:
        - name: values
          mountPath: /config
        - name: content
          mountPath: /chart
        terminationMessagePath: /dev/termination-log
        terminationMessagePolicy: File
        imagePullPolicy: IfNotPresent
      dnsPolicy: ClusterFirst
      nodeSelector:
        kubernetes.io/os: linux
      restartPolicy: OnFailure
      schedulerName: default-scheduler
      securityContext: []
      serviceAccount: helm-traefik
      serviceAccountName: helm-traefik
      terminationGracePeriodSeconds: 30
      volumes:
      - name: values
        secret:
          defaultMode: 420
          secretName: chart-values-traefik
      - configMap:
          defaultMode: 420
          name: chart-content-traefik
        name: content
...
</pre></div></li><li class='expandable detail-hide'>kube-system Job helm-install-traefik-crd<div class='details'><pre>---
apiVersion: batch/v1
kind: Job
metadata:
  annotations:
    batch.kubernetes.io/job-tracking: ""
    objectset.rio.cattle.io/applied: H4sIAAAAAAAA/7RVUY/iNhD+K9VI99QkJCEsm0j3ELhQ6O0CCuyqVbVCxkzAxbEj26E9If575ZC7hu11e324t9ie7/P3jWcmZyAVe0almRSQwJYYeuidAnDgyMQOEvhZbsGBEg3ZEUMgOQMRQhpimBTaLuX2d6RGo/EUkx4lxnD0mOwxiz4gL10qhVGSc1QuPRBlXIV7po1qOMD5Vwb5h0Dl7k/HlqhzdAqcHz4ysXs/RV6OLel/8ghSIiRgFMGCHV2qdt8E0RWhFnest+jqT9pgCRcHqMJG/pqVqA0pK0hEzbkDnGyRN4mxkhu/2nulvtn9Zi0Hog+QQHRfFP3dgPaDYLjtD8OC7igZ+PEwHhRxEQ79kBT+IA6tutZrk30mtCGcu7eXvWFNV0it/i2hR1kUD6xkBpLA930HDJYVJwbt+Rs18YZ1KQq2n14traZpOLh7n/VH/jiKwvh+Mg7GQRSnk9EkGt/H8d1kFIdROEyzKMiiuygexf1onEbxII6D0fC7PMSlkwJbuYQJVBqS385A1N5+QJtSeHEAxak5ajM+Tx8zcOBEeP262C7Ol6jnLF/NFvPuVp4tF931NHt43HzIZ89Z3uHTSBWabtx4mubrjb12tUzH3btvX/UW0Ak7GFPppNd7d/74NMryebbOVpt0Obu862n7ovSaJN3reHHDwAu94Me6CoN/iP6KuXWa/5T9L5Xp03q6Waar1WacZx+y+XqWPqw6sIJwjV3AfLFZ5otffu3EePpEHY/yWhtUHpeUcCfwvSj0fM/vBXfNot8uulyTdPbwlGeb5eJhNu4yKvz88pcXB1hJ9s0uEfSAqnfkrKpQubbGkpPv3Xuhu60Z34V+2PfvgwG0mGXN+VJyRj9BArNiLs1SoUZh4KZzwQGFWtaKoi3jiwMnyesSH2UtzLUgS/u5JMY2U9taf3M0qnVj7DauHZdtmK1xe/flxZoScocr5EiNVLYD7PsogQZ1MxY1JMCZqP+0radswynzxcpCTAjjtUJwQKM6MYoppfbqeWce3c6hqyXd7aFWt/O52pNz+9WyXP8h1yj3Vec2LVuw/SOpLE50Ea3RW8jX0tBMAENM3aT98lcAAAD//411peIjBwAA
    objectset.rio.cattle.io/id: helm-controller-chart-registration
    objectset.rio.cattle.io/owner-gvk: helm.cattle.io/v1, Kind=HelmChart
    objectset.rio.cattle.io/owner-name: traefik-crd
    objectset.rio.cattle.io/owner-namespace: kube-system
  creationTimestamp: "2024-01-08T17:06:00Z"
  generation: 1
  labels:
    helmcharts.helm.cattle.io/chart: traefik-crd
    objectset.rio.cattle.io/hash: 48ff3d5c3117b372fcdca509795f9f2702af0592
  name: helm-install-traefik-crd
  namespace: kube-system
  resourceVersion: "588"
  uid: 655ceb1b-aaa8-4b24-92ab-fceb2ddd45bd
spec:
  backoffLimit: 1000
  completionMode: NonIndexed
  completions: 1
  parallelism: 1
  selector:
    matchLabels:
      batch.kubernetes.io/controller-uid: 655ceb1b-aaa8-4b24-92ab-fceb2ddd45bd
  suspend: false
  template:
    metadata:
      annotations:
        helmcharts.helm.cattle.io/configHash: SHA256=E3B0C44298FC1C149AFBF4C8996FB92427AE41E4649B934CA495991B7852B855
      creationTimestamp: ~
      labels:
        batch.kubernetes.io/controller-uid: 655ceb1b-aaa8-4b24-92ab-fceb2ddd45bd
        batch.kubernetes.io/job-name: helm-install-traefik-crd
        controller-uid: 655ceb1b-aaa8-4b24-92ab-fceb2ddd45bd
        helmcharts.helm.cattle.io/chart: traefik-crd
        job-name: helm-install-traefik-crd
    spec:
      containers:
      - name: helm
        image: rancher/klipper-helm:v0.8.2-build20230815
        args:
        - install
        env:
        - name: NAME
          value: XXXXXX
        - name: VERSION
          value: XXXXXX
        - name: REPO
          value: XXXXXX
        - name: HELM_DRIVER
          value: XXXXXX
        - name: CHART_NAMESPACE
          value: XXXXXX
        - name: CHART
          value: XXXXXX
        - name: HELM_VERSION
          value: XXXXXX
        - name: TARGET_NAMESPACE
          value: XXXXXX
        - name: AUTH_PASS_CREDENTIALS
          value: XXXXXX
        - name: NO_PROXY
          value: XXXXXX
        - name: FAILURE_POLICY
          value: XXXXXX
        resources: []
        volumeMounts:
        - name: values
          mountPath: /config
        - name: content
          mountPath: /chart
        terminationMessagePath: /dev/termination-log
        terminationMessagePolicy: File
        imagePullPolicy: IfNotPresent
      dnsPolicy: ClusterFirst
      nodeSelector:
        kubernetes.io/os: linux
      restartPolicy: OnFailure
      schedulerName: default-scheduler
      securityContext: []
      serviceAccount: helm-traefik-crd
      serviceAccountName: helm-traefik-crd
      terminationGracePeriodSeconds: 30
      volumes:
      - name: values
        secret:
          defaultMode: 420
          secretName: chart-values-traefik-crd
      - configMap:
          defaultMode: 420
          name: chart-content-traefik-crd
        name: content
...
</pre></div></li></ul></div></div></div><div class='accordion-item'><div class='accordion-header' id='control_18_header'><button class='accordion-button collapsed' type='button' data-bs-toggle='collapse' data-bs-target='#control_18' aria-expanded='false' aria-controls='control_18'><div class='row'><div class='col'><h2 class='fs-4'>C-0053: Access container service account</h2><p class='mb-0'> Attackers who obtain access to a pod can use its SA token to communicate with KubeAPI server. All pods with SA token mounted (if such token has a Role or a ClusterRole binding) are considerred potentially dangerous.</p></div></div></button></div><div id='control_18' class='accordion-collapse collapse' aria-labelledby='control_18_header' data-bs-parent='#report'><div class='accordion-body'><p>Service account (SA) represents an application identity in Kubernetes. By default, an SA is mounted to every created pod in the cluster. Using the SA, containers in the pod can send requests to the Kubernetes API server. Attackers who get access to a pod can access the SA token (located in /var/run/secrets/kubernetes.io/serviceaccount/token) and perform actions in the cluster, according to the SA permissions. If RBAC is not enabled, the SA has unlimited permissions in the cluster. If RBAC is enabled, its permissions are determined by the RoleBindings\\ClusterRoleBindings that are associated with it.</p><h5>Detection</h5><p>Control checks if RBAC is enabled. If it's not, the SA has unlimited permissions. If RBAC is enabled, it lists  all permissions for each SA.</p><h5>Remediation</h5><p>Verify that RBAC is enabled. Follow the least privilege principle and ensure that only necessary pods have SA token mounted into them.</p><h5>Affected resources</h5><ul><li class='expandable detail-hide'>kube-system ServiceAccount helm-traefik<div class='details'><pre>---
kind: ServiceAccount
name: helm-traefik
namespace: kube-system
relatedObjects:
- apiVersion: rbac.authorization.k8s.io/v1
  kind: ClusterRoleBinding
  metadata:
    annotations:
      objectset.rio.cattle.io/applied: H4sIAAAAAAAA/4yRze6TUBDFX8XMGlD+SGhJXGgXmrirxo1xMVyGMnI/yNwBo03f3UBbrYmtLu/H+c2Zc46AI38iiRw81CANmgwn7YPwD1QOPhs2MePwfM4hgYF9CzXs7BSVZB8svWHfsj9AAo4UW1SE+gjofdBVHpdjaL6S0UiaCYfMoKqlhckLrCfrUhO8SrCWJDU9iqZCB44qKwOSu4TwzZOkh3m4gG6e5jx59p59++odWbdboP/keHQENaggdTz81/c4olk0w9RQGr9HJQenBIzQav0jO4qKboTaT9YmYLEh+zCUHmMPNZgX3bYirPCppKIlU+XbsjIVFk8vcyw2XUFlh1R2y7SL7zXJGyPpdZFTAhIs7albyxn5rYRpfFT3X7uGX5PM+TLF1rFf8HE6bwP15+NV+YFkZkOvjQmTV/jT5u+M76b45fQzAAD//6tHuTCdAgAA
      objectset.rio.cattle.io/id: helm-controller-chart-registration
      objectset.rio.cattle.io/owner-gvk: helm.cattle.io/v1, Kind=HelmChart
      objectset.rio.cattle.io/owner-name: traefik
      objectset.rio.cattle.io/owner-namespace: kube-system
    creationTimestamp: "2024-01-08T17:06:00Z"
    labels:
      objectset.rio.cattle.io/hash: c0f97ea7a25e3dec71957c7a3241a38f3e5fae5f
    name: helm-kube-system-traefik
    resourceVersion: "349"
    uid: a815f9db-1d48-4564-a669-936f12c9a7ec
  roleRef:
    apiGroup: rbac.authorization.k8s.io
    kind: ClusterRole
    name: cluster-admin
  subjects:
  - kind: ServiceAccount
    name: helm-traefik
    namespace: kube-system
- apiVersion: rbac.authorization.k8s.io/v1
  kind: ClusterRole
  metadata:
    annotations:
      rbac.authorization.kubernetes.io/autoupdate: "true"
    creationTimestamp: "2024-01-08T17:05:54Z"
    labels:
      kubernetes.io/bootstrapping: rbac-defaults
    name: cluster-admin
    resourceVersion: "72"
    uid: 7a564a7b-9ca4-49ce-8a42-78660cb44f4c
  rules:
  - apiGroups:
    - '*'
    resources:
    - '*'
    verbs:
    - '*'
  - nonResourceURLs:
    - '*'
    verbs:
    - '*'
...
</pre></div></li><li class='expandable detail-hide'>kube-system ServiceAccount helm-traefik-crd<div class='details'><pre>---
kind: ServiceAccount
name: helm-traefik-crd
namespace: kube-system
relatedObjects:
- apiVersion: rbac.authorization.k8s.io/v1
  kind: ClusterRoleBinding
  metadata:
    annotations:
      objectset.rio.cattle.io/applied: H4sIAAAAAAAA/4yRzY7UQAyEXwX5nA7zw2g2kTjAHkDitiAuiIPT7Z6Y9E/kdoJgNO+Okl3QrMQuHLut+lyuOgOO/JmkcE7QgnRoa5y0z8I/UTmnergpNeeX8xYqGDg5aOE2TEVJ7nKgt5wcpxNUEEnRoSK0Z8CUsq7ysjxz942sFtJaONcWVQMtTF5gPYVobE4qOQQSY3sUNUInLiorA6onCfl7IjGneXgAXY3mbfXiAyf3+j2FeLtA/8lJGAlaUEHyPBgr7r8kZUS76IapI1N+FKUIlwqs0Gr/E0cqinGENk0hVBCwo/BsMD2WHlp4deP93h3sfrs9dvvjzltn8bBpjs3BN3533OzQbw7Nbtn24H1N88qIuT7mUoHkQHfk15JGfid5Gp+r/a+dw59t9v7ToIucFnyZ7i+C9sv5t/IjycyW3libp6Tw2OrjrJ9M8+vlVwAAAP//b1bdJakCAAA
      objectset.rio.cattle.io/id: helm-controller-chart-registration
      objectset.rio.cattle.io/owner-gvk: helm.cattle.io/v1, Kind=HelmChart
      objectset.rio.cattle.io/owner-name: traefik-crd
      objectset.rio.cattle.io/owner-namespace: kube-system
    creationTimestamp: "2024-01-08T17:06:00Z"
    labels:
      objectset.rio.cattle.io/hash: 48ff3d5c3117b372fcdca509795f9f2702af0592
    name: helm-kube-system-traefik-crd
    resourceVersion: "348"
    uid: 31be0c7e-dd79-49c6-9a13-77f5f124746c
  roleRef:
    apiGroup: rbac.authorization.k8s.io
    kind: ClusterRole
    name: cluster-admin
  subjects:
  - kind: ServiceAccount
    name: helm-traefik-crd
    namespace: kube-system
- apiVersion: rbac.authorization.k8s.io/v1
  kind: ClusterRole
  metadata:
    annotations:
      rbac.authorization.kubernetes.io/autoupdate: "true"
    creationTimestamp: "2024-01-08T17:05:54Z"
    labels:
      kubernetes.io/bootstrapping: rbac-defaults
    name: cluster-admin
    resourceVersion: "72"
    uid: 7a564a7b-9ca4-49ce-8a42-78660cb44f4c
  rules:
  - apiGroups:
    - '*'
    resources:
    - '*'
    verbs:
    - '*'
  - nonResourceURLs:
    - '*'
    verbs:
    - '*'
...
</pre></div></li><li class='expandable detail-hide'>kube-system ServiceAccount local-path-provisioner-service-account<div class='details'><pre>---
kind: ServiceAccount
name: local-path-provisioner-service-account
namespace: kube-system
relatedObjects:
- apiVersion: rbac.authorization.k8s.io/v1
  kind: ClusterRoleBinding
  metadata:
    annotations:
      objectset.rio.cattle.io/applied: H4sIAAAAAAAA/4yRQWvjMBCF/8oyZ9sbrxNjDHvI7qGH3lLopfQwksaxakVjpLFLG/LfixIKDaRJj2LmfU/z3h5wtI8UomUPLQSFusBJeg72HcWyL4YmFpZ/zyVkMFhvoIX/bopCYcOO/llvrN9CBjsSNCgI7R7Qe5ajPKYnqxfSEkmKYLnQKOIoMW2CQfbtnF89hXw7D9DCUMUvk7nMft1bb/6ujWF/E+FxR9CCY40uj8IBt/QjURxRJ+UwKcrjWxTawSEDh4rc1dN6jD20UDZVV610veo6patFvawXVbesunLVLEyj6wb/GFRmmaBnnxxR+nwMPNvUDIVcpegPGQR2tKHumPJo7wJP47XeLpYGt8ySSTKL0+k8aJ/2n5wHCrPVtNaaJy83UfG0nuPZ/sVcnw8fAQAA//9f/s3AjgIAAA
      objectset.rio.cattle.io/id: ""
      objectset.rio.cattle.io/owner-gvk: k3s.cattle.io/v1, Kind=Addon
      objectset.rio.cattle.io/owner-name: local-storage
      objectset.rio.cattle.io/owner-namespace: kube-system
    creationTimestamp: "2024-01-08T17:05:58Z"
    labels:
      objectset.rio.cattle.io/hash: 183f35c65ffbc3064603f43f1580d8c68a2dabd4
    name: local-path-provisioner-bind
    resourceVersion: "270"
    uid: 3847ebc1-fd46-4406-a419-a9d5884f731f
  roleRef:
    apiGroup: rbac.authorization.k8s.io
    kind: ClusterRole
    name: local-path-provisioner-role
  subjects:
  - kind: ServiceAccount
    name: local-path-provisioner-service-account
    namespace: kube-system
- apiVersion: rbac.authorization.k8s.io/v1
  kind: ClusterRole
  metadata:
    annotations:
      objectset.rio.cattle.io/applied: H4sIAAAAAAAA/4ySMY/bMAyF/0rBsZDdpE4Cw0CHokOHbh26FBloiY5Vy6Ig0j60h/z3QkaGO7R3l0mgHt5HUk+PgMn/oCyeI3SQe7Q1Ljpy9n9QPcd6aqX2/GHdg4HJRwcdfAmLKOXvHAgMzKToUBG6R8AYWTeflJL7X2RVSOvsubaoGqjAfKGAeVHnh0i5uqwTdDA18kRZ9+bdNx/dp8/OcXwTEXEm6CCwxVCJcsYL3WWShLY4p6WnSn6L0gxXAwF7Cq+uNqKM0MG+bYbmaE/HYehtszsdTrtmODTD/tjuXGtPLX502LtDgT4bMqGOVcq8+hIJ5SqXV74ayEsgge7nltjXzEsqFcDZQCbhJdtNhsiOBAykEqooRV05LDPZgH4uguU4+MuMSYp3pdxvvgspGAheyvGAakc4X81b3Si6xD7q/zpud+yet3l/F3Wlgnzqs5lQS3bphdFu6d7+6z/Im2wDitAdm5+vfwMAAP//OqHYBhsDAAA
      objectset.rio.cattle.io/id: ""
      objectset.rio.cattle.io/owner-gvk: k3s.cattle.io/v1, Kind=Addon
      objectset.rio.cattle.io/owner-name: local-storage
      objectset.rio.cattle.io/owner-namespace: kube-system
    creationTimestamp: "2024-01-08T17:05:58Z"
    labels:
      objectset.rio.cattle.io/hash: 183f35c65ffbc3064603f43f1580d8c68a2dabd4
    name: local-path-provisioner-role
    resourceVersion: "269"
    uid: 893c5c72-e93d-40cc-81b5-1779e96a6a92
  rules:
  - apiGroups:
    - ""
    resources:
    - nodes
    - persistentvolumeclaims
    - configmaps
    verbs:
    - get
    - list
    - watch
  - apiGroups:
    - ""
    resources:
    - endpoints
    - persistentvolumes
    - pods
    verbs:
    - '*'
  - apiGroups:
    - ""
    resources:
    - events
    verbs:
    - create
    - patch
  - apiGroups:
    - storage.k8s.io
    resources:
    - storageclasses
    verbs:
    - get
    - list
    - watch
...
</pre></div></li><li class='expandable detail-hide'>kube-system ServiceAccount traefik<div class='details'><pre>---
kind: ServiceAccount
name: traefik
namespace: kube-system
relatedObjects:
- apiVersion: rbac.authorization.k8s.io/v1
  kind: ClusterRoleBinding
  metadata:
    annotations:
      meta.helm.sh/release-name: traefik
      meta.helm.sh/release-namespace: kube-system
    creationTimestamp: "2024-01-08T17:06:48Z"
    labels:
      app.kubernetes.io/instance: traefik-kube-system
      app.kubernetes.io/managed-by: Helm
      app.kubernetes.io/name: traefik
      helm.sh/chart: traefik-21.2.1_up21.2.0
    name: traefik-kube-system
    resourceVersion: "546"
    uid: 3b79bfea-e538-4ca3-ab2c-6486126d79ed
  roleRef:
    apiGroup: rbac.authorization.k8s.io
    kind: ClusterRole
    name: traefik-kube-system
  subjects:
  - kind: ServiceAccount
    name: traefik
    namespace: kube-system
- apiVersion: rbac.authorization.k8s.io/v1
  kind: ClusterRole
  metadata:
    annotations:
      meta.helm.sh/release-name: traefik
      meta.helm.sh/release-namespace: kube-system
    creationTimestamp: "2024-01-08T17:06:48Z"
    labels:
      app.kubernetes.io/instance: traefik-kube-system
      app.kubernetes.io/managed-by: Helm
      app.kubernetes.io/name: traefik
      helm.sh/chart: traefik-21.2.1_up21.2.0
    name: traefik-kube-system
    resourceVersion: "545"
    uid: 8564701d-a4e1-451e-baa7-2905263b21c5
  rules:
  - apiGroups:
    - extensions
    - networking.k8s.io
    resources:
    - ingressclasses
    - ingresses
    verbs:
    - get
    - list
    - watch
  - apiGroups:
    - ""
    resources:
    - services
    - endpoints
    - secrets
    verbs:
    - get
    - list
    - watch
  - apiGroups:
    - extensions
    - networking.k8s.io
    resources:
    - ingresses/status
    verbs:
    - update
  - apiGroups:
    - traefik.containo.us
    resources:
    - ingressroutes
    - ingressroutetcps
    - ingressrouteudps
    - middlewares
    - middlewaretcps
    - tlsoptions
    - tlsstores
    - traefikservices
    - serverstransports
    verbs:
    - get
    - list
    - watch
...
</pre></div></li></ul></div></div></div><div class='accordion-item'><div class='accordion-header' id='control_19_header'><button class='accordion-button collapsed' type='button' data-bs-toggle='collapse' data-bs-target='#control_19' aria-expanded='false' aria-controls='control_19'><div class='row'><div class='col'><h2 class='fs-4'>C-0055: Linux hardening</h2><p class='mb-0'> Containers may be given more privileges than they actually need. This can increase the potential impact of a container compromise.</p></div></div></button></div><div id='control_19' class='accordion-collapse collapse' aria-labelledby='control_19_header' data-bs-parent='#report'><div class='accordion-body'><p>In order to reduce the attack surface, it is recommend, when it is possible, to harden your application using security services such as SELinux®, AppArmor®, and seccomp. Starting from Kubernetes version 22, SELinux is enabled by default. </p><h5>Detection</h5><p>Check if there is AppArmor or Seccomp or SELinux or Capabilities are defined in the securityContext of container and pod. If none of these fields are defined for both the container and pod, alert.</p><h5>Remediation</h5><p>You can use AppArmor, Seccomp, SELinux and Linux Capabilities mechanisms to restrict containers abilities to utilize unwanted privileges.</p><h5>Checked paths and expected values</h5><ul><li>spec.template.spec.containers[*].securityContext.capabilities.drop[*] = YOUR_VALUE</li><li>spec.template.spec.containers[*].securityContext.seLinuxOptions = YOUR_VALUE</li><li>spec.template.spec.containers[*].securityContext.seccompProfile = YOUR_VALUE</li></ul><h5>Affected resources</h5><ul><li class='expandable detail-hide'>kube-system DaemonSet svclb-traefik-bf26f129<div class='details'><pre>---
apiVersion: apps/v1
kind: DaemonSet
metadata:
  annotations:
    deprecated.daemonset.template.generation: "1"
    objectset.rio.cattle.io/applied: H4sIAAAAAAAA/8RVwW7jNhD9lWLOsizb2tQR0EOQBEXQrmPY3l4WRjCiRjFriiTIkTZGoH8vKDtZpWsnQYFm4YNBzptH8r3RzCOglX+R89JoyACt9cNmBBFspS4ggyukyuglMURQEWOBjJA9AmptGFka7cPS5H+TYE8cO2ligcyKYmmGMnBAdDJuvmlyg/tmCxkMm1H0yx9SF78tyTVS0Jt5GiuCDNghlXL7Lri3KELOts5p4HeeqYI2AuGoe8xKVuQZKwuZrpWKQGFO6tUnbtBvIIPp5KwUuaBkPC4+FUif8snZ2Xla0oiwnEzPxfkEy18LARH4Rgij2RmlyMXbie+xaVOQJ0WCjYMMSlSe3kjxjfhBiHfgTyhxoPKNUPngQDjIy/FZORqfwz5+ItVbEkGp7/d/hApZbP58FhGtPU3ethEwVVYhU5fbq7d3GPQq98dJ2BMCazaVqTUfCvpCiLBamS1pyDpvIwiHoNTkPGRfH4F00/0f7rNcXN7NbxcriKBBVYetaQJt9AKwuJj9fr3sQZK4+w1fIK+ul6u7+eJ2ddtDri7nP2JeO69D3Mz7p42SOJ3Eo/EoHo8SaNcRyArvQ8ShFhtyw62S1pIbqDxrkjiNUzhg5rVSc6Ok2EEGN+XM8NyRJ83wXInBTWEH0wQisMbxXqZn1ebGMWTTJIKN8fx9dSzbGTbCqKdnryNw5E3tBIUCCsaRqJ3k3aXRTA/cFR5azKWSLGlfZUUB2VeYXa/uLq4+38xg3bZBnrd9S9PJxxr3rwN/lnPhGq9Yl6aTvnfd8ijB/+be+miq33nByvdN1cSxtE0aS3tXGvcNXdEXE9p1d4v+tz7rtVOIgI0i9zQ2w9deliQYMpiZpdhQUavQ7bcURA2jYOCMojj0F6eJyYfmU6FncmHa2cDVzYnrB+nZd27/F8pDoxtYhZpOMu85Lp1kKVBdFIXR/lar3fGEdeiEtS2QackOme53QdbQT6W+/9IF9hPi4YvGBqXCXBFkozAFdjaotniB7TorI9edk6J2jjTP6ion9/TQArIkgoK8dFQcC+lu77P0/sj2grDYQZa07T8BAAD//yoC/PIWCQAA
    objectset.rio.cattle.io/id: ""
    objectset.rio.cattle.io/owner-gvk: /v1, Kind=Service
    objectset.rio.cattle.io/owner-name: traefik
    objectset.rio.cattle.io/owner-namespace: kube-system
  creationTimestamp: "2024-01-08T17:06:48Z"
  generation: 1
  labels:
    objectset.rio.cattle.io/hash: 836fcbce022d5dae5b36694fe1eaf389c93af7dc
    svccontroller.k3s.cattle.io/nodeselector: "false"
    svccontroller.k3s.cattle.io/svcname: traefik
    svccontroller.k3s.cattle.io/svcnamespace: kube-system
  name: svclb-traefik-bf26f129
  namespace: kube-system
  resourceVersion: "615"
  uid: acc5b475-2181-4d70-b320-8de6f12fd45f
spec:
  revisionHistoryLimit: 10
  selector:
    matchLabels:
      app: svclb-traefik-bf26f129
  template:
    metadata:
      creationTimestamp: ~
      labels:
        app: svclb-traefik-bf26f129
        svccontroller.k3s.cattle.io/svcname: traefik
        svccontroller.k3s.cattle.io/svcnamespace: kube-system
    spec:
      automountServiceAccountToken: false
      containers:
      - name: lb-tcp-80
        image: rancher/klipper-lb:v0.4.4
        ports:
        - name: lb-tcp-80
          hostPort: 80
          containerPort: 80
          protocol: TCP
        env:
        - name: SRC_PORT
          value: XXXXXX
        - name: SRC_RANGES
          value: XXXXXX
        - name: DEST_PROTO
          value: XXXXXX
        - name: DEST_PORT
          value: XXXXXX
        - name: DEST_IPS
          value: XXXXXX
        resources: []
        terminationMessagePath: /dev/termination-log
        terminationMessagePolicy: File
        imagePullPolicy: IfNotPresent
        securityContext:
          capabilities:
            add:
            - NET_ADMIN
      - name: lb-tcp-443
        image: rancher/klipper-lb:v0.4.4
        ports:
        - name: lb-tcp-443
          hostPort: 443
          containerPort: 443
          protocol: TCP
        env:
        - name: SRC_PORT
          value: XXXXXX
        - name: SRC_RANGES
          value: XXXXXX
        - name: DEST_PROTO
          value: XXXXXX
        - name: DEST_PORT
          value: XXXXXX
        - name: DEST_IPS
          value: XXXXXX
        resources: []
        terminationMessagePath: /dev/termination-log
        terminationMessagePolicy: File
        imagePullPolicy: IfNotPresent
        securityContext:
          capabilities:
            add:
            - NET_ADMIN
      dnsPolicy: ClusterFirst
      restartPolicy: Always
      schedulerName: default-scheduler
      securityContext:
        sysctls:
        - name: net.ipv4.ip_forward
          value: "1"
      serviceAccount: svclb
      serviceAccountName: svclb
      terminationGracePeriodSeconds: 30
      tolerations:
      - effect: NoSchedule
        key: node-role.kubernetes.io/master
        operator: Exists
      - effect: NoSchedule
        key: node-role.kubernetes.io/control-plane
        operator: Exists
      - key: CriticalAddonsOnly
        operator: Exists
  updateStrategy:
    rollingUpdate:
      maxSurge: 0
      maxUnavailable: 1
    type: RollingUpdate
...
</pre></div></li><li class='expandable detail-hide'>kube-system Deployment local-path-provisioner<div class='details'><pre>---
apiVersion: apps/v1
kind: Deployment
metadata:
  annotations:
    deployment.kubernetes.io/revision: "1"
    objectset.rio.cattle.io/applied: H4sIAAAAAAAA/6xU3W7yRhB9lWqubQMfBCFLvUBJqlZNCEqU3kSoGtZj2LDeXe0Obizkd68Gm/yoIWmlXnl/Zs6emXPGB0Cv/6AQtbOQA3ofB/UIEthpW0AOV+SNayqyDAlUxFggI+QHQGsdI2tno2zd+pkUR+IsaJcpZDaUaTfQAgLJ2Xv3l6WQbuod5LAbx3c39Sj56Xdti5/nReHstxAWK4IcjFNo0sgu4Ib+VVL0qCRzt19TGpvIVEGbgME1mS9L22LcQg6j2bgcX6jpRVmu1Xg4nUyH43IyLkcXs2ExU9MZ/ihwXUwE9ANJj7xNfXC1luZTgO7+DJ/oSQmbQF38r1qKbG50pRnyYQKRDCl2QYIqZLW9ea0AvT//aivgHJBp0xwfcMZou3n0BTJ1YC+PFmvUBteGIB+1CXDjheP9h1g5p8qbU947t5j/wKUvVDnLqC2FCPmTbKsKxZJP59sXGYP4NE2Vs6XeQAIDYjXodv0ne47OwioBsvURuRdleXf152J+e/2wnF9eQwI1mj39ElwlZEpNprin8nW9RBbxTzVmb8q1bbtKQFfivxwCWrWlMPicc14Ps2H2YwJ9wnJvzNIZrRrI4bdy4XgZKHbD9513amf2Fd26veWuY5Use57v2/CG1R2kXSa0KyHug3ZBc3NpMMZFF9e5MLWuoFQFzVqhkXZTqLWiuVLy0uIrfmkfm2IXDAmwMxROP5CnA+xIir7s4Y9DH++saWSIvUSKteH6RUeO0CYHoLIkxZDDwj2oLRV7IwPfwRypBmcokzEKlpiizKyYKjiTeoOW/lfkCiMfdfgEcnVS52RlafstenHTP2Xtvduel6lt278DAAD//8i6p1C4BQAA
    objectset.rio.cattle.io/id: ""
    objectset.rio.cattle.io/owner-gvk: k3s.cattle.io/v1, Kind=Addon
    objectset.rio.cattle.io/owner-name: local-storage
    objectset.rio.cattle.io/owner-namespace: kube-system
  creationTimestamp: "2024-01-08T17:05:58Z"
  generation: 1
  labels:
    objectset.rio.cattle.io/hash: 183f35c65ffbc3064603f43f1580d8c68a2dabd4
  name: local-path-provisioner
  namespace: kube-system
  resourceVersion: "475"
  uid: 718c0dfe-3f1a-4b36-807a-d731f31753f6
spec:
  progressDeadlineSeconds: 600
  replicas: 1
  revisionHistoryLimit: 0
  selector:
    matchLabels:
      app: local-path-provisioner
  strategy:
    rollingUpdate:
      maxSurge: 25%
      maxUnavailable: 1
    type: RollingUpdate
  template:
    metadata:
      creationTimestamp: ~
      labels:
        app: local-path-provisioner
    spec:
      containers:
      - name: local-path-provisioner
        image: rancher/local-path-provisioner:v0.0.24
        command:
        - local-path-provisioner
        - start
        - --config
        - /etc/config/config.json
        env:
        - name: POD_NAMESPACE
          value: XXXXXX
          valueFrom:
            fieldRef:
              apiVersion: v1
              fieldPath: metadata.namespace
        resources: []
        volumeMounts:
        - name: config-volume
          mountPath: /etc/config/
        terminationMessagePath: /dev/termination-log
        terminationMessagePolicy: File
        imagePullPolicy: IfNotPresent
      dnsPolicy: ClusterFirst
      priorityClassName: system-node-critical
      restartPolicy: Always
      schedulerName: default-scheduler
      securityContext: []
      serviceAccount: local-path-provisioner-service-account
      serviceAccountName: local-path-provisioner-service-account
      terminationGracePeriodSeconds: 30
      tolerations:
      - key: CriticalAddonsOnly
        operator: Exists
      - effect: NoSchedule
        key: node-role.kubernetes.io/control-plane
        operator: Exists
      - effect: NoSchedule
        key: node-role.kubernetes.io/master
        operator: Exists
      volumes:
      - configMap:
          defaultMode: 420
          name: local-path-config
        name: config-volume
...
</pre></div></li><li class='expandable detail-hide'>kube-system Job helm-install-traefik<div class='details'><pre>---
apiVersion: batch/v1
kind: Job
metadata:
  annotations:
    batch.kubernetes.io/job-tracking: ""
    objectset.rio.cattle.io/applied: H4sIAAAAAAAA/6xVUY/qNhP9K59Guk9fEgLZbCDSPgQIhd5diAK7alWtkDETcHHsyHZoVyv+e+WQezfb3m5vpb7ZzszxOeM5k1cgFXtCpZkUEMOOGHrsnfvgwImJPcTwo9yBAyUasieGQPwKRAhpiGFSaLuVu1+RGo3GU0x6lBjD0WOyx2z2EXnpUimMkpyjcumRKOMqPDBtVIMBzt8iyN8EKvdwPrVAnU/nvvO/z0zs7+bIy4kF/UccQUqEGIwiWLDTd4XrilCbc6p36OoXbbCEiwNUYUN9w0rUhpQVxKLm3AFOdsiboli6jVbt/Yl5c/pdPI5EHyEG6hejCElEBiEGe6RRfxRGNCLB4KZPgmERYFgQDAvLrNXYVJ0JbQjn7ttFH0jSFVLLe0foSRbFPSuZgbjv+74DBsuKE4P2+wd98IFkKQp2mF/lrOfJILy9C6NJMByPZuPx7ThIg4kfzobRKEgnfhCG09EoDGfRjT9OwptplM4G09HtdBTNhtPb//wBLh35tlMJE6g0xL+8AlEHu4C2lOCA62o0rjaKiQM4cOByR7h3reMUC1Jzk1+b++UOnh1AcW6Q2odZJg8pOHAmvO724sX5GvGU5uvFatk9ytNs1d3P0/uH7TRfPKV5B0sjVWi6cZN5km+29sp1lky6975//PcJnbCjMZWOe71Pr58fx2m+TDfpeptki8unnrYPT6+11L1WhzvoewOv//+6ahb+X0h/Q9wmyX9I/xXL5HEz32bJer2d5Ok0XW4Wyf26k1YQrrGbsFxts3z108+dGE+fqeNRXmuDyuOSEu70fe9m4Pme3+vfNpug3XSxZsni/jFPt9nqfjHpIir80iSXZwdYSQ7NKRH0iKp34qyqULm2FeOz7w29gburGd8P/EHgD/shtDlZzXkmOaMvEMOiWEqTKdQoDLwzNzigUMtaUbTdfnHgLHld4oOshbn2bmmXGTHWc60D3zAa1roR9j6unaRtmLWDvfvybEUJucc1cqRGKmsW+z5KoEHdTE0NMXAm6t+tQ5X1pTJfpazEjDBeKwQHNKozo5hQaq9edkbW26i6ytFd77ScnS+dHr+2qxbh+mu5RrkdczeuLtjhgVQ2R3SjW4Fv4d+S3gwIQ0zdlPryRwAAAP//DrZg0DIHAAA
    objectset.rio.cattle.io/id: helm-controller-chart-registration
    objectset.rio.cattle.io/owner-gvk: helm.cattle.io/v1, Kind=HelmChart
    objectset.rio.cattle.io/owner-name: traefik
    objectset.rio.cattle.io/owner-namespace: kube-system
  creationTimestamp: "2024-01-08T17:06:00Z"
  generation: 1
  labels:
    helmcharts.helm.cattle.io/chart: traefik
    objectset.rio.cattle.io/hash: c0f97ea7a25e3dec71957c7a3241a38f3e5fae5f
  name: helm-install-traefik
  namespace: kube-system
  resourceVersion: "598"
  uid: 2a591629-9af8-4949-b2dd-39bd02b148a4
spec:
  backoffLimit: 1000
  completionMode: NonIndexed
  completions: 1
  parallelism: 1
  selector:
    matchLabels:
      batch.kubernetes.io/controller-uid: 2a591629-9af8-4949-b2dd-39bd02b148a4
  suspend: false
  template:
    metadata:
      annotations:
        helmcharts.helm.cattle.io/configHash: SHA256=57C38B9FBB6B3E3C05F8793EC0355D9955F740BA54D7EF2D96D97F8D678F2B0E
      creationTimestamp: ~
      labels:
        batch.kubernetes.io/controller-uid: 2a591629-9af8-4949-b2dd-39bd02b148a4
        batch.kubernetes.io/job-name: helm-install-traefik
        controller-uid: 2a591629-9af8-4949-b2dd-39bd02b148a4
        helmcharts.helm.cattle.io/chart: traefik
        job-name: helm-install-traefik
    spec:
      containers:
      - name: helm
        image: rancher/klipper-helm:v0.8.2-build20230815
        args:
        - install
        - --set-string
        - global.systemDefaultRegistry=
        env:
        - name: NAME
          value: XXXXXX
        - name: VERSION
          value: XXXXXX
        - name: REPO
          value: XXXXXX
        - name: HELM_DRIVER
          value: XXXXXX
        - name: CHART_NAMESPACE
          value: XXXXXX
        - name: CHART
          value: XXXXXX
        - name: HELM_VERSION
          value: XXXXXX
        - name: TARGET_NAMESPACE
          value: XXXXXX
        - name: AUTH_PASS_CREDENTIALS
          value: XXXXXX
        - name: NO_PROXY
          value: XXXXXX
        - name: FAILURE_POLICY
          value: XXXXXX
        resources: []
        volumeMounts:
        - name: values
          mountPath: /config
        - name: content
          mountPath: /chart
        terminationMessagePath: /dev/termination-log
        terminationMessagePolicy: File
        imagePullPolicy: IfNotPresent
      dnsPolicy: ClusterFirst
      nodeSelector:
        kubernetes.io/os: linux
      restartPolicy: OnFailure
      schedulerName: default-scheduler
      securityContext: []
      serviceAccount: helm-traefik
      serviceAccountName: helm-traefik
      terminationGracePeriodSeconds: 30
      volumes:
      - name: values
        secret:
          defaultMode: 420
          secretName: chart-values-traefik
      - configMap:
          defaultMode: 420
          name: chart-content-traefik
        name: content
...
</pre></div></li><li class='expandable detail-hide'>kube-system Job helm-install-traefik-crd<div class='details'><pre>---
apiVersion: batch/v1
kind: Job
metadata:
  annotations:
    batch.kubernetes.io/job-tracking: ""
    objectset.rio.cattle.io/applied: H4sIAAAAAAAA/7RVUY/iNhD+K9VI99QkJCEsm0j3ELhQ6O0CCuyqVbVCxkzAxbEj26E9If575ZC7hu11e324t9ie7/P3jWcmZyAVe0almRSQwJYYeuidAnDgyMQOEvhZbsGBEg3ZEUMgOQMRQhpimBTaLuX2d6RGo/EUkx4lxnD0mOwxiz4gL10qhVGSc1QuPRBlXIV7po1qOMD5Vwb5h0Dl7k/HlqhzdAqcHz4ysXs/RV6OLel/8ghSIiRgFMGCHV2qdt8E0RWhFnest+jqT9pgCRcHqMJG/pqVqA0pK0hEzbkDnGyRN4mxkhu/2nulvtn9Zi0Hog+QQHRfFP3dgPaDYLjtD8OC7igZ+PEwHhRxEQ79kBT+IA6tutZrk30mtCGcu7eXvWFNV0it/i2hR1kUD6xkBpLA930HDJYVJwbt+Rs18YZ1KQq2n14traZpOLh7n/VH/jiKwvh+Mg7GQRSnk9EkGt/H8d1kFIdROEyzKMiiuygexf1onEbxII6D0fC7PMSlkwJbuYQJVBqS385A1N5+QJtSeHEAxak5ajM+Tx8zcOBEeP262C7Ol6jnLF/NFvPuVp4tF931NHt43HzIZ89Z3uHTSBWabtx4mubrjb12tUzH3btvX/UW0Ak7GFPppNd7d/74NMryebbOVpt0Obu862n7ovSaJN3reHHDwAu94Me6CoN/iP6KuXWa/5T9L5Xp03q6Waar1WacZx+y+XqWPqw6sIJwjV3AfLFZ5otffu3EePpEHY/yWhtUHpeUcCfwvSj0fM/vBXfNot8uulyTdPbwlGeb5eJhNu4yKvz88pcXB1hJ9s0uEfSAqnfkrKpQubbGkpPv3Xuhu60Z34V+2PfvgwG0mGXN+VJyRj9BArNiLs1SoUZh4KZzwQGFWtaKoi3jiwMnyesSH2UtzLUgS/u5JMY2U9taf3M0qnVj7DauHZdtmK1xe/flxZoScocr5EiNVLYD7PsogQZ1MxY1JMCZqP+0radswynzxcpCTAjjtUJwQKM6MYoppfbqeWce3c6hqyXd7aFWt/O52pNz+9WyXP8h1yj3Vec2LVuw/SOpLE50Ea3RW8jX0tBMAENM3aT98lcAAAD//411peIjBwAA
    objectset.rio.cattle.io/id: helm-controller-chart-registration
    objectset.rio.cattle.io/owner-gvk: helm.cattle.io/v1, Kind=HelmChart
    objectset.rio.cattle.io/owner-name: traefik-crd
    objectset.rio.cattle.io/owner-namespace: kube-system
  creationTimestamp: "2024-01-08T17:06:00Z"
  generation: 1
  labels:
    helmcharts.helm.cattle.io/chart: traefik-crd
    objectset.rio.cattle.io/hash: 48ff3d5c3117b372fcdca509795f9f2702af0592
  name: helm-install-traefik-crd
  namespace: kube-system
  resourceVersion: "588"
  uid: 655ceb1b-aaa8-4b24-92ab-fceb2ddd45bd
spec:
  backoffLimit: 1000
  completionMode: NonIndexed
  completions: 1
  parallelism: 1
  selector:
    matchLabels:
      batch.kubernetes.io/controller-uid: 655ceb1b-aaa8-4b24-92ab-fceb2ddd45bd
  suspend: false
  template:
    metadata:
      annotations:
        helmcharts.helm.cattle.io/configHash: SHA256=E3B0C44298FC1C149AFBF4C8996FB92427AE41E4649B934CA495991B7852B855
      creationTimestamp: ~
      labels:
        batch.kubernetes.io/controller-uid: 655ceb1b-aaa8-4b24-92ab-fceb2ddd45bd
        batch.kubernetes.io/job-name: helm-install-traefik-crd
        controller-uid: 655ceb1b-aaa8-4b24-92ab-fceb2ddd45bd
        helmcharts.helm.cattle.io/chart: traefik-crd
        job-name: helm-install-traefik-crd
    spec:
      containers:
      - name: helm
        image: rancher/klipper-helm:v0.8.2-build20230815
        args:
        - install
        env:
        - name: NAME
          value: XXXXXX
        - name: VERSION
          value: XXXXXX
        - name: REPO
          value: XXXXXX
        - name: HELM_DRIVER
          value: XXXXXX
        - name: CHART_NAMESPACE
          value: XXXXXX
        - name: CHART
          value: XXXXXX
        - name: HELM_VERSION
          value: XXXXXX
        - name: TARGET_NAMESPACE
          value: XXXXXX
        - name: AUTH_PASS_CREDENTIALS
          value: XXXXXX
        - name: NO_PROXY
          value: XXXXXX
        - name: FAILURE_POLICY
          value: XXXXXX
        resources: []
        volumeMounts:
        - name: values
          mountPath: /config
        - name: content
          mountPath: /chart
        terminationMessagePath: /dev/termination-log
        terminationMessagePolicy: File
        imagePullPolicy: IfNotPresent
      dnsPolicy: ClusterFirst
      nodeSelector:
        kubernetes.io/os: linux
      restartPolicy: OnFailure
      schedulerName: default-scheduler
      securityContext: []
      serviceAccount: helm-traefik-crd
      serviceAccountName: helm-traefik-crd
      terminationGracePeriodSeconds: 30
      volumes:
      - name: values
        secret:
          defaultMode: 420
          secretName: chart-values-traefik-crd
      - configMap:
          defaultMode: 420
          name: chart-content-traefik-crd
        name: content
...
</pre></div></li></ul></div></div></div><div class='accordion-item'><div class='accordion-header' id='control_20_header'><button class='accordion-button collapsed' type='button' data-bs-toggle='collapse' data-bs-target='#control_20' aria-expanded='false' aria-controls='control_20'><div class='row'><div class='col'><h2 class='fs-4'>C-0056: Configured liveness probe</h2><p class='mb-0'> Liveness probe is intended to ensure that workload remains healthy during its entire execution lifecycle, or otherwise restrat the container. It is highly recommended to define liveness probe for every worker container. This control finds all the pods where the Liveness probe is not configured.</p></div></div></button></div><div id='control_20' class='accordion-collapse collapse' aria-labelledby='control_20_header' data-bs-parent='#report'><div class='accordion-body'><p>Liveness probe is intended to ensure that workload remains healthy during its entire execution lifecycle, or otherwise restrat the container. It is highly recommended to define liveness probe for every worker container. This control finds all the pods where the Liveness probe is not configured.</p><h5>Remediation</h5><p>Ensure Liveness probes are configured wherever possible.</p><h5>Checked paths and expected values</h5><ul><li>spec.template.spec.containers[*].livenessProbe = YOUR_VALUE</li></ul><h5>Affected resources</h5><ul><li class='expandable detail-hide'>kube-system DaemonSet svclb-traefik-bf26f129<div class='details'><pre>---
apiVersion: apps/v1
kind: DaemonSet
metadata:
  annotations:
    deprecated.daemonset.template.generation: "1"
    objectset.rio.cattle.io/applied: H4sIAAAAAAAA/8RVwW7jNhD9lWLOsizb2tQR0EOQBEXQrmPY3l4WRjCiRjFriiTIkTZGoH8vKDtZpWsnQYFm4YNBzptH8r3RzCOglX+R89JoyACt9cNmBBFspS4ggyukyuglMURQEWOBjJA9AmptGFka7cPS5H+TYE8cO2ligcyKYmmGMnBAdDJuvmlyg/tmCxkMm1H0yx9SF78tyTVS0Jt5GiuCDNghlXL7Lri3KELOts5p4HeeqYI2AuGoe8xKVuQZKwuZrpWKQGFO6tUnbtBvIIPp5KwUuaBkPC4+FUif8snZ2Xla0oiwnEzPxfkEy18LARH4Rgij2RmlyMXbie+xaVOQJ0WCjYMMSlSe3kjxjfhBiHfgTyhxoPKNUPngQDjIy/FZORqfwz5+ItVbEkGp7/d/hApZbP58FhGtPU3ethEwVVYhU5fbq7d3GPQq98dJ2BMCazaVqTUfCvpCiLBamS1pyDpvIwiHoNTkPGRfH4F00/0f7rNcXN7NbxcriKBBVYetaQJt9AKwuJj9fr3sQZK4+w1fIK+ul6u7+eJ2ddtDri7nP2JeO69D3Mz7p42SOJ3Eo/EoHo8SaNcRyArvQ8ShFhtyw62S1pIbqDxrkjiNUzhg5rVSc6Ok2EEGN+XM8NyRJ83wXInBTWEH0wQisMbxXqZn1ebGMWTTJIKN8fx9dSzbGTbCqKdnryNw5E3tBIUCCsaRqJ3k3aXRTA/cFR5azKWSLGlfZUUB2VeYXa/uLq4+38xg3bZBnrd9S9PJxxr3rwN/lnPhGq9Yl6aTvnfd8ijB/+be+miq33nByvdN1cSxtE0aS3tXGvcNXdEXE9p1d4v+tz7rtVOIgI0i9zQ2w9deliQYMpiZpdhQUavQ7bcURA2jYOCMojj0F6eJyYfmU6FncmHa2cDVzYnrB+nZd27/F8pDoxtYhZpOMu85Lp1kKVBdFIXR/lar3fGEdeiEtS2QackOme53QdbQT6W+/9IF9hPi4YvGBqXCXBFkozAFdjaotniB7TorI9edk6J2jjTP6ion9/TQArIkgoK8dFQcC+lu77P0/sj2grDYQZa07T8BAAD//yoC/PIWCQAA
    objectset.rio.cattle.io/id: ""
    objectset.rio.cattle.io/owner-gvk: /v1, Kind=Service
    objectset.rio.cattle.io/owner-name: traefik
    objectset.rio.cattle.io/owner-namespace: kube-system
  creationTimestamp: "2024-01-08T17:06:48Z"
  generation: 1
  labels:
    objectset.rio.cattle.io/hash: 836fcbce022d5dae5b36694fe1eaf389c93af7dc
    svccontroller.k3s.cattle.io/nodeselector: "false"
    svccontroller.k3s.cattle.io/svcname: traefik
    svccontroller.k3s.cattle.io/svcnamespace: kube-system
  name: svclb-traefik-bf26f129
  namespace: kube-system
  resourceVersion: "615"
  uid: acc5b475-2181-4d70-b320-8de6f12fd45f
spec:
  revisionHistoryLimit: 10
  selector:
    matchLabels:
      app: svclb-traefik-bf26f129
  template:
    metadata:
      creationTimestamp: ~
      labels:
        app: svclb-traefik-bf26f129
        svccontroller.k3s.cattle.io/svcname: traefik
        svccontroller.k3s.cattle.io/svcnamespace: kube-system
    spec:
      automountServiceAccountToken: false
      containers:
      - name: lb-tcp-80
        image: rancher/klipper-lb:v0.4.4
        ports:
        - name: lb-tcp-80
          hostPort: 80
          containerPort: 80
          protocol: TCP
        env:
        - name: SRC_PORT
          value: XXXXXX
        - name: SRC_RANGES
          value: XXXXXX
        - name: DEST_PROTO
          value: XXXXXX
        - name: DEST_PORT
          value: XXXXXX
        - name: DEST_IPS
          value: XXXXXX
        resources: []
        terminationMessagePath: /dev/termination-log
        terminationMessagePolicy: File
        imagePullPolicy: IfNotPresent
        securityContext:
          capabilities:
            add:
            - NET_ADMIN
      - name: lb-tcp-443
        image: rancher/klipper-lb:v0.4.4
        ports:
        - name: lb-tcp-443
          hostPort: 443
          containerPort: 443
          protocol: TCP
        env:
        - name: SRC_PORT
          value: XXXXXX
        - name: SRC_RANGES
          value: XXXXXX
        - name: DEST_PROTO
          value: XXXXXX
        - name: DEST_PORT
          value: XXXXXX
        - name: DEST_IPS
          value: XXXXXX
        resources: []
        terminationMessagePath: /dev/termination-log
        terminationMessagePolicy: File
        imagePullPolicy: IfNotPresent
        securityContext:
          capabilities:
            add:
            - NET_ADMIN
      dnsPolicy: ClusterFirst
      restartPolicy: Always
      schedulerName: default-scheduler
      securityContext:
        sysctls:
        - name: net.ipv4.ip_forward
          value: "1"
      serviceAccount: svclb
      serviceAccountName: svclb
      terminationGracePeriodSeconds: 30
      tolerations:
      - effect: NoSchedule
        key: node-role.kubernetes.io/master
        operator: Exists
      - effect: NoSchedule
        key: node-role.kubernetes.io/control-plane
        operator: Exists
      - key: CriticalAddonsOnly
        operator: Exists
  updateStrategy:
    rollingUpdate:
      maxSurge: 0
      maxUnavailable: 1
    type: RollingUpdate
...
</pre></div></li><li class='expandable detail-hide'>kube-system Deployment local-path-provisioner<div class='details'><pre>---
apiVersion: apps/v1
kind: Deployment
metadata:
  annotations:
    deployment.kubernetes.io/revision: "1"
    objectset.rio.cattle.io/applied: H4sIAAAAAAAA/6xU3W7yRhB9lWqubQMfBCFLvUBJqlZNCEqU3kSoGtZj2LDeXe0Obizkd68Gm/yoIWmlXnl/Zs6emXPGB0Cv/6AQtbOQA3ofB/UIEthpW0AOV+SNayqyDAlUxFggI+QHQGsdI2tno2zd+pkUR+IsaJcpZDaUaTfQAgLJ2Xv3l6WQbuod5LAbx3c39Sj56Xdti5/nReHstxAWK4IcjFNo0sgu4Ib+VVL0qCRzt19TGpvIVEGbgME1mS9L22LcQg6j2bgcX6jpRVmu1Xg4nUyH43IyLkcXs2ExU9MZ/ihwXUwE9ANJj7xNfXC1luZTgO7+DJ/oSQmbQF38r1qKbG50pRnyYQKRDCl2QYIqZLW9ea0AvT//aivgHJBp0xwfcMZou3n0BTJ1YC+PFmvUBteGIB+1CXDjheP9h1g5p8qbU947t5j/wKUvVDnLqC2FCPmTbKsKxZJP59sXGYP4NE2Vs6XeQAIDYjXodv0ne47OwioBsvURuRdleXf152J+e/2wnF9eQwI1mj39ElwlZEpNprin8nW9RBbxTzVmb8q1bbtKQFfivxwCWrWlMPicc14Ps2H2YwJ9wnJvzNIZrRrI4bdy4XgZKHbD9513amf2Fd26veWuY5Use57v2/CG1R2kXSa0KyHug3ZBc3NpMMZFF9e5MLWuoFQFzVqhkXZTqLWiuVLy0uIrfmkfm2IXDAmwMxROP5CnA+xIir7s4Y9DH++saWSIvUSKteH6RUeO0CYHoLIkxZDDwj2oLRV7IwPfwRypBmcokzEKlpiizKyYKjiTeoOW/lfkCiMfdfgEcnVS52RlafstenHTP2Xtvduel6lt278DAAD//8i6p1C4BQAA
    objectset.rio.cattle.io/id: ""
    objectset.rio.cattle.io/owner-gvk: k3s.cattle.io/v1, Kind=Addon
    objectset.rio.cattle.io/owner-name: local-storage
    objectset.rio.cattle.io/owner-namespace: kube-system
  creationTimestamp: "2024-01-08T17:05:58Z"
  generation: 1
  labels:
    objectset.rio.cattle.io/hash: 183f35c65ffbc3064603f43f1580d8c68a2dabd4
  name: local-path-provisioner
  namespace: kube-system
  resourceVersion: "475"
  uid: 718c0dfe-3f1a-4b36-807a-d731f31753f6
spec:
  progressDeadlineSeconds: 600
  replicas: 1
  revisionHistoryLimit: 0
  selector:
    matchLabels:
      app: local-path-provisioner
  strategy:
    rollingUpdate:
      maxSurge: 25%
      maxUnavailable: 1
    type: RollingUpdate
  template:
    metadata:
      creationTimestamp: ~
      labels:
        app: local-path-provisioner
    spec:
      containers:
      - name: local-path-provisioner
        image: rancher/local-path-provisioner:v0.0.24
        command:
        - local-path-provisioner
        - start
        - --config
        - /etc/config/config.json
        env:
        - name: POD_NAMESPACE
          value: XXXXXX
          valueFrom:
            fieldRef:
              apiVersion: v1
              fieldPath: metadata.namespace
        resources: []
        volumeMounts:
        - name: config-volume
          mountPath: /etc/config/
        terminationMessagePath: /dev/termination-log
        terminationMessagePolicy: File
        imagePullPolicy: IfNotPresent
      dnsPolicy: ClusterFirst
      priorityClassName: system-node-critical
      restartPolicy: Always
      schedulerName: default-scheduler
      securityContext: []
      serviceAccount: local-path-provisioner-service-account
      serviceAccountName: local-path-provisioner-service-account
      terminationGracePeriodSeconds: 30
      tolerations:
      - key: CriticalAddonsOnly
        operator: Exists
      - effect: NoSchedule
        key: node-role.kubernetes.io/control-plane
        operator: Exists
      - effect: NoSchedule
        key: node-role.kubernetes.io/master
        operator: Exists
      volumes:
      - configMap:
          defaultMode: 420
          name: local-path-config
        name: config-volume
...
</pre></div></li><li class='expandable detail-hide'>kube-system Job helm-install-traefik<div class='details'><pre>---
apiVersion: batch/v1
kind: Job
metadata:
  annotations:
    batch.kubernetes.io/job-tracking: ""
    objectset.rio.cattle.io/applied: H4sIAAAAAAAA/6xVUY/qNhP9K59Guk9fEgLZbCDSPgQIhd5diAK7alWtkDETcHHsyHZoVyv+e+WQezfb3m5vpb7ZzszxOeM5k1cgFXtCpZkUEMOOGHrsnfvgwImJPcTwo9yBAyUasieGQPwKRAhpiGFSaLuVu1+RGo3GU0x6lBjD0WOyx2z2EXnpUimMkpyjcumRKOMqPDBtVIMBzt8iyN8EKvdwPrVAnU/nvvO/z0zs7+bIy4kF/UccQUqEGIwiWLDTd4XrilCbc6p36OoXbbCEiwNUYUN9w0rUhpQVxKLm3AFOdsiboli6jVbt/Yl5c/pdPI5EHyEG6hejCElEBiEGe6RRfxRGNCLB4KZPgmERYFgQDAvLrNXYVJ0JbQjn7ttFH0jSFVLLe0foSRbFPSuZgbjv+74DBsuKE4P2+wd98IFkKQp2mF/lrOfJILy9C6NJMByPZuPx7ThIg4kfzobRKEgnfhCG09EoDGfRjT9OwptplM4G09HtdBTNhtPb//wBLh35tlMJE6g0xL+8AlEHu4C2lOCA62o0rjaKiQM4cOByR7h3reMUC1Jzk1+b++UOnh1AcW6Q2odZJg8pOHAmvO724sX5GvGU5uvFatk9ytNs1d3P0/uH7TRfPKV5B0sjVWi6cZN5km+29sp1lky6975//PcJnbCjMZWOe71Pr58fx2m+TDfpeptki8unnrYPT6+11L1WhzvoewOv//+6ahb+X0h/Q9wmyX9I/xXL5HEz32bJer2d5Ok0XW4Wyf26k1YQrrGbsFxts3z108+dGE+fqeNRXmuDyuOSEu70fe9m4Pme3+vfNpug3XSxZsni/jFPt9nqfjHpIir80iSXZwdYSQ7NKRH0iKp34qyqULm2FeOz7w29gburGd8P/EHgD/shtDlZzXkmOaMvEMOiWEqTKdQoDLwzNzigUMtaUbTdfnHgLHld4oOshbn2bmmXGTHWc60D3zAa1roR9j6unaRtmLWDvfvybEUJucc1cqRGKmsW+z5KoEHdTE0NMXAm6t+tQ5X1pTJfpazEjDBeKwQHNKozo5hQaq9edkbW26i6ytFd77ScnS+dHr+2qxbh+mu5RrkdczeuLtjhgVQ2R3SjW4Fv4d+S3gwIQ0zdlPryRwAAAP//DrZg0DIHAAA
    objectset.rio.cattle.io/id: helm-controller-chart-registration
    objectset.rio.cattle.io/owner-gvk: helm.cattle.io/v1, Kind=HelmChart
    objectset.rio.cattle.io/owner-name: traefik
    objectset.rio.cattle.io/owner-namespace: kube-system
  creationTimestamp: "2024-01-08T17:06:00Z"
  generation: 1
  labels:
    helmcharts.helm.cattle.io/chart: traefik
    objectset.rio.cattle.io/hash: c0f97ea7a25e3dec71957c7a3241a38f3e5fae5f
  name: helm-install-traefik
  namespace: kube-system
  resourceVersion: "598"
  uid: 2a591629-9af8-4949-b2dd-39bd02b148a4
spec:
  backoffLimit: 1000
  completionMode: NonIndexed
  completions: 1
  parallelism: 1
  selector:
    matchLabels:
      batch.kubernetes.io/controller-uid: 2a591629-9af8-4949-b2dd-39bd02b148a4
  suspend: false
  template:
    metadata:
      annotations:
        helmcharts.helm.cattle.io/configHash: SHA256=57C38B9FBB6B3E3C05F8793EC0355D9955F740BA54D7EF2D96D97F8D678F2B0E
      creationTimestamp: ~
      labels:
        batch.kubernetes.io/controller-uid: 2a591629-9af8-4949-b2dd-39bd02b148a4
        batch.kubernetes.io/job-name: helm-install-traefik
        controller-uid: 2a591629-9af8-4949-b2dd-39bd02b148a4
        helmcharts.helm.cattle.io/chart: traefik
        job-name: helm-install-traefik
    spec:
      containers:
      - name: helm
        image: rancher/klipper-helm:v0.8.2-build20230815
        args:
        - install
        - --set-string
        - global.systemDefaultRegistry=
        env:
        - name: NAME
          value: XXXXXX
        - name: VERSION
          value: XXXXXX
        - name: REPO
          value: XXXXXX
        - name: HELM_DRIVER
          value: XXXXXX
        - name: CHART_NAMESPACE
          value: XXXXXX
        - name: CHART
          value: XXXXXX
        - name: HELM_VERSION
          value: XXXXXX
        - name: TARGET_NAMESPACE
          value: XXXXXX
        - name: AUTH_PASS_CREDENTIALS
          value: XXXXXX
        - name: NO_PROXY
          value: XXXXXX
        - name: FAILURE_POLICY
          value: XXXXXX
        resources: []
        volumeMounts:
        - name: values
          mountPath: /config
        - name: content
          mountPath: /chart
        terminationMessagePath: /dev/termination-log
        terminationMessagePolicy: File
        imagePullPolicy: IfNotPresent
      dnsPolicy: ClusterFirst
      nodeSelector:
        kubernetes.io/os: linux
      restartPolicy: OnFailure
      schedulerName: default-scheduler
      securityContext: []
      serviceAccount: helm-traefik
      serviceAccountName: helm-traefik
      terminationGracePeriodSeconds: 30
      volumes:
      - name: values
        secret:
          defaultMode: 420
          secretName: chart-values-traefik
      - configMap:
          defaultMode: 420
          name: chart-content-traefik
        name: content
...
</pre></div></li><li class='expandable detail-hide'>kube-system Job helm-install-traefik-crd<div class='details'><pre>---
apiVersion: batch/v1
kind: Job
metadata:
  annotations:
    batch.kubernetes.io/job-tracking: ""
    objectset.rio.cattle.io/applied: H4sIAAAAAAAA/7RVUY/iNhD+K9VI99QkJCEsm0j3ELhQ6O0CCuyqVbVCxkzAxbEj26E9If575ZC7hu11e324t9ie7/P3jWcmZyAVe0almRSQwJYYeuidAnDgyMQOEvhZbsGBEg3ZEUMgOQMRQhpimBTaLuX2d6RGo/EUkx4lxnD0mOwxiz4gL10qhVGSc1QuPRBlXIV7po1qOMD5Vwb5h0Dl7k/HlqhzdAqcHz4ysXs/RV6OLel/8ghSIiRgFMGCHV2qdt8E0RWhFnest+jqT9pgCRcHqMJG/pqVqA0pK0hEzbkDnGyRN4mxkhu/2nulvtn9Zi0Hog+QQHRfFP3dgPaDYLjtD8OC7igZ+PEwHhRxEQ79kBT+IA6tutZrk30mtCGcu7eXvWFNV0it/i2hR1kUD6xkBpLA930HDJYVJwbt+Rs18YZ1KQq2n14traZpOLh7n/VH/jiKwvh+Mg7GQRSnk9EkGt/H8d1kFIdROEyzKMiiuygexf1onEbxII6D0fC7PMSlkwJbuYQJVBqS385A1N5+QJtSeHEAxak5ajM+Tx8zcOBEeP262C7Ol6jnLF/NFvPuVp4tF931NHt43HzIZ89Z3uHTSBWabtx4mubrjb12tUzH3btvX/UW0Ak7GFPppNd7d/74NMryebbOVpt0Obu862n7ovSaJN3reHHDwAu94Me6CoN/iP6KuXWa/5T9L5Xp03q6Waar1WacZx+y+XqWPqw6sIJwjV3AfLFZ5otffu3EePpEHY/yWhtUHpeUcCfwvSj0fM/vBXfNot8uulyTdPbwlGeb5eJhNu4yKvz88pcXB1hJ9s0uEfSAqnfkrKpQubbGkpPv3Xuhu60Z34V+2PfvgwG0mGXN+VJyRj9BArNiLs1SoUZh4KZzwQGFWtaKoi3jiwMnyesSH2UtzLUgS/u5JMY2U9taf3M0qnVj7DauHZdtmK1xe/flxZoScocr5EiNVLYD7PsogQZ1MxY1JMCZqP+0radswynzxcpCTAjjtUJwQKM6MYoppfbqeWce3c6hqyXd7aFWt/O52pNz+9WyXP8h1yj3Vec2LVuw/SOpLE50Ea3RW8jX0tBMAENM3aT98lcAAAD//411peIjBwAA
    objectset.rio.cattle.io/id: helm-controller-chart-registration
    objectset.rio.cattle.io/owner-gvk: helm.cattle.io/v1, Kind=HelmChart
    objectset.rio.cattle.io/owner-name: traefik-crd
    objectset.rio.cattle.io/owner-namespace: kube-system
  creationTimestamp: "2024-01-08T17:06:00Z"
  generation: 1
  labels:
    helmcharts.helm.cattle.io/chart: traefik-crd
    objectset.rio.cattle.io/hash: 48ff3d5c3117b372fcdca509795f9f2702af0592
  name: helm-install-traefik-crd
  namespace: kube-system
  resourceVersion: "588"
  uid: 655ceb1b-aaa8-4b24-92ab-fceb2ddd45bd
spec:
  backoffLimit: 1000
  completionMode: NonIndexed
  completions: 1
  parallelism: 1
  selector:
    matchLabels:
      batch.kubernetes.io/controller-uid: 655ceb1b-aaa8-4b24-92ab-fceb2ddd45bd
  suspend: false
  template:
    metadata:
      annotations:
        helmcharts.helm.cattle.io/configHash: SHA256=E3B0C44298FC1C149AFBF4C8996FB92427AE41E4649B934CA495991B7852B855
      creationTimestamp: ~
      labels:
        batch.kubernetes.io/controller-uid: 655ceb1b-aaa8-4b24-92ab-fceb2ddd45bd
        batch.kubernetes.io/job-name: helm-install-traefik-crd
        controller-uid: 655ceb1b-aaa8-4b24-92ab-fceb2ddd45bd
        helmcharts.helm.cattle.io/chart: traefik-crd
        job-name: helm-install-traefik-crd
    spec:
      containers:
      - name: helm
        image: rancher/klipper-helm:v0.8.2-build20230815
        args:
        - install
        env:
        - name: NAME
          value: XXXXXX
        - name: VERSION
          value: XXXXXX
        - name: REPO
          value: XXXXXX
        - name: HELM_DRIVER
          value: XXXXXX
        - name: CHART_NAMESPACE
          value: XXXXXX
        - name: CHART
          value: XXXXXX
        - name: HELM_VERSION
          value: XXXXXX
        - name: TARGET_NAMESPACE
          value: XXXXXX
        - name: AUTH_PASS_CREDENTIALS
          value: XXXXXX
        - name: NO_PROXY
          value: XXXXXX
        - name: FAILURE_POLICY
          value: XXXXXX
        resources: []
        volumeMounts:
        - name: values
          mountPath: /config
        - name: content
          mountPath: /chart
        terminationMessagePath: /dev/termination-log
        terminationMessagePolicy: File
        imagePullPolicy: IfNotPresent
      dnsPolicy: ClusterFirst
      nodeSelector:
        kubernetes.io/os: linux
      restartPolicy: OnFailure
      schedulerName: default-scheduler
      securityContext: []
      serviceAccount: helm-traefik-crd
      serviceAccountName: helm-traefik-crd
      terminationGracePeriodSeconds: 30
      volumes:
      - name: values
        secret:
          defaultMode: 420
          secretName: chart-values-traefik-crd
      - configMap:
          defaultMode: 420
          name: chart-content-traefik-crd
        name: content
...
</pre></div></li></ul></div></div></div><div class='accordion-item'><div class='accordion-header' id='control_21_header'><button class='accordion-button collapsed' type='button' data-bs-toggle='collapse' data-bs-target='#control_21' aria-expanded='false' aria-controls='control_21'><div class='row'><div class='col'><h2 class='fs-4'>C-0063: Portforwarding privileges</h2><p class='mb-0'> Attackers with relevant RBAC permission can use “kubectl portforward” command to establish direct communication with pods from within the cluster or even remotely. Such communication will most likely bypass existing security measures in the cluster. This control determines which subjects have permissions to use this command.</p></div></div></button></div><div id='control_21' class='accordion-collapse collapse' aria-labelledby='control_21_header' data-bs-parent='#report'><div class='accordion-body'><p>Attackers who have relevant RBAC permissions, can run open a backdoor communication channel directly to the sockets inside target container using exec command “kubectl portforward” command. Using this method, attackers can bypass network security restrictions and communicate directly with software in the containers.</p><h5>Detection</h5><p>Check which subjects have RBAC permissions to portforward into pods– if they have the “pods/portforward” resource.</p><h5>Remediation</h5><p>It is recommended to prohibit “kubectl portforward” command in production environments. It is also recommended not to use subjects with this permission for daily cluster operations.</p><h5>Checked paths and expected values</h5><ul><li>relatedObjects[*].roleRef.name</li><li>relatedObjects[*].rules[*].apiGroups[*]</li><li>relatedObjects[*].rules[*].resources[*]</li><li>relatedObjects[*].rules[*].verbs[*]</li><li>relatedObjects[*].subjects[*]</li></ul><h5>Example</h5><pre>kind: Role
apiVersion: rbac.authorization.k8s.io/v1
metadata:
  namespace: my-namespace
  name: allow-port-forward
rules:
- apiGroups: ["*"]
  resources: ["pods", "pods/portforward"] # we look for this resource or *
  verbs: ["update", "patch", "create"]	  # we look for these verbs or *</pre><h5>Affected resources</h5><ul><li class='expandable detail-hide'>kube-system ServiceAccount helm-traefik<div class='details'><pre>---
kind: ServiceAccount
name: helm-traefik
namespace: kube-system
relatedObjects:
- apiVersion: rbac.authorization.k8s.io/v1
  kind: ClusterRoleBinding
  metadata:
    annotations:
      objectset.rio.cattle.io/applied: H4sIAAAAAAAA/4yRze6TUBDFX8XMGlD+SGhJXGgXmrirxo1xMVyGMnI/yNwBo03f3UBbrYmtLu/H+c2Zc46AI38iiRw81CANmgwn7YPwD1QOPhs2MePwfM4hgYF9CzXs7BSVZB8svWHfsj9AAo4UW1SE+gjofdBVHpdjaL6S0UiaCYfMoKqlhckLrCfrUhO8SrCWJDU9iqZCB44qKwOSu4TwzZOkh3m4gG6e5jx59p59++odWbdboP/keHQENaggdTz81/c4olk0w9RQGr9HJQenBIzQav0jO4qKboTaT9YmYLEh+zCUHmMPNZgX3bYirPCppKIlU+XbsjIVFk8vcyw2XUFlh1R2y7SL7zXJGyPpdZFTAhIs7albyxn5rYRpfFT3X7uGX5PM+TLF1rFf8HE6bwP15+NV+YFkZkOvjQmTV/jT5u+M76b45fQzAAD//6tHuTCdAgAA
      objectset.rio.cattle.io/id: helm-controller-chart-registration
      objectset.rio.cattle.io/owner-gvk: helm.cattle.io/v1, Kind=HelmChart
      objectset.rio.cattle.io/owner-name: traefik
      objectset.rio.cattle.io/owner-namespace: kube-system
    creationTimestamp: "2024-01-08T17:06:00Z"
    labels:
      objectset.rio.cattle.io/hash: c0f97ea7a25e3dec71957c7a3241a38f3e5fae5f
    name: helm-kube-system-traefik
    resourceVersion: "349"
    uid: a815f9db-1d48-4564-a669-936f12c9a7ec
  roleRef:
    apiGroup: rbac.authorization.k8s.io
    kind: ClusterRole
    name: cluster-admin
  subjects:
  - kind: ServiceAccount
    name: helm-traefik
    namespace: kube-system
- apiVersion: rbac.authorization.k8s.io/v1
  kind: ClusterRole
  metadata:
    annotations:
      rbac.authorization.kubernetes.io/autoupdate: "true"
    creationTimestamp: "2024-01-08T17:05:54Z"
    labels:
      kubernetes.io/bootstrapping: rbac-defaults
    name: cluster-admin
    resourceVersion: "72"
    uid: 7a564a7b-9ca4-49ce-8a42-78660cb44f4c
  rules:
  - apiGroups:
    - '*'
    resources:
    - '*'
    verbs:
    - '*'
  - nonResourceURLs:
    - '*'
    verbs:
    - '*'
...
</pre></div></li><li class='expandable detail-hide'>kube-system ServiceAccount helm-traefik-crd<div class='details'><pre>---
kind: ServiceAccount
name: helm-traefik-crd
namespace: kube-system
relatedObjects:
- apiVersion: rbac.authorization.k8s.io/v1
  kind: ClusterRoleBinding
  metadata:
    annotations:
      objectset.rio.cattle.io/applied: H4sIAAAAAAAA/4yRzY7UQAyEXwX5nA7zw2g2kTjAHkDitiAuiIPT7Z6Y9E/kdoJgNO+Okl3QrMQuHLut+lyuOgOO/JmkcE7QgnRoa5y0z8I/UTmnergpNeeX8xYqGDg5aOE2TEVJ7nKgt5wcpxNUEEnRoSK0Z8CUsq7ysjxz942sFtJaONcWVQMtTF5gPYVobE4qOQQSY3sUNUInLiorA6onCfl7IjGneXgAXY3mbfXiAyf3+j2FeLtA/8lJGAlaUEHyPBgr7r8kZUS76IapI1N+FKUIlwqs0Gr/E0cqinGENk0hVBCwo/BsMD2WHlp4deP93h3sfrs9dvvjzltn8bBpjs3BN3533OzQbw7Nbtn24H1N88qIuT7mUoHkQHfk15JGfid5Gp+r/a+dw59t9v7ToIucFnyZ7i+C9sv5t/IjycyW3libp6Tw2OrjrJ9M8+vlVwAAAP//b1bdJakCAAA
      objectset.rio.cattle.io/id: helm-controller-chart-registration
      objectset.rio.cattle.io/owner-gvk: helm.cattle.io/v1, Kind=HelmChart
      objectset.rio.cattle.io/owner-name: traefik-crd
      objectset.rio.cattle.io/owner-namespace: kube-system
    creationTimestamp: "2024-01-08T17:06:00Z"
    labels:
      objectset.rio.cattle.io/hash: 48ff3d5c3117b372fcdca509795f9f2702af0592
    name: helm-kube-system-traefik-crd
    resourceVersion: "348"
    uid: 31be0c7e-dd79-49c6-9a13-77f5f124746c
  roleRef:
    apiGroup: rbac.authorization.k8s.io
    kind: ClusterRole
    name: cluster-admin
  subjects:
  - kind: ServiceAccount
    name: helm-traefik-crd
    namespace: kube-system
- apiVersion: rbac.authorization.k8s.io/v1
  kind: ClusterRole
  metadata:
    annotations:
      rbac.authorization.kubernetes.io/autoupdate: "true"
    creationTimestamp: "2024-01-08T17:05:54Z"
    labels:
      kubernetes.io/bootstrapping: rbac-defaults
    name: cluster-admin
    resourceVersion: "72"
    uid: 7a564a7b-9ca4-49ce-8a42-78660cb44f4c
  rules:
  - apiGroups:
    - '*'
    resources:
    - '*'
    verbs:
    - '*'
  - nonResourceURLs:
    - '*'
    verbs:
    - '*'
...
</pre></div></li></ul></div></div></div><div class='accordion-item'><div class='accordion-header' id='control_22_header'><button class='accordion-button collapsed' type='button' data-bs-toggle='collapse' data-bs-target='#control_22' aria-expanded='false' aria-controls='control_22'><div class='row'><div class='col'><h2 class='fs-4'>C-0065: No impersonation</h2><p class='mb-0'> Impersonation is an explicit RBAC permission to use other roles rather than the one assigned to a user, group or service account. This is sometimes needed for testing purposes. However, it is highly recommended not to use this capability in the production environments for daily operations. This control identifies all subjects whose roles include impersonate verb.</p></div></div></button></div><div id='control_22' class='accordion-collapse collapse' aria-labelledby='control_22_header' data-bs-parent='#report'><div class='accordion-body'><p>Impersonation is an explicit RBAC permission to use other roles rather than the one assigned to a user, group or service account. This is sometimes needed for testing purposes. However, it is highly recommended not to use this capability in the production environments for daily operations. This control identifies all subjects whose roles include impersonate verb.</p><h5>Detection</h5><p>Check for RBACs giving 'impersonate' verb to users/groups/uids/serviceaccounts</p><h5>Remediation</h5><p>Either remove the impersonate verb from the role where it was found or make sure that this role is not bound to users, groups or service accounts used for ongoing cluster operations. If necessary, bind this role to a subject only for specific needs for limited time period.</p><h5>Checked paths and expected values</h5><ul><li>relatedObjects[*].roleRef.name</li><li>relatedObjects[*].rules[*].apiGroups[*]</li><li>relatedObjects[*].rules[*].resources[*]</li><li>relatedObjects[*].rules[*].verbs[*]</li><li>relatedObjects[*].subjects[*]</li></ul><h5>Example</h5><pre></pre><h5>Affected resources</h5><ul><li class='expandable detail-hide'>kube-system ServiceAccount helm-traefik<div class='details'><pre>---
kind: ServiceAccount
name: helm-traefik
namespace: kube-system
relatedObjects:
- apiVersion: rbac.authorization.k8s.io/v1
  kind: ClusterRoleBinding
  metadata:
    annotations:
      objectset.rio.cattle.io/applied: H4sIAAAAAAAA/4yRze6TUBDFX8XMGlD+SGhJXGgXmrirxo1xMVyGMnI/yNwBo03f3UBbrYmtLu/H+c2Zc46AI38iiRw81CANmgwn7YPwD1QOPhs2MePwfM4hgYF9CzXs7BSVZB8svWHfsj9AAo4UW1SE+gjofdBVHpdjaL6S0UiaCYfMoKqlhckLrCfrUhO8SrCWJDU9iqZCB44qKwOSu4TwzZOkh3m4gG6e5jx59p59++odWbdboP/keHQENaggdTz81/c4olk0w9RQGr9HJQenBIzQav0jO4qKboTaT9YmYLEh+zCUHmMPNZgX3bYirPCppKIlU+XbsjIVFk8vcyw2XUFlh1R2y7SL7zXJGyPpdZFTAhIs7albyxn5rYRpfFT3X7uGX5PM+TLF1rFf8HE6bwP15+NV+YFkZkOvjQmTV/jT5u+M76b45fQzAAD//6tHuTCdAgAA
      objectset.rio.cattle.io/id: helm-controller-chart-registration
      objectset.rio.cattle.io/owner-gvk: helm.cattle.io/v1, Kind=HelmChart
      objectset.rio.cattle.io/owner-name: traefik
      objectset.rio.cattle.io/owner-namespace: kube-system
    creationTimestamp: "2024-01-08T17:06:00Z"
    labels:
      objectset.rio.cattle.io/hash: c0f97ea7a25e3dec71957c7a3241a38f3e5fae5f
    name: helm-kube-system-traefik
    resourceVersion: "349"
    uid: a815f9db-1d48-4564-a669-936f12c9a7ec
  roleRef:
    apiGroup: rbac.authorization.k8s.io
    kind: ClusterRole
    name: cluster-admin
  subjects:
  - kind: ServiceAccount
    name: helm-traefik
    namespace: kube-system
- apiVersion: rbac.authorization.k8s.io/v1
  kind: ClusterRole
  metadata:
    annotations:
      rbac.authorization.kubernetes.io/autoupdate: "true"
    creationTimestamp: "2024-01-08T17:05:54Z"
    labels:
      kubernetes.io/bootstrapping: rbac-defaults
    name: cluster-admin
    resourceVersion: "72"
    uid: 7a564a7b-9ca4-49ce-8a42-78660cb44f4c
  rules:
  - apiGroups:
    - '*'
    resources:
    - '*'
    verbs:
    - '*'
  - nonResourceURLs:
    - '*'
    verbs:
    - '*'
...
</pre></div></li><li class='expandable detail-hide'>kube-system ServiceAccount helm-traefik-crd<div class='details'><pre>---
kind: ServiceAccount
name: helm-traefik-crd
namespace: kube-system
relatedObjects:
- apiVersion: rbac.authorization.k8s.io/v1
  kind: ClusterRoleBinding
  metadata:
    annotations:
      objectset.rio.cattle.io/applied: H4sIAAAAAAAA/4yRzY7UQAyEXwX5nA7zw2g2kTjAHkDitiAuiIPT7Z6Y9E/kdoJgNO+Okl3QrMQuHLut+lyuOgOO/JmkcE7QgnRoa5y0z8I/UTmnergpNeeX8xYqGDg5aOE2TEVJ7nKgt5wcpxNUEEnRoSK0Z8CUsq7ysjxz942sFtJaONcWVQMtTF5gPYVobE4qOQQSY3sUNUInLiorA6onCfl7IjGneXgAXY3mbfXiAyf3+j2FeLtA/8lJGAlaUEHyPBgr7r8kZUS76IapI1N+FKUIlwqs0Gr/E0cqinGENk0hVBCwo/BsMD2WHlp4deP93h3sfrs9dvvjzltn8bBpjs3BN3533OzQbw7Nbtn24H1N88qIuT7mUoHkQHfk15JGfid5Gp+r/a+dw59t9v7ToIucFnyZ7i+C9sv5t/IjycyW3libp6Tw2OrjrJ9M8+vlVwAAAP//b1bdJakCAAA
      objectset.rio.cattle.io/id: helm-controller-chart-registration
      objectset.rio.cattle.io/owner-gvk: helm.cattle.io/v1, Kind=HelmChart
      objectset.rio.cattle.io/owner-name: traefik-crd
      objectset.rio.cattle.io/owner-namespace: kube-system
    creationTimestamp: "2024-01-08T17:06:00Z"
    labels:
      objectset.rio.cattle.io/hash: 48ff3d5c3117b372fcdca509795f9f2702af0592
    name: helm-kube-system-traefik-crd
    resourceVersion: "348"
    uid: 31be0c7e-dd79-49c6-9a13-77f5f124746c
  roleRef:
    apiGroup: rbac.authorization.k8s.io
    kind: ClusterRole
    name: cluster-admin
  subjects:
  - kind: ServiceAccount
    name: helm-traefik-crd
    namespace: kube-system
- apiVersion: rbac.authorization.k8s.io/v1
  kind: ClusterRole
  metadata:
    annotations:
      rbac.authorization.kubernetes.io/autoupdate: "true"
    creationTimestamp: "2024-01-08T17:05:54Z"
    labels:
      kubernetes.io/bootstrapping: rbac-defaults
    name: cluster-admin
    resourceVersion: "72"
    uid: 7a564a7b-9ca4-49ce-8a42-78660cb44f4c
  rules:
  - apiGroups:
    - '*'
    resources:
    - '*'
    verbs:
    - '*'
  - nonResourceURLs:
    - '*'
    verbs:
    - '*'
...
</pre></div></li></ul></div></div></div><div class='accordion-item'><div class='accordion-header' id='control_23_header'><button class='accordion-button collapsed' type='button' data-bs-toggle='collapse' data-bs-target='#control_23' aria-expanded='false' aria-controls='control_23'><div class='row'><div class='col'><h2 class='fs-4'>C-0076: Label usage for resources</h2><p class='mb-0'> It is recommended to set labels that identify semantic attributes of your application or deployment. For example, { app: myapp, tier: frontend, phase: test, deployment: v3 }. These labels can used to assign policies to logical groups of the deployments as well as for presentation and tracking purposes. This control helps you find deployments without any of the expected labels.</p></div></div></button></div><div id='control_23' class='accordion-collapse collapse' aria-labelledby='control_23_header' data-bs-parent='#report'><div class='accordion-body'><p>It is recommended to set labels that identify semantic attributes of your application or deployment. For example, { app: myapp, tier: frontend, phase: test, deployment: v3 }. These labels can used to assign policies to logical groups of the deployments as well as for presentation and tracking purposes. This control helps you find deployments without any of the expected labels.</p><h5>Detection</h5><p>Test will check if a certain set of labels is defined, this is a configurable control. Initial list: app, tier, phase, version, owner, env.</p><h5>Remediation</h5><p>Define labels that are most suitable to your needs of use the exceptions to prevent further notifications.</p><h5>Checked paths and expected values</h5><ul><li>metadata.labels[app] = YOUR_VALUE</li><li>spec.template.metadata.labels[app] = YOUR_VALUE</li></ul><h5>Affected resources</h5><ul><li class='expandable detail-hide'>kube-system DaemonSet svclb-traefik-bf26f129<div class='details'><pre>---
apiVersion: apps/v1
kind: DaemonSet
metadata:
  annotations:
    deprecated.daemonset.template.generation: "1"
    objectset.rio.cattle.io/applied: H4sIAAAAAAAA/8RVwW7jNhD9lWLOsizb2tQR0EOQBEXQrmPY3l4WRjCiRjFriiTIkTZGoH8vKDtZpWsnQYFm4YNBzptH8r3RzCOglX+R89JoyACt9cNmBBFspS4ggyukyuglMURQEWOBjJA9AmptGFka7cPS5H+TYE8cO2ligcyKYmmGMnBAdDJuvmlyg/tmCxkMm1H0yx9SF78tyTVS0Jt5GiuCDNghlXL7Lri3KELOts5p4HeeqYI2AuGoe8xKVuQZKwuZrpWKQGFO6tUnbtBvIIPp5KwUuaBkPC4+FUif8snZ2Xla0oiwnEzPxfkEy18LARH4Rgij2RmlyMXbie+xaVOQJ0WCjYMMSlSe3kjxjfhBiHfgTyhxoPKNUPngQDjIy/FZORqfwz5+ItVbEkGp7/d/hApZbP58FhGtPU3ethEwVVYhU5fbq7d3GPQq98dJ2BMCazaVqTUfCvpCiLBamS1pyDpvIwiHoNTkPGRfH4F00/0f7rNcXN7NbxcriKBBVYetaQJt9AKwuJj9fr3sQZK4+w1fIK+ul6u7+eJ2ddtDri7nP2JeO69D3Mz7p42SOJ3Eo/EoHo8SaNcRyArvQ8ShFhtyw62S1pIbqDxrkjiNUzhg5rVSc6Ok2EEGN+XM8NyRJ83wXInBTWEH0wQisMbxXqZn1ebGMWTTJIKN8fx9dSzbGTbCqKdnryNw5E3tBIUCCsaRqJ3k3aXRTA/cFR5azKWSLGlfZUUB2VeYXa/uLq4+38xg3bZBnrd9S9PJxxr3rwN/lnPhGq9Yl6aTvnfd8ijB/+be+miq33nByvdN1cSxtE0aS3tXGvcNXdEXE9p1d4v+tz7rtVOIgI0i9zQ2w9deliQYMpiZpdhQUavQ7bcURA2jYOCMojj0F6eJyYfmU6FncmHa2cDVzYnrB+nZd27/F8pDoxtYhZpOMu85Lp1kKVBdFIXR/lar3fGEdeiEtS2QackOme53QdbQT6W+/9IF9hPi4YvGBqXCXBFkozAFdjaotniB7TorI9edk6J2jjTP6ion9/TQArIkgoK8dFQcC+lu77P0/sj2grDYQZa07T8BAAD//yoC/PIWCQAA
    objectset.rio.cattle.io/id: ""
    objectset.rio.cattle.io/owner-gvk: /v1, Kind=Service
    objectset.rio.cattle.io/owner-name: traefik
    objectset.rio.cattle.io/owner-namespace: kube-system
  creationTimestamp: "2024-01-08T17:06:48Z"
  generation: 1
  labels:
    objectset.rio.cattle.io/hash: 836fcbce022d5dae5b36694fe1eaf389c93af7dc
    svccontroller.k3s.cattle.io/nodeselector: "false"
    svccontroller.k3s.cattle.io/svcname: traefik
    svccontroller.k3s.cattle.io/svcnamespace: kube-system
  name: svclb-traefik-bf26f129
  namespace: kube-system
  resourceVersion: "615"
  uid: acc5b475-2181-4d70-b320-8de6f12fd45f
spec:
  revisionHistoryLimit: 10
  selector:
    matchLabels:
      app: svclb-traefik-bf26f129
  template:
    metadata:
      creationTimestamp: ~
      labels:
        app: svclb-traefik-bf26f129
        svccontroller.k3s.cattle.io/svcname: traefik
        svccontroller.k3s.cattle.io/svcnamespace: kube-system
    spec:
      automountServiceAccountToken: false
      containers:
      - name: lb-tcp-80
        image: rancher/klipper-lb:v0.4.4
        ports:
        - name: lb-tcp-80
          hostPort: 80
          containerPort: 80
          protocol: TCP
        env:
        - name: SRC_PORT
          value: XXXXXX
        - name: SRC_RANGES
          value: XXXXXX
        - name: DEST_PROTO
          value: XXXXXX
        - name: DEST_PORT
          value: XXXXXX
        - name: DEST_IPS
          value: XXXXXX
        resources: []
        terminationMessagePath: /dev/termination-log
        terminationMessagePolicy: File
        imagePullPolicy: IfNotPresent
        securityContext:
          capabilities:
            add:
            - NET_ADMIN
      - name: lb-tcp-443
        image: rancher/klipper-lb:v0.4.4
        ports:
        - name: lb-tcp-443
          hostPort: 443
          containerPort: 443
          protocol: TCP
        env:
        - name: SRC_PORT
          value: XXXXXX
        - name: SRC_RANGES
          value: XXXXXX
        - name: DEST_PROTO
          value: XXXXXX
        - name: DEST_PORT
          value: XXXXXX
        - name: DEST_IPS
          value: XXXXXX
        resources: []
        terminationMessagePath: /dev/termination-log
        terminationMessagePolicy: File
        imagePullPolicy: IfNotPresent
        securityContext:
          capabilities:
            add:
            - NET_ADMIN
      dnsPolicy: ClusterFirst
      restartPolicy: Always
      schedulerName: default-scheduler
      securityContext:
        sysctls:
        - name: net.ipv4.ip_forward
          value: "1"
      serviceAccount: svclb
      serviceAccountName: svclb
      terminationGracePeriodSeconds: 30
      tolerations:
      - effect: NoSchedule
        key: node-role.kubernetes.io/master
        operator: Exists
      - effect: NoSchedule
        key: node-role.kubernetes.io/control-plane
        operator: Exists
      - key: CriticalAddonsOnly
        operator: Exists
  updateStrategy:
    rollingUpdate:
      maxSurge: 0
      maxUnavailable: 1
    type: RollingUpdate
...
</pre></div></li><li class='expandable detail-hide'>kube-system Deployment local-path-provisioner<div class='details'><pre>---
apiVersion: apps/v1
kind: Deployment
metadata:
  annotations:
    deployment.kubernetes.io/revision: "1"
    objectset.rio.cattle.io/applied: H4sIAAAAAAAA/6xU3W7yRhB9lWqubQMfBCFLvUBJqlZNCEqU3kSoGtZj2LDeXe0Obizkd68Gm/yoIWmlXnl/Zs6emXPGB0Cv/6AQtbOQA3ofB/UIEthpW0AOV+SNayqyDAlUxFggI+QHQGsdI2tno2zd+pkUR+IsaJcpZDaUaTfQAgLJ2Xv3l6WQbuod5LAbx3c39Sj56Xdti5/nReHstxAWK4IcjFNo0sgu4Ib+VVL0qCRzt19TGpvIVEGbgME1mS9L22LcQg6j2bgcX6jpRVmu1Xg4nUyH43IyLkcXs2ExU9MZ/ihwXUwE9ANJj7xNfXC1luZTgO7+DJ/oSQmbQF38r1qKbG50pRnyYQKRDCl2QYIqZLW9ea0AvT//aivgHJBp0xwfcMZou3n0BTJ1YC+PFmvUBteGIB+1CXDjheP9h1g5p8qbU947t5j/wKUvVDnLqC2FCPmTbKsKxZJP59sXGYP4NE2Vs6XeQAIDYjXodv0ne47OwioBsvURuRdleXf152J+e/2wnF9eQwI1mj39ElwlZEpNprin8nW9RBbxTzVmb8q1bbtKQFfivxwCWrWlMPicc14Ps2H2YwJ9wnJvzNIZrRrI4bdy4XgZKHbD9513amf2Fd26veWuY5Use57v2/CG1R2kXSa0KyHug3ZBc3NpMMZFF9e5MLWuoFQFzVqhkXZTqLWiuVLy0uIrfmkfm2IXDAmwMxROP5CnA+xIir7s4Y9DH++saWSIvUSKteH6RUeO0CYHoLIkxZDDwj2oLRV7IwPfwRypBmcokzEKlpiizKyYKjiTeoOW/lfkCiMfdfgEcnVS52RlafstenHTP2Xtvduel6lt278DAAD//8i6p1C4BQAA
    objectset.rio.cattle.io/id: ""
    objectset.rio.cattle.io/owner-gvk: k3s.cattle.io/v1, Kind=Addon
    objectset.rio.cattle.io/owner-name: local-storage
    objectset.rio.cattle.io/owner-namespace: kube-system
  creationTimestamp: "2024-01-08T17:05:58Z"
  generation: 1
  labels:
    objectset.rio.cattle.io/hash: 183f35c65ffbc3064603f43f1580d8c68a2dabd4
  name: local-path-provisioner
  namespace: kube-system
  resourceVersion: "475"
  uid: 718c0dfe-3f1a-4b36-807a-d731f31753f6
spec:
  progressDeadlineSeconds: 600
  replicas: 1
  revisionHistoryLimit: 0
  selector:
    matchLabels:
      app: local-path-provisioner
  strategy:
    rollingUpdate:
      maxSurge: 25%
      maxUnavailable: 1
    type: RollingUpdate
  template:
    metadata:
      creationTimestamp: ~
      labels:
        app: local-path-provisioner
    spec:
      containers:
      - name: local-path-provisioner
        image: rancher/local-path-provisioner:v0.0.24
        command:
        - local-path-provisioner
        - start
        - --config
        - /etc/config/config.json
        env:
        - name: POD_NAMESPACE
          value: XXXXXX
          valueFrom:
            fieldRef:
              apiVersion: v1
              fieldPath: metadata.namespace
        resources: []
        volumeMounts:
        - name: config-volume
          mountPath: /etc/config/
        terminationMessagePath: /dev/termination-log
        terminationMessagePolicy: File
        imagePullPolicy: IfNotPresent
      dnsPolicy: ClusterFirst
      priorityClassName: system-node-critical
      restartPolicy: Always
      schedulerName: default-scheduler
      securityContext: []
      serviceAccount: local-path-provisioner-service-account
      serviceAccountName: local-path-provisioner-service-account
      terminationGracePeriodSeconds: 30
      tolerations:
      - key: CriticalAddonsOnly
        operator: Exists
      - effect: NoSchedule
        key: node-role.kubernetes.io/control-plane
        operator: Exists
      - effect: NoSchedule
        key: node-role.kubernetes.io/master
        operator: Exists
      volumes:
      - configMap:
          defaultMode: 420
          name: local-path-config
        name: config-volume
...
</pre></div></li><li class='expandable detail-hide'>kube-system Deployment traefik<div class='details'><pre>---
apiVersion: apps/v1
kind: Deployment
metadata:
  annotations:
    deployment.kubernetes.io/revision: "1"
    meta.helm.sh/release-name: traefik
    meta.helm.sh/release-namespace: kube-system
  creationTimestamp: "2024-01-08T17:06:48Z"
  generation: 1
  labels:
    app.kubernetes.io/instance: traefik-kube-system
    app.kubernetes.io/managed-by: Helm
    app.kubernetes.io/name: traefik
    helm.sh/chart: traefik-21.2.1_up21.2.0
  name: traefik
  namespace: kube-system
  resourceVersion: "629"
  uid: ec30998f-e81b-47de-aeae-3970de0b73a4
spec:
  progressDeadlineSeconds: 600
  replicas: 1
  revisionHistoryLimit: 10
  selector:
    matchLabels:
      app.kubernetes.io/instance: traefik-kube-system
      app.kubernetes.io/name: traefik
  strategy:
    rollingUpdate:
      maxSurge: 1
      maxUnavailable: 0
    type: RollingUpdate
  template:
    metadata:
      annotations:
        prometheus.io/path: /metrics
        prometheus.io/port: "9100"
        prometheus.io/scrape: "true"
      creationTimestamp: ~
      labels:
        app.kubernetes.io/instance: traefik-kube-system
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: traefik
        helm.sh/chart: traefik-21.2.1_up21.2.0
    spec:
      containers:
      - name: traefik
        image: rancher/mirrored-library-traefik:2.9.10
        args:
        - --global.checknewversion
        - --global.sendanonymoususage
        - --entrypoints.metrics.address=:9100/tcp
        - --entrypoints.traefik.address=:9000/tcp
        - --entrypoints.web.address=:8000/tcp
        - --entrypoints.websecure.address=:8443/tcp
        - --api.dashboard=true
        - --ping=true
        - --metrics.prometheus=true
        - --metrics.prometheus.entrypoint=metrics
        - --providers.kubernetescrd
        - --providers.kubernetesingress
        - --providers.kubernetesingress.ingressendpoint.publishedservice=kube-system/traefik
        - --entrypoints.websecure.http.tls=true
        ports:
        - name: metrics
          containerPort: 9100
          protocol: TCP
        - name: traefik
          containerPort: 9000
          protocol: TCP
        - name: web
          containerPort: 8000
          protocol: TCP
        - name: websecure
          containerPort: 8443
          protocol: TCP
        resources: []
        volumeMounts:
        - name: data
          mountPath: /data
        - name: tmp
          mountPath: /tmp
        livenessProbe:
          httpGet:
            path: /ping
            port: 9000
            scheme: HTTP
          initialDelaySeconds: 2
          timeoutSeconds: 2
          periodSeconds: 10
          successThreshold: 1
          failureThreshold: 3
        readinessProbe:
          httpGet:
            path: /ping
            port: 9000
            scheme: HTTP
          initialDelaySeconds: 2
          timeoutSeconds: 2
          periodSeconds: 10
          successThreshold: 1
          failureThreshold: 1
        terminationMessagePath: /dev/termination-log
        terminationMessagePolicy: File
        imagePullPolicy: IfNotPresent
        securityContext:
          capabilities:
            drop:
            - ALL
          runAsUser: 65532
          runAsGroup: 65532
          runAsNonRoot: true
          readOnlyRootFilesystem: true
      dnsPolicy: ClusterFirst
      priorityClassName: system-cluster-critical
      restartPolicy: Always
      schedulerName: default-scheduler
      securityContext:
        fsGroup: 65532
      serviceAccount: traefik
      serviceAccountName: traefik
      terminationGracePeriodSeconds: 60
      tolerations:
      - key: CriticalAddonsOnly
        operator: Exists
      - effect: NoSchedule
        key: node-role.kubernetes.io/control-plane
        operator: Exists
      - effect: NoSchedule
        key: node-role.kubernetes.io/master
        operator: Exists
      volumes:
      - emptyDir: []
        name: data
      - emptyDir: []
        name: tmp
...
</pre></div></li><li class='expandable detail-hide'>kube-system Job helm-install-traefik<div class='details'><pre>---
apiVersion: batch/v1
kind: Job
metadata:
  annotations:
    batch.kubernetes.io/job-tracking: ""
    objectset.rio.cattle.io/applied: H4sIAAAAAAAA/6xVUY/qNhP9K59Guk9fEgLZbCDSPgQIhd5diAK7alWtkDETcHHsyHZoVyv+e+WQezfb3m5vpb7ZzszxOeM5k1cgFXtCpZkUEMOOGHrsnfvgwImJPcTwo9yBAyUasieGQPwKRAhpiGFSaLuVu1+RGo3GU0x6lBjD0WOyx2z2EXnpUimMkpyjcumRKOMqPDBtVIMBzt8iyN8EKvdwPrVAnU/nvvO/z0zs7+bIy4kF/UccQUqEGIwiWLDTd4XrilCbc6p36OoXbbCEiwNUYUN9w0rUhpQVxKLm3AFOdsiboli6jVbt/Yl5c/pdPI5EHyEG6hejCElEBiEGe6RRfxRGNCLB4KZPgmERYFgQDAvLrNXYVJ0JbQjn7ttFH0jSFVLLe0foSRbFPSuZgbjv+74DBsuKE4P2+wd98IFkKQp2mF/lrOfJILy9C6NJMByPZuPx7ThIg4kfzobRKEgnfhCG09EoDGfRjT9OwptplM4G09HtdBTNhtPb//wBLh35tlMJE6g0xL+8AlEHu4C2lOCA62o0rjaKiQM4cOByR7h3reMUC1Jzk1+b++UOnh1AcW6Q2odZJg8pOHAmvO724sX5GvGU5uvFatk9ytNs1d3P0/uH7TRfPKV5B0sjVWi6cZN5km+29sp1lky6975//PcJnbCjMZWOe71Pr58fx2m+TDfpeptki8unnrYPT6+11L1WhzvoewOv//+6ahb+X0h/Q9wmyX9I/xXL5HEz32bJer2d5Ok0XW4Wyf26k1YQrrGbsFxts3z108+dGE+fqeNRXmuDyuOSEu70fe9m4Pme3+vfNpug3XSxZsni/jFPt9nqfjHpIir80iSXZwdYSQ7NKRH0iKp34qyqULm2FeOz7w29gburGd8P/EHgD/shtDlZzXkmOaMvEMOiWEqTKdQoDLwzNzigUMtaUbTdfnHgLHld4oOshbn2bmmXGTHWc60D3zAa1roR9j6unaRtmLWDvfvybEUJucc1cqRGKmsW+z5KoEHdTE0NMXAm6t+tQ5X1pTJfpazEjDBeKwQHNKozo5hQaq9edkbW26i6ytFd77ScnS+dHr+2qxbh+mu5RrkdczeuLtjhgVQ2R3SjW4Fv4d+S3gwIQ0zdlPryRwAAAP//DrZg0DIHAAA
    objectset.rio.cattle.io/id: helm-controller-chart-registration
    objectset.rio.cattle.io/owner-gvk: helm.cattle.io/v1, Kind=HelmChart
    objectset.rio.cattle.io/owner-name: traefik
    objectset.rio.cattle.io/owner-namespace: kube-system
  creationTimestamp: "2024-01-08T17:06:00Z"
  generation: 1
  labels:
    helmcharts.helm.cattle.io/chart: traefik
    objectset.rio.cattle.io/hash: c0f97ea7a25e3dec71957c7a3241a38f3e5fae5f
  name: helm-install-traefik
  namespace: kube-system
  resourceVersion: "598"
  uid: 2a591629-9af8-4949-b2dd-39bd02b148a4
spec:
  backoffLimit: 1000
  completionMode: NonIndexed
  completions: 1
  parallelism: 1
  selector:
    matchLabels:
      batch.kubernetes.io/controller-uid: 2a591629-9af8-4949-b2dd-39bd02b148a4
  suspend: false
  template:
    metadata:
      annotations:
        helmcharts.helm.cattle.io/configHash: SHA256=57C38B9FBB6B3E3C05F8793EC0355D9955F740BA54D7EF2D96D97F8D678F2B0E
      creationTimestamp: ~
      labels:
        batch.kubernetes.io/controller-uid: 2a591629-9af8-4949-b2dd-39bd02b148a4
        batch.kubernetes.io/job-name: helm-install-traefik
        controller-uid: 2a591629-9af8-4949-b2dd-39bd02b148a4
        helmcharts.helm.cattle.io/chart: traefik
        job-name: helm-install-traefik
    spec:
      containers:
      - name: helm
        image: rancher/klipper-helm:v0.8.2-build20230815
        args:
        - install
        - --set-string
        - global.systemDefaultRegistry=
        env:
        - name: NAME
          value: XXXXXX
        - name: VERSION
          value: XXXXXX
        - name: REPO
          value: XXXXXX
        - name: HELM_DRIVER
          value: XXXXXX
        - name: CHART_NAMESPACE
          value: XXXXXX
        - name: CHART
          value: XXXXXX
        - name: HELM_VERSION
          value: XXXXXX
        - name: TARGET_NAMESPACE
          value: XXXXXX
        - name: AUTH_PASS_CREDENTIALS
          value: XXXXXX
        - name: NO_PROXY
          value: XXXXXX
        - name: FAILURE_POLICY
          value: XXXXXX
        resources: []
        volumeMounts:
        - name: values
          mountPath: /config
        - name: content
          mountPath: /chart
        terminationMessagePath: /dev/termination-log
        terminationMessagePolicy: File
        imagePullPolicy: IfNotPresent
      dnsPolicy: ClusterFirst
      nodeSelector:
        kubernetes.io/os: linux
      restartPolicy: OnFailure
      schedulerName: default-scheduler
      securityContext: []
      serviceAccount: helm-traefik
      serviceAccountName: helm-traefik
      terminationGracePeriodSeconds: 30
      volumes:
      - name: values
        secret:
          defaultMode: 420
          secretName: chart-values-traefik
      - configMap:
          defaultMode: 420
          name: chart-content-traefik
        name: content
...
</pre></div></li><li class='expandable detail-hide'>kube-system Job helm-install-traefik-crd<div class='details'><pre>---
apiVersion: batch/v1
kind: Job
metadata:
  annotations:
    batch.kubernetes.io/job-tracking: ""
    objectset.rio.cattle.io/applied: H4sIAAAAAAAA/7RVUY/iNhD+K9VI99QkJCEsm0j3ELhQ6O0CCuyqVbVCxkzAxbEj26E9If575ZC7hu11e324t9ie7/P3jWcmZyAVe0almRSQwJYYeuidAnDgyMQOEvhZbsGBEg3ZEUMgOQMRQhpimBTaLuX2d6RGo/EUkx4lxnD0mOwxiz4gL10qhVGSc1QuPRBlXIV7po1qOMD5Vwb5h0Dl7k/HlqhzdAqcHz4ysXs/RV6OLel/8ghSIiRgFMGCHV2qdt8E0RWhFnest+jqT9pgCRcHqMJG/pqVqA0pK0hEzbkDnGyRN4mxkhu/2nulvtn9Zi0Hog+QQHRfFP3dgPaDYLjtD8OC7igZ+PEwHhRxEQ79kBT+IA6tutZrk30mtCGcu7eXvWFNV0it/i2hR1kUD6xkBpLA930HDJYVJwbt+Rs18YZ1KQq2n14traZpOLh7n/VH/jiKwvh+Mg7GQRSnk9EkGt/H8d1kFIdROEyzKMiiuygexf1onEbxII6D0fC7PMSlkwJbuYQJVBqS385A1N5+QJtSeHEAxak5ajM+Tx8zcOBEeP262C7Ol6jnLF/NFvPuVp4tF931NHt43HzIZ89Z3uHTSBWabtx4mubrjb12tUzH3btvX/UW0Ak7GFPppNd7d/74NMryebbOVpt0Obu862n7ovSaJN3reHHDwAu94Me6CoN/iP6KuXWa/5T9L5Xp03q6Waar1WacZx+y+XqWPqw6sIJwjV3AfLFZ5otffu3EePpEHY/yWhtUHpeUcCfwvSj0fM/vBXfNot8uulyTdPbwlGeb5eJhNu4yKvz88pcXB1hJ9s0uEfSAqnfkrKpQubbGkpPv3Xuhu60Z34V+2PfvgwG0mGXN+VJyRj9BArNiLs1SoUZh4KZzwQGFWtaKoi3jiwMnyesSH2UtzLUgS/u5JMY2U9taf3M0qnVj7DauHZdtmK1xe/flxZoScocr5EiNVLYD7PsogQZ1MxY1JMCZqP+0radswynzxcpCTAjjtUJwQKM6MYoppfbqeWce3c6hqyXd7aFWt/O52pNz+9WyXP8h1yj3Vec2LVuw/SOpLE50Ea3RW8jX0tBMAENM3aT98lcAAAD//411peIjBwAA
    objectset.rio.cattle.io/id: helm-controller-chart-registration
    objectset.rio.cattle.io/owner-gvk: helm.cattle.io/v1, Kind=HelmChart
    objectset.rio.cattle.io/owner-name: traefik-crd
    objectset.rio.cattle.io/owner-namespace: kube-system
  creationTimestamp: "2024-01-08T17:06:00Z"
  generation: 1
  labels:
    helmcharts.helm.cattle.io/chart: traefik-crd
    objectset.rio.cattle.io/hash: 48ff3d5c3117b372fcdca509795f9f2702af0592
  name: helm-install-traefik-crd
  namespace: kube-system
  resourceVersion: "588"
  uid: 655ceb1b-aaa8-4b24-92ab-fceb2ddd45bd
spec:
  backoffLimit: 1000
  completionMode: NonIndexed
  completions: 1
  parallelism: 1
  selector:
    matchLabels:
      batch.kubernetes.io/controller-uid: 655ceb1b-aaa8-4b24-92ab-fceb2ddd45bd
  suspend: false
  template:
    metadata:
      annotations:
        helmcharts.helm.cattle.io/configHash: SHA256=E3B0C44298FC1C149AFBF4C8996FB92427AE41E4649B934CA495991B7852B855
      creationTimestamp: ~
      labels:
        batch.kubernetes.io/controller-uid: 655ceb1b-aaa8-4b24-92ab-fceb2ddd45bd
        batch.kubernetes.io/job-name: helm-install-traefik-crd
        controller-uid: 655ceb1b-aaa8-4b24-92ab-fceb2ddd45bd
        helmcharts.helm.cattle.io/chart: traefik-crd
        job-name: helm-install-traefik-crd
    spec:
      containers:
      - name: helm
        image: rancher/klipper-helm:v0.8.2-build20230815
        args:
        - install
        env:
        - name: NAME
          value: XXXXXX
        - name: VERSION
          value: XXXXXX
        - name: REPO
          value: XXXXXX
        - name: HELM_DRIVER
          value: XXXXXX
        - name: CHART_NAMESPACE
          value: XXXXXX
        - name: CHART
          value: XXXXXX
        - name: HELM_VERSION
          value: XXXXXX
        - name: TARGET_NAMESPACE
          value: XXXXXX
        - name: AUTH_PASS_CREDENTIALS
          value: XXXXXX
        - name: NO_PROXY
          value: XXXXXX
        - name: FAILURE_POLICY
          value: XXXXXX
        resources: []
        volumeMounts:
        - name: values
          mountPath: /config
        - name: content
          mountPath: /chart
        terminationMessagePath: /dev/termination-log
        terminationMessagePolicy: File
        imagePullPolicy: IfNotPresent
      dnsPolicy: ClusterFirst
      nodeSelector:
        kubernetes.io/os: linux
      restartPolicy: OnFailure
      schedulerName: default-scheduler
      securityContext: []
      serviceAccount: helm-traefik-crd
      serviceAccountName: helm-traefik-crd
      terminationGracePeriodSeconds: 30
      volumes:
      - name: values
        secret:
          defaultMode: 420
          secretName: chart-values-traefik-crd
      - configMap:
          defaultMode: 420
          name: chart-content-traefik-crd
        name: content
...
</pre></div></li></ul></div></div></div><div class='accordion-item'><div class='accordion-header' id='control_24_header'><button class='accordion-button collapsed' type='button' data-bs-toggle='collapse' data-bs-target='#control_24' aria-expanded='false' aria-controls='control_24'><div class='row'><div class='col'><h2 class='fs-4'>C-0077: K8s common labels usage</h2><p class='mb-0'> Kubernetes common labels help manage and monitor Kubernetes cluster using different tools such as kubectl, dashboard and others in an interoperable way. Refer to https://kubernetes.io/docs/concepts/overview/working-with-objects/common-labels/ for more information. This control helps you find objects that don't have any of these labels defined.</p></div></div></button></div><div id='control_24' class='accordion-collapse collapse' aria-labelledby='control_24_header' data-bs-parent='#report'><div class='accordion-body'><p>Kubernetes common labels help manage and monitor Kubernetes cluster using different tools such as kubectl, dashboard and others in an interoperable way. Refer to https://kubernetes.io/docs/concepts/overview/working-with-objects/common-labels/ for more information. This control helps you find objects that don't have any of these labels defined.</p><h5>Detection</h5><p>Test will check if the list of label that start with app.kubernetes.io/ are defined.</p><h5>Remediation</h5><p>Define applicable labels or use the exception mechanism to prevent further notifications.</p><h5>Checked paths and expected values</h5><ul><li>metadata.labels[app.kubernetes.io/name] = YOUR_VALUE</li><li>spec.template.metadata.labels[app.kubernetes.io/name] = YOUR_VALUE</li></ul><h5>Affected resources</h5><ul><li class='expandable detail-hide'>kube-system DaemonSet svclb-traefik-bf26f129<div class='details'><pre>---
apiVersion: apps/v1
kind: DaemonSet
metadata:
  annotations:
    deprecated.daemonset.template.generation: "1"
    objectset.rio.cattle.io/applied: H4sIAAAAAAAA/8RVwW7jNhD9lWLOsizb2tQR0EOQBEXQrmPY3l4WRjCiRjFriiTIkTZGoH8vKDtZpWsnQYFm4YNBzptH8r3RzCOglX+R89JoyACt9cNmBBFspS4ggyukyuglMURQEWOBjJA9AmptGFka7cPS5H+TYE8cO2ligcyKYmmGMnBAdDJuvmlyg/tmCxkMm1H0yx9SF78tyTVS0Jt5GiuCDNghlXL7Lri3KELOts5p4HeeqYI2AuGoe8xKVuQZKwuZrpWKQGFO6tUnbtBvIIPp5KwUuaBkPC4+FUif8snZ2Xla0oiwnEzPxfkEy18LARH4Rgij2RmlyMXbie+xaVOQJ0WCjYMMSlSe3kjxjfhBiHfgTyhxoPKNUPngQDjIy/FZORqfwz5+ItVbEkGp7/d/hApZbP58FhGtPU3ethEwVVYhU5fbq7d3GPQq98dJ2BMCazaVqTUfCvpCiLBamS1pyDpvIwiHoNTkPGRfH4F00/0f7rNcXN7NbxcriKBBVYetaQJt9AKwuJj9fr3sQZK4+w1fIK+ul6u7+eJ2ddtDri7nP2JeO69D3Mz7p42SOJ3Eo/EoHo8SaNcRyArvQ8ShFhtyw62S1pIbqDxrkjiNUzhg5rVSc6Ok2EEGN+XM8NyRJ83wXInBTWEH0wQisMbxXqZn1ebGMWTTJIKN8fx9dSzbGTbCqKdnryNw5E3tBIUCCsaRqJ3k3aXRTA/cFR5azKWSLGlfZUUB2VeYXa/uLq4+38xg3bZBnrd9S9PJxxr3rwN/lnPhGq9Yl6aTvnfd8ijB/+be+miq33nByvdN1cSxtE0aS3tXGvcNXdEXE9p1d4v+tz7rtVOIgI0i9zQ2w9deliQYMpiZpdhQUavQ7bcURA2jYOCMojj0F6eJyYfmU6FncmHa2cDVzYnrB+nZd27/F8pDoxtYhZpOMu85Lp1kKVBdFIXR/lar3fGEdeiEtS2QackOme53QdbQT6W+/9IF9hPi4YvGBqXCXBFkozAFdjaotniB7TorI9edk6J2jjTP6ion9/TQArIkgoK8dFQcC+lu77P0/sj2grDYQZa07T8BAAD//yoC/PIWCQAA
    objectset.rio.cattle.io/id: ""
    objectset.rio.cattle.io/owner-gvk: /v1, Kind=Service
    objectset.rio.cattle.io/owner-name: traefik
    objectset.rio.cattle.io/owner-namespace: kube-system
  creationTimestamp: "2024-01-08T17:06:48Z"
  generation: 1
  labels:
    objectset.rio.cattle.io/hash: 836fcbce022d5dae5b36694fe1eaf389c93af7dc
    svccontroller.k3s.cattle.io/nodeselector: "false"
    svccontroller.k3s.cattle.io/svcname: traefik
    svccontroller.k3s.cattle.io/svcnamespace: kube-system
  name: svclb-traefik-bf26f129
  namespace: kube-system
  resourceVersion: "615"
  uid: acc5b475-2181-4d70-b320-8de6f12fd45f
spec:
  revisionHistoryLimit: 10
  selector:
    matchLabels:
      app: svclb-traefik-bf26f129
  template:
    metadata:
      creationTimestamp: ~
      labels:
        app: svclb-traefik-bf26f129
        svccontroller.k3s.cattle.io/svcname: traefik
        svccontroller.k3s.cattle.io/svcnamespace: kube-system
    spec:
      automountServiceAccountToken: false
      containers:
      - name: lb-tcp-80
        image: rancher/klipper-lb:v0.4.4
        ports:
        - name: lb-tcp-80
          hostPort: 80
          containerPort: 80
          protocol: TCP
        env:
        - name: SRC_PORT
          value: XXXXXX
        - name: SRC_RANGES
          value: XXXXXX
        - name: DEST_PROTO
          value: XXXXXX
        - name: DEST_PORT
          value: XXXXXX
        - name: DEST_IPS
          value: XXXXXX
        resources: []
        terminationMessagePath: /dev/termination-log
        terminationMessagePolicy: File
        imagePullPolicy: IfNotPresent
        securityContext:
          capabilities:
            add:
            - NET_ADMIN
      - name: lb-tcp-443
        image: rancher/klipper-lb:v0.4.4
        ports:
        - name: lb-tcp-443
          hostPort: 443
          containerPort: 443
          protocol: TCP
        env:
        - name: SRC_PORT
          value: XXXXXX
        - name: SRC_RANGES
          value: XXXXXX
        - name: DEST_PROTO
          value: XXXXXX
        - name: DEST_PORT
          value: XXXXXX
        - name: DEST_IPS
          value: XXXXXX
        resources: []
        terminationMessagePath: /dev/termination-log
        terminationMessagePolicy: File
        imagePullPolicy: IfNotPresent
        securityContext:
          capabilities:
            add:
            - NET_ADMIN
      dnsPolicy: ClusterFirst
      restartPolicy: Always
      schedulerName: default-scheduler
      securityContext:
        sysctls:
        - name: net.ipv4.ip_forward
          value: "1"
      serviceAccount: svclb
      serviceAccountName: svclb
      terminationGracePeriodSeconds: 30
      tolerations:
      - effect: NoSchedule
        key: node-role.kubernetes.io/master
        operator: Exists
      - effect: NoSchedule
        key: node-role.kubernetes.io/control-plane
        operator: Exists
      - key: CriticalAddonsOnly
        operator: Exists
  updateStrategy:
    rollingUpdate:
      maxSurge: 0
      maxUnavailable: 1
    type: RollingUpdate
...
</pre></div></li><li class='expandable detail-hide'>kube-system Deployment local-path-provisioner<div class='details'><pre>---
apiVersion: apps/v1
kind: Deployment
metadata:
  annotations:
    deployment.kubernetes.io/revision: "1"
    objectset.rio.cattle.io/applied: H4sIAAAAAAAA/6xU3W7yRhB9lWqubQMfBCFLvUBJqlZNCEqU3kSoGtZj2LDeXe0Obizkd68Gm/yoIWmlXnl/Zs6emXPGB0Cv/6AQtbOQA3ofB/UIEthpW0AOV+SNayqyDAlUxFggI+QHQGsdI2tno2zd+pkUR+IsaJcpZDaUaTfQAgLJ2Xv3l6WQbuod5LAbx3c39Sj56Xdti5/nReHstxAWK4IcjFNo0sgu4Ib+VVL0qCRzt19TGpvIVEGbgME1mS9L22LcQg6j2bgcX6jpRVmu1Xg4nUyH43IyLkcXs2ExU9MZ/ihwXUwE9ANJj7xNfXC1luZTgO7+DJ/oSQmbQF38r1qKbG50pRnyYQKRDCl2QYIqZLW9ea0AvT//aivgHJBp0xwfcMZou3n0BTJ1YC+PFmvUBteGIB+1CXDjheP9h1g5p8qbU947t5j/wKUvVDnLqC2FCPmTbKsKxZJP59sXGYP4NE2Vs6XeQAIDYjXodv0ne47OwioBsvURuRdleXf152J+e/2wnF9eQwI1mj39ElwlZEpNprin8nW9RBbxTzVmb8q1bbtKQFfivxwCWrWlMPicc14Ps2H2YwJ9wnJvzNIZrRrI4bdy4XgZKHbD9513amf2Fd26veWuY5Use57v2/CG1R2kXSa0KyHug3ZBc3NpMMZFF9e5MLWuoFQFzVqhkXZTqLWiuVLy0uIrfmkfm2IXDAmwMxROP5CnA+xIir7s4Y9DH++saWSIvUSKteH6RUeO0CYHoLIkxZDDwj2oLRV7IwPfwRypBmcokzEKlpiizKyYKjiTeoOW/lfkCiMfdfgEcnVS52RlafstenHTP2Xtvduel6lt278DAAD//8i6p1C4BQAA
    objectset.rio.cattle.io/id: ""
    objectset.rio.cattle.io/owner-gvk: k3s.cattle.io/v1, Kind=Addon
    objectset.rio.cattle.io/owner-name: local-storage
    objectset.rio.cattle.io/owner-namespace: kube-system
  creationTimestamp: "2024-01-08T17:05:58Z"
  generation: 1
  labels:
    objectset.rio.cattle.io/hash: 183f35c65ffbc3064603f43f1580d8c68a2dabd4
  name: local-path-provisioner
  namespace: kube-system
  resourceVersion: "475"
  uid: 718c0dfe-3f1a-4b36-807a-d731f31753f6
spec:
  progressDeadlineSeconds: 600
  replicas: 1
  revisionHistoryLimit: 0
  selector:
    matchLabels:
      app: local-path-provisioner
  strategy:
    rollingUpdate:
      maxSurge: 25%
      maxUnavailable: 1
    type: RollingUpdate
  template:
    metadata:
      creationTimestamp: ~
      labels:
        app: local-path-provisioner
    spec:
      containers:
      - name: local-path-provisioner
        image: rancher/local-path-provisioner:v0.0.24
        command:
        - local-path-provisioner
        - start
        - --config
        - /etc/config/config.json
        env:
        - name: POD_NAMESPACE
          value: XXXXXX
          valueFrom:
            fieldRef:
              apiVersion: v1
              fieldPath: metadata.namespace
        resources: []
        volumeMounts:
        - name: config-volume
          mountPath: /etc/config/
        terminationMessagePath: /dev/termination-log
        terminationMessagePolicy: File
        imagePullPolicy: IfNotPresent
      dnsPolicy: ClusterFirst
      priorityClassName: system-node-critical
      restartPolicy: Always
      schedulerName: default-scheduler
      securityContext: []
      serviceAccount: local-path-provisioner-service-account
      serviceAccountName: local-path-provisioner-service-account
      terminationGracePeriodSeconds: 30
      tolerations:
      - key: CriticalAddonsOnly
        operator: Exists
      - effect: NoSchedule
        key: node-role.kubernetes.io/control-plane
        operator: Exists
      - effect: NoSchedule
        key: node-role.kubernetes.io/master
        operator: Exists
      volumes:
      - configMap:
          defaultMode: 420
          name: local-path-config
        name: config-volume
...
</pre></div></li><li class='expandable detail-hide'>kube-system Job helm-install-traefik<div class='details'><pre>---
apiVersion: batch/v1
kind: Job
metadata:
  annotations:
    batch.kubernetes.io/job-tracking: ""
    objectset.rio.cattle.io/applied: H4sIAAAAAAAA/6xVUY/qNhP9K59Guk9fEgLZbCDSPgQIhd5diAK7alWtkDETcHHsyHZoVyv+e+WQezfb3m5vpb7ZzszxOeM5k1cgFXtCpZkUEMOOGHrsnfvgwImJPcTwo9yBAyUasieGQPwKRAhpiGFSaLuVu1+RGo3GU0x6lBjD0WOyx2z2EXnpUimMkpyjcumRKOMqPDBtVIMBzt8iyN8EKvdwPrVAnU/nvvO/z0zs7+bIy4kF/UccQUqEGIwiWLDTd4XrilCbc6p36OoXbbCEiwNUYUN9w0rUhpQVxKLm3AFOdsiboli6jVbt/Yl5c/pdPI5EHyEG6hejCElEBiEGe6RRfxRGNCLB4KZPgmERYFgQDAvLrNXYVJ0JbQjn7ttFH0jSFVLLe0foSRbFPSuZgbjv+74DBsuKE4P2+wd98IFkKQp2mF/lrOfJILy9C6NJMByPZuPx7ThIg4kfzobRKEgnfhCG09EoDGfRjT9OwptplM4G09HtdBTNhtPb//wBLh35tlMJE6g0xL+8AlEHu4C2lOCA62o0rjaKiQM4cOByR7h3reMUC1Jzk1+b++UOnh1AcW6Q2odZJg8pOHAmvO724sX5GvGU5uvFatk9ytNs1d3P0/uH7TRfPKV5B0sjVWi6cZN5km+29sp1lky6975//PcJnbCjMZWOe71Pr58fx2m+TDfpeptki8unnrYPT6+11L1WhzvoewOv//+6ahb+X0h/Q9wmyX9I/xXL5HEz32bJer2d5Ok0XW4Wyf26k1YQrrGbsFxts3z108+dGE+fqeNRXmuDyuOSEu70fe9m4Pme3+vfNpug3XSxZsni/jFPt9nqfjHpIir80iSXZwdYSQ7NKRH0iKp34qyqULm2FeOz7w29gburGd8P/EHgD/shtDlZzXkmOaMvEMOiWEqTKdQoDLwzNzigUMtaUbTdfnHgLHld4oOshbn2bmmXGTHWc60D3zAa1roR9j6unaRtmLWDvfvybEUJucc1cqRGKmsW+z5KoEHdTE0NMXAm6t+tQ5X1pTJfpazEjDBeKwQHNKozo5hQaq9edkbW26i6ytFd77ScnS+dHr+2qxbh+mu5RrkdczeuLtjhgVQ2R3SjW4Fv4d+S3gwIQ0zdlPryRwAAAP//DrZg0DIHAAA
    objectset.rio.cattle.io/id: helm-controller-chart-registration
    objectset.rio.cattle.io/owner-gvk: helm.cattle.io/v1, Kind=HelmChart
    objectset.rio.cattle.io/owner-name: traefik
    objectset.rio.cattle.io/owner-namespace: kube-system
  creationTimestamp: "2024-01-08T17:06:00Z"
  generation: 1
  labels:
    helmcharts.helm.cattle.io/chart: traefik
    objectset.rio.cattle.io/hash: c0f97ea7a25e3dec71957c7a3241a38f3e5fae5f
  name: helm-install-traefik
  namespace: kube-system
  resourceVersion: "598"
  uid: 2a591629-9af8-4949-b2dd-39bd02b148a4
spec:
  backoffLimit: 1000
  completionMode: NonIndexed
  completions: 1
  parallelism: 1
  selector:
    matchLabels:
      batch.kubernetes.io/controller-uid: 2a591629-9af8-4949-b2dd-39bd02b148a4
  suspend: false
  template:
    metadata:
      annotations:
        helmcharts.helm.cattle.io/configHash: SHA256=57C38B9FBB6B3E3C05F8793EC0355D9955F740BA54D7EF2D96D97F8D678F2B0E
      creationTimestamp: ~
      labels:
        batch.kubernetes.io/controller-uid: 2a591629-9af8-4949-b2dd-39bd02b148a4
        batch.kubernetes.io/job-name: helm-install-traefik
        controller-uid: 2a591629-9af8-4949-b2dd-39bd02b148a4
        helmcharts.helm.cattle.io/chart: traefik
        job-name: helm-install-traefik
    spec:
      containers:
      - name: helm
        image: rancher/klipper-helm:v0.8.2-build20230815
        args:
        - install
        - --set-string
        - global.systemDefaultRegistry=
        env:
        - name: NAME
          value: XXXXXX
        - name: VERSION
          value: XXXXXX
        - name: REPO
          value: XXXXXX
        - name: HELM_DRIVER
          value: XXXXXX
        - name: CHART_NAMESPACE
          value: XXXXXX
        - name: CHART
          value: XXXXXX
        - name: HELM_VERSION
          value: XXXXXX
        - name: TARGET_NAMESPACE
          value: XXXXXX
        - name: AUTH_PASS_CREDENTIALS
          value: XXXXXX
        - name: NO_PROXY
          value: XXXXXX
        - name: FAILURE_POLICY
          value: XXXXXX
        resources: []
        volumeMounts:
        - name: values
          mountPath: /config
        - name: content
          mountPath: /chart
        terminationMessagePath: /dev/termination-log
        terminationMessagePolicy: File
        imagePullPolicy: IfNotPresent
      dnsPolicy: ClusterFirst
      nodeSelector:
        kubernetes.io/os: linux
      restartPolicy: OnFailure
      schedulerName: default-scheduler
      securityContext: []
      serviceAccount: helm-traefik
      serviceAccountName: helm-traefik
      terminationGracePeriodSeconds: 30
      volumes:
      - name: values
        secret:
          defaultMode: 420
          secretName: chart-values-traefik
      - configMap:
          defaultMode: 420
          name: chart-content-traefik
        name: content
...
</pre></div></li><li class='expandable detail-hide'>kube-system Job helm-install-traefik-crd<div class='details'><pre>---
apiVersion: batch/v1
kind: Job
metadata:
  annotations:
    batch.kubernetes.io/job-tracking: ""
    objectset.rio.cattle.io/applied: H4sIAAAAAAAA/7RVUY/iNhD+K9VI99QkJCEsm0j3ELhQ6O0CCuyqVbVCxkzAxbEj26E9If575ZC7hu11e324t9ie7/P3jWcmZyAVe0almRSQwJYYeuidAnDgyMQOEvhZbsGBEg3ZEUMgOQMRQhpimBTaLuX2d6RGo/EUkx4lxnD0mOwxiz4gL10qhVGSc1QuPRBlXIV7po1qOMD5Vwb5h0Dl7k/HlqhzdAqcHz4ysXs/RV6OLel/8ghSIiRgFMGCHV2qdt8E0RWhFnest+jqT9pgCRcHqMJG/pqVqA0pK0hEzbkDnGyRN4mxkhu/2nulvtn9Zi0Hog+QQHRfFP3dgPaDYLjtD8OC7igZ+PEwHhRxEQ79kBT+IA6tutZrk30mtCGcu7eXvWFNV0it/i2hR1kUD6xkBpLA930HDJYVJwbt+Rs18YZ1KQq2n14traZpOLh7n/VH/jiKwvh+Mg7GQRSnk9EkGt/H8d1kFIdROEyzKMiiuygexf1onEbxII6D0fC7PMSlkwJbuYQJVBqS385A1N5+QJtSeHEAxak5ajM+Tx8zcOBEeP262C7Ol6jnLF/NFvPuVp4tF931NHt43HzIZ89Z3uHTSBWabtx4mubrjb12tUzH3btvX/UW0Ak7GFPppNd7d/74NMryebbOVpt0Obu862n7ovSaJN3reHHDwAu94Me6CoN/iP6KuXWa/5T9L5Xp03q6Waar1WacZx+y+XqWPqw6sIJwjV3AfLFZ5otffu3EePpEHY/yWhtUHpeUcCfwvSj0fM/vBXfNot8uulyTdPbwlGeb5eJhNu4yKvz88pcXB1hJ9s0uEfSAqnfkrKpQubbGkpPv3Xuhu60Z34V+2PfvgwG0mGXN+VJyRj9BArNiLs1SoUZh4KZzwQGFWtaKoi3jiwMnyesSH2UtzLUgS/u5JMY2U9taf3M0qnVj7DauHZdtmK1xe/flxZoScocr5EiNVLYD7PsogQZ1MxY1JMCZqP+0radswynzxcpCTAjjtUJwQKM6MYoppfbqeWce3c6hqyXd7aFWt/O52pNz+9WyXP8h1yj3Vec2LVuw/SOpLE50Ea3RW8jX0tBMAENM3aT98lcAAAD//411peIjBwAA
    objectset.rio.cattle.io/id: helm-controller-chart-registration
    objectset.rio.cattle.io/owner-gvk: helm.cattle.io/v1, Kind=HelmChart
    objectset.rio.cattle.io/owner-name: traefik-crd
    objectset.rio.cattle.io/owner-namespace: kube-system
  creationTimestamp: "2024-01-08T17:06:00Z"
  generation: 1
  labels:
    helmcharts.helm.cattle.io/chart: traefik-crd
    objectset.rio.cattle.io/hash: 48ff3d5c3117b372fcdca509795f9f2702af0592
  name: helm-install-traefik-crd
  namespace: kube-system
  resourceVersion: "588"
  uid: 655ceb1b-aaa8-4b24-92ab-fceb2ddd45bd
spec:
  backoffLimit: 1000
  completionMode: NonIndexed
  completions: 1
  parallelism: 1
  selector:
    matchLabels:
      batch.kubernetes.io/controller-uid: 655ceb1b-aaa8-4b24-92ab-fceb2ddd45bd
  suspend: false
  template:
    metadata:
      annotations:
        helmcharts.helm.cattle.io/configHash: SHA256=E3B0C44298FC1C149AFBF4C8996FB92427AE41E4649B934CA495991B7852B855
      creationTimestamp: ~
      labels:
        batch.kubernetes.io/controller-uid: 655ceb1b-aaa8-4b24-92ab-fceb2ddd45bd
        batch.kubernetes.io/job-name: helm-install-traefik-crd
        controller-uid: 655ceb1b-aaa8-4b24-92ab-fceb2ddd45bd
        helmcharts.helm.cattle.io/chart: traefik-crd
        job-name: helm-install-traefik-crd
    spec:
      containers:
      - name: helm
        image: rancher/klipper-helm:v0.8.2-build20230815
        args:
        - install
        env:
        - name: NAME
          value: XXXXXX
        - name: VERSION
          value: XXXXXX
        - name: REPO
          value: XXXXXX
        - name: HELM_DRIVER
          value: XXXXXX
        - name: CHART_NAMESPACE
          value: XXXXXX
        - name: CHART
          value: XXXXXX
        - name: HELM_VERSION
          value: XXXXXX
        - name: TARGET_NAMESPACE
          value: XXXXXX
        - name: AUTH_PASS_CREDENTIALS
          value: XXXXXX
        - name: NO_PROXY
          value: XXXXXX
        - name: FAILURE_POLICY
          value: XXXXXX
        resources: []
        volumeMounts:
        - name: values
          mountPath: /config
        - name: content
          mountPath: /chart
        terminationMessagePath: /dev/termination-log
        terminationMessagePolicy: File
        imagePullPolicy: IfNotPresent
      dnsPolicy: ClusterFirst
      nodeSelector:
        kubernetes.io/os: linux
      restartPolicy: OnFailure
      schedulerName: default-scheduler
      securityContext: []
      serviceAccount: helm-traefik-crd
      serviceAccountName: helm-traefik-crd
      terminationGracePeriodSeconds: 30
      volumes:
      - name: values
        secret:
          defaultMode: 420
          secretName: chart-values-traefik-crd
      - configMap:
          defaultMode: 420
          name: chart-content-traefik-crd
        name: content
...
</pre></div></li></ul></div></div></div><div class='accordion-item'><div class='accordion-header' id='control_25_header'><button class='accordion-button collapsed' type='button' data-bs-toggle='collapse' data-bs-target='#control_25' aria-expanded='false' aria-controls='control_25'><div class='row'><div class='col'><h2 class='fs-4'>C-0185: CIS-5.1.1 Ensure that the cluster-admin role is only used where required</h2><p class='mb-0'> The RBAC role `cluster-admin` provides wide-ranging powers over the environment and should be used only where and when needed.</p></div></div></button></div><div id='control_25' class='accordion-collapse collapse' aria-labelledby='control_25_header' data-bs-parent='#report'><div class='accordion-body'><p>Kubernetes provides a set of default roles where RBAC is used. Some of these roles such as `cluster-admin` provide wide-ranging privileges which should only be applied where absolutely necessary. Roles such as `cluster-admin` allow super-user access to perform any action on any resource. When used in a `ClusterRoleBinding`, it gives full control over every resource in the cluster and in all namespaces. When used in a `RoleBinding`, it gives full control over every resource in the rolebinding's namespace, including the namespace itself.</p><h5>Detection</h5><p>Check which subjects have are bound to the cluster-admin role with a clusterrolebinding.</p><h5>Remediation</h5><p>Identify all clusterrolebindings to the cluster-admin role. Check if they are used and if they need this role or if they could use a role with fewer privileges.

 Where possible, first bind users to a lower privileged role and then remove the clusterrolebinding to the cluster-admin role :

 
```
kubectl delete clusterrolebinding [name]

```</p><h5>Checked paths and expected values</h5><ul><li>relatedObjects[*].roleRef.name</li><li>relatedObjects[*].rules[*].apiGroups[*]</li><li>relatedObjects[*].rules[*].resources[*]</li><li>relatedObjects[*].rules[*].verbs[*]</li><li>relatedObjects[*].subjects[*]</li></ul><h5>References</h5><ul><li><a href='https://workbench.cisecurity.org/sections/1126661/recommendations/1838588'>https://workbench.cisecurity.org/sections/1126661/recommendations/1838588</a></li></ul><h5>Affected resources</h5><ul><li class='expandable detail-hide'>kube-system ServiceAccount helm-traefik<div class='details'><pre>---
kind: ServiceAccount
name: helm-traefik
namespace: kube-system
relatedObjects:
- apiVersion: rbac.authorization.k8s.io/v1
  kind: ClusterRoleBinding
  metadata:
    annotations:
      objectset.rio.cattle.io/applied: H4sIAAAAAAAA/4yRze6TUBDFX8XMGlD+SGhJXGgXmrirxo1xMVyGMnI/yNwBo03f3UBbrYmtLu/H+c2Zc46AI38iiRw81CANmgwn7YPwD1QOPhs2MePwfM4hgYF9CzXs7BSVZB8svWHfsj9AAo4UW1SE+gjofdBVHpdjaL6S0UiaCYfMoKqlhckLrCfrUhO8SrCWJDU9iqZCB44qKwOSu4TwzZOkh3m4gG6e5jx59p59++odWbdboP/keHQENaggdTz81/c4olk0w9RQGr9HJQenBIzQav0jO4qKboTaT9YmYLEh+zCUHmMPNZgX3bYirPCppKIlU+XbsjIVFk8vcyw2XUFlh1R2y7SL7zXJGyPpdZFTAhIs7albyxn5rYRpfFT3X7uGX5PM+TLF1rFf8HE6bwP15+NV+YFkZkOvjQmTV/jT5u+M76b45fQzAAD//6tHuTCdAgAA
      objectset.rio.cattle.io/id: helm-controller-chart-registration
      objectset.rio.cattle.io/owner-gvk: helm.cattle.io/v1, Kind=HelmChart
      objectset.rio.cattle.io/owner-name: traefik
      objectset.rio.cattle.io/owner-namespace: kube-system
    creationTimestamp: "2024-01-08T17:06:00Z"
    labels:
      objectset.rio.cattle.io/hash: c0f97ea7a25e3dec71957c7a3241a38f3e5fae5f
    name: helm-kube-system-traefik
    resourceVersion: "349"
    uid: a815f9db-1d48-4564-a669-936f12c9a7ec
  roleRef:
    apiGroup: rbac.authorization.k8s.io
    kind: ClusterRole
    name: cluster-admin
  subjects:
  - kind: ServiceAccount
    name: helm-traefik
    namespace: kube-system
- apiVersion: rbac.authorization.k8s.io/v1
  kind: ClusterRole
  metadata:
    annotations:
      rbac.authorization.kubernetes.io/autoupdate: "true"
    creationTimestamp: "2024-01-08T17:05:54Z"
    labels:
      kubernetes.io/bootstrapping: rbac-defaults
    name: cluster-admin
    resourceVersion: "72"
    uid: 7a564a7b-9ca4-49ce-8a42-78660cb44f4c
  rules:
  - apiGroups:
    - '*'
    resources:
    - '*'
    verbs:
    - '*'
  - nonResourceURLs:
    - '*'
    verbs:
    - '*'
...
</pre></div></li><li class='expandable detail-hide'>kube-system ServiceAccount helm-traefik-crd<div class='details'><pre>---
kind: ServiceAccount
name: helm-traefik-crd
namespace: kube-system
relatedObjects:
- apiVersion: rbac.authorization.k8s.io/v1
  kind: ClusterRoleBinding
  metadata:
    annotations:
      objectset.rio.cattle.io/applied: H4sIAAAAAAAA/4yRzY7UQAyEXwX5nA7zw2g2kTjAHkDitiAuiIPT7Z6Y9E/kdoJgNO+Okl3QrMQuHLut+lyuOgOO/JmkcE7QgnRoa5y0z8I/UTmnergpNeeX8xYqGDg5aOE2TEVJ7nKgt5wcpxNUEEnRoSK0Z8CUsq7ysjxz942sFtJaONcWVQMtTF5gPYVobE4qOQQSY3sUNUInLiorA6onCfl7IjGneXgAXY3mbfXiAyf3+j2FeLtA/8lJGAlaUEHyPBgr7r8kZUS76IapI1N+FKUIlwqs0Gr/E0cqinGENk0hVBCwo/BsMD2WHlp4deP93h3sfrs9dvvjzltn8bBpjs3BN3533OzQbw7Nbtn24H1N88qIuT7mUoHkQHfk15JGfid5Gp+r/a+dw59t9v7ToIucFnyZ7i+C9sv5t/IjycyW3libp6Tw2OrjrJ9M8+vlVwAAAP//b1bdJakCAAA
      objectset.rio.cattle.io/id: helm-controller-chart-registration
      objectset.rio.cattle.io/owner-gvk: helm.cattle.io/v1, Kind=HelmChart
      objectset.rio.cattle.io/owner-name: traefik-crd
      objectset.rio.cattle.io/owner-namespace: kube-system
    creationTimestamp: "2024-01-08T17:06:00Z"
    labels:
      objectset.rio.cattle.io/hash: 48ff3d5c3117b372fcdca509795f9f2702af0592
    name: helm-kube-system-traefik-crd
    resourceVersion: "348"
    uid: 31be0c7e-dd79-49c6-9a13-77f5f124746c
  roleRef:
    apiGroup: rbac.authorization.k8s.io
    kind: ClusterRole
    name: cluster-admin
  subjects:
  - kind: ServiceAccount
    name: helm-traefik-crd
    namespace: kube-system
- apiVersion: rbac.authorization.k8s.io/v1
  kind: ClusterRole
  metadata:
    annotations:
      rbac.authorization.kubernetes.io/autoupdate: "true"
    creationTimestamp: "2024-01-08T17:05:54Z"
    labels:
      kubernetes.io/bootstrapping: rbac-defaults
    name: cluster-admin
    resourceVersion: "72"
    uid: 7a564a7b-9ca4-49ce-8a42-78660cb44f4c
  rules:
  - apiGroups:
    - '*'
    resources:
    - '*'
    verbs:
    - '*'
  - nonResourceURLs:
    - '*'
    verbs:
    - '*'
...
</pre></div></li></ul></div></div></div><div class='accordion-item'><div class='accordion-header' id='control_26_header'><button class='accordion-button collapsed' type='button' data-bs-toggle='collapse' data-bs-target='#control_26' aria-expanded='false' aria-controls='control_26'><div class='row'><div class='col'><h2 class='fs-4'>C-0186: CIS-5.1.2 Minimize access to secrets</h2><p class='mb-0'> The Kubernetes API stores secrets, which may be service account tokens for the Kubernetes API or credentials used by workloads in the cluster. Access to these secrets should be restricted to the smallest possible group of users to reduce the risk of privilege escalation.</p></div></div></button></div><div id='control_26' class='accordion-collapse collapse' aria-labelledby='control_26_header' data-bs-parent='#report'><div class='accordion-body'><p>Inappropriate access to secrets stored within the Kubernetes cluster can allow for an attacker to gain additional access to the Kubernetes cluster or external resources whose credentials are stored as secrets.</p><h5>Detection</h5><p>Check which subjects have RBAC permissions to get, list or watch Kubernetes secrets.</p><h5>Remediation</h5><p>Where possible, remove `get`, `list` and `watch` access to `secret` objects in the cluster.</p><h5>Checked paths and expected values</h5><ul><li>relatedObjects[*].roleRef.name</li><li>relatedObjects[*].rules[*].apiGroups[*]</li><li>relatedObjects[*].rules[*].resources[*]</li><li>relatedObjects[*].rules[*].verbs[*]</li><li>relatedObjects[*].subjects[*]</li></ul><h5>References</h5><ul><li><a href='https://workbench.cisecurity.org/sections/1126661/recommendations/1838590'>https://workbench.cisecurity.org/sections/1126661/recommendations/1838590</a></li></ul><h5>Affected resources</h5><ul><li class='expandable detail-hide'>kube-system ServiceAccount helm-traefik<div class='details'><pre>---
kind: ServiceAccount
name: helm-traefik
namespace: kube-system
relatedObjects:
- apiVersion: rbac.authorization.k8s.io/v1
  kind: ClusterRoleBinding
  metadata:
    annotations:
      objectset.rio.cattle.io/applied: H4sIAAAAAAAA/4yRze6TUBDFX8XMGlD+SGhJXGgXmrirxo1xMVyGMnI/yNwBo03f3UBbrYmtLu/H+c2Zc46AI38iiRw81CANmgwn7YPwD1QOPhs2MePwfM4hgYF9CzXs7BSVZB8svWHfsj9AAo4UW1SE+gjofdBVHpdjaL6S0UiaCYfMoKqlhckLrCfrUhO8SrCWJDU9iqZCB44qKwOSu4TwzZOkh3m4gG6e5jx59p59++odWbdboP/keHQENaggdTz81/c4olk0w9RQGr9HJQenBIzQav0jO4qKboTaT9YmYLEh+zCUHmMPNZgX3bYirPCppKIlU+XbsjIVFk8vcyw2XUFlh1R2y7SL7zXJGyPpdZFTAhIs7albyxn5rYRpfFT3X7uGX5PM+TLF1rFf8HE6bwP15+NV+YFkZkOvjQmTV/jT5u+M76b45fQzAAD//6tHuTCdAgAA
      objectset.rio.cattle.io/id: helm-controller-chart-registration
      objectset.rio.cattle.io/owner-gvk: helm.cattle.io/v1, Kind=HelmChart
      objectset.rio.cattle.io/owner-name: traefik
      objectset.rio.cattle.io/owner-namespace: kube-system
    creationTimestamp: "2024-01-08T17:06:00Z"
    labels:
      objectset.rio.cattle.io/hash: c0f97ea7a25e3dec71957c7a3241a38f3e5fae5f
    name: helm-kube-system-traefik
    resourceVersion: "349"
    uid: a815f9db-1d48-4564-a669-936f12c9a7ec
  roleRef:
    apiGroup: rbac.authorization.k8s.io
    kind: ClusterRole
    name: cluster-admin
  subjects:
  - kind: ServiceAccount
    name: helm-traefik
    namespace: kube-system
- apiVersion: rbac.authorization.k8s.io/v1
  kind: ClusterRole
  metadata:
    annotations:
      rbac.authorization.kubernetes.io/autoupdate: "true"
    creationTimestamp: "2024-01-08T17:05:54Z"
    labels:
      kubernetes.io/bootstrapping: rbac-defaults
    name: cluster-admin
    resourceVersion: "72"
    uid: 7a564a7b-9ca4-49ce-8a42-78660cb44f4c
  rules:
  - apiGroups:
    - '*'
    resources:
    - '*'
    verbs:
    - '*'
  - nonResourceURLs:
    - '*'
    verbs:
    - '*'
...
</pre></div></li><li class='expandable detail-hide'>kube-system ServiceAccount helm-traefik-crd<div class='details'><pre>---
kind: ServiceAccount
name: helm-traefik-crd
namespace: kube-system
relatedObjects:
- apiVersion: rbac.authorization.k8s.io/v1
  kind: ClusterRoleBinding
  metadata:
    annotations:
      objectset.rio.cattle.io/applied: H4sIAAAAAAAA/4yRzY7UQAyEXwX5nA7zw2g2kTjAHkDitiAuiIPT7Z6Y9E/kdoJgNO+Okl3QrMQuHLut+lyuOgOO/JmkcE7QgnRoa5y0z8I/UTmnergpNeeX8xYqGDg5aOE2TEVJ7nKgt5wcpxNUEEnRoSK0Z8CUsq7ysjxz942sFtJaONcWVQMtTF5gPYVobE4qOQQSY3sUNUInLiorA6onCfl7IjGneXgAXY3mbfXiAyf3+j2FeLtA/8lJGAlaUEHyPBgr7r8kZUS76IapI1N+FKUIlwqs0Gr/E0cqinGENk0hVBCwo/BsMD2WHlp4deP93h3sfrs9dvvjzltn8bBpjs3BN3533OzQbw7Nbtn24H1N88qIuT7mUoHkQHfk15JGfid5Gp+r/a+dw59t9v7ToIucFnyZ7i+C9sv5t/IjycyW3libp6Tw2OrjrJ9M8+vlVwAAAP//b1bdJakCAAA
      objectset.rio.cattle.io/id: helm-controller-chart-registration
      objectset.rio.cattle.io/owner-gvk: helm.cattle.io/v1, Kind=HelmChart
      objectset.rio.cattle.io/owner-name: traefik-crd
      objectset.rio.cattle.io/owner-namespace: kube-system
    creationTimestamp: "2024-01-08T17:06:00Z"
    labels:
      objectset.rio.cattle.io/hash: 48ff3d5c3117b372fcdca509795f9f2702af0592
    name: helm-kube-system-traefik-crd
    resourceVersion: "348"
    uid: 31be0c7e-dd79-49c6-9a13-77f5f124746c
  roleRef:
    apiGroup: rbac.authorization.k8s.io
    kind: ClusterRole
    name: cluster-admin
  subjects:
  - kind: ServiceAccount
    name: helm-traefik-crd
    namespace: kube-system
- apiVersion: rbac.authorization.k8s.io/v1
  kind: ClusterRole
  metadata:
    annotations:
      rbac.authorization.kubernetes.io/autoupdate: "true"
    creationTimestamp: "2024-01-08T17:05:54Z"
    labels:
      kubernetes.io/bootstrapping: rbac-defaults
    name: cluster-admin
    resourceVersion: "72"
    uid: 7a564a7b-9ca4-49ce-8a42-78660cb44f4c
  rules:
  - apiGroups:
    - '*'
    resources:
    - '*'
    verbs:
    - '*'
  - nonResourceURLs:
    - '*'
    verbs:
    - '*'
...
</pre></div></li><li class='expandable detail-hide'>kube-system ServiceAccount traefik<div class='details'><pre>---
kind: ServiceAccount
name: traefik
namespace: kube-system
relatedObjects:
- apiVersion: rbac.authorization.k8s.io/v1
  kind: ClusterRoleBinding
  metadata:
    annotations:
      meta.helm.sh/release-name: traefik
      meta.helm.sh/release-namespace: kube-system
    creationTimestamp: "2024-01-08T17:06:48Z"
    labels:
      app.kubernetes.io/instance: traefik-kube-system
      app.kubernetes.io/managed-by: Helm
      app.kubernetes.io/name: traefik
      helm.sh/chart: traefik-21.2.1_up21.2.0
    name: traefik-kube-system
    resourceVersion: "546"
    uid: 3b79bfea-e538-4ca3-ab2c-6486126d79ed
  roleRef:
    apiGroup: rbac.authorization.k8s.io
    kind: ClusterRole
    name: traefik-kube-system
  subjects:
  - kind: ServiceAccount
    name: traefik
    namespace: kube-system
- apiVersion: rbac.authorization.k8s.io/v1
  kind: ClusterRole
  metadata:
    annotations:
      meta.helm.sh/release-name: traefik
      meta.helm.sh/release-namespace: kube-system
    creationTimestamp: "2024-01-08T17:06:48Z"
    labels:
      app.kubernetes.io/instance: traefik-kube-system
      app.kubernetes.io/managed-by: Helm
      app.kubernetes.io/name: traefik
      helm.sh/chart: traefik-21.2.1_up21.2.0
    name: traefik-kube-system
    resourceVersion: "545"
    uid: 8564701d-a4e1-451e-baa7-2905263b21c5
  rules:
  - apiGroups:
    - extensions
    - networking.k8s.io
    resources:
    - ingressclasses
    - ingresses
    verbs:
    - get
    - list
    - watch
  - apiGroups:
    - ""
    resources:
    - services
    - endpoints
    - secrets
    verbs:
    - get
    - list
    - watch
  - apiGroups:
    - extensions
    - networking.k8s.io
    resources:
    - ingresses/status
    verbs:
    - update
  - apiGroups:
    - traefik.containo.us
    resources:
    - ingressroutes
    - ingressroutetcps
    - ingressrouteudps
    - middlewares
    - middlewaretcps
    - tlsoptions
    - tlsstores
    - traefikservices
    - serverstransports
    verbs:
    - get
    - list
    - watch
...
</pre></div></li></ul></div></div></div><div class='accordion-item'><div class='accordion-header' id='control_27_header'><button class='accordion-button collapsed' type='button' data-bs-toggle='collapse' data-bs-target='#control_27' aria-expanded='false' aria-controls='control_27'><div class='row'><div class='col'><h2 class='fs-4'>C-0187: CIS-5.1.3 Minimize wildcard use in Roles and ClusterRoles</h2><p class='mb-0'> Kubernetes Roles and ClusterRoles provide access to resources based on sets of objects and actions that can be taken on those objects. It is possible to set either of these to be the wildcard "\*" which matches all items.

 Use of wildcards is not optimal from a security perspective as it may allow for inadvertent access to be granted when new resources are added to the Kubernetes API either as CRDs or in later versions of the product.</p></div></div></button></div><div id='control_27' class='accordion-collapse collapse' aria-labelledby='control_27_header' data-bs-parent='#report'><div class='accordion-body'><p>The principle of least privilege recommends that users are provided only the access required for their role and nothing more. The use of wildcard rights grants is likely to provide excessive rights to the Kubernetes API.</p><h5>Detection</h5><p>Check which subjects have wildcard RBAC permissions.</p><h5>Remediation</h5><p>Where possible replace any use of wildcards in clusterroles and roles with specific objects or actions.</p><h5>Checked paths and expected values</h5><ul><li>relatedObjects[*].roleRef.name</li><li>relatedObjects[*].rules[*].apiGroups[*]</li><li>relatedObjects[*].rules[*].resources[*]</li><li>relatedObjects[*].rules[*].verbs[*]</li><li>relatedObjects[*].subjects[*]</li></ul><h5>References</h5><ul><li><a href='https://workbench.cisecurity.org/sections/1126661/recommendations/1838591'>https://workbench.cisecurity.org/sections/1126661/recommendations/1838591</a></li></ul><h5>Affected resources</h5><ul><li class='expandable detail-hide'>kube-system ServiceAccount helm-traefik<div class='details'><pre>---
kind: ServiceAccount
name: helm-traefik
namespace: kube-system
relatedObjects:
- apiVersion: rbac.authorization.k8s.io/v1
  kind: ClusterRoleBinding
  metadata:
    annotations:
      objectset.rio.cattle.io/applied: H4sIAAAAAAAA/4yRze6TUBDFX8XMGlD+SGhJXGgXmrirxo1xMVyGMnI/yNwBo03f3UBbrYmtLu/H+c2Zc46AI38iiRw81CANmgwn7YPwD1QOPhs2MePwfM4hgYF9CzXs7BSVZB8svWHfsj9AAo4UW1SE+gjofdBVHpdjaL6S0UiaCYfMoKqlhckLrCfrUhO8SrCWJDU9iqZCB44qKwOSu4TwzZOkh3m4gG6e5jx59p59++odWbdboP/keHQENaggdTz81/c4olk0w9RQGr9HJQenBIzQav0jO4qKboTaT9YmYLEh+zCUHmMPNZgX3bYirPCppKIlU+XbsjIVFk8vcyw2XUFlh1R2y7SL7zXJGyPpdZFTAhIs7albyxn5rYRpfFT3X7uGX5PM+TLF1rFf8HE6bwP15+NV+YFkZkOvjQmTV/jT5u+M76b45fQzAAD//6tHuTCdAgAA
      objectset.rio.cattle.io/id: helm-controller-chart-registration
      objectset.rio.cattle.io/owner-gvk: helm.cattle.io/v1, Kind=HelmChart
      objectset.rio.cattle.io/owner-name: traefik
      objectset.rio.cattle.io/owner-namespace: kube-system
    creationTimestamp: "2024-01-08T17:06:00Z"
    labels:
      objectset.rio.cattle.io/hash: c0f97ea7a25e3dec71957c7a3241a38f3e5fae5f
    name: helm-kube-system-traefik
    resourceVersion: "349"
    uid: a815f9db-1d48-4564-a669-936f12c9a7ec
  roleRef:
    apiGroup: rbac.authorization.k8s.io
    kind: ClusterRole
    name: cluster-admin
  subjects:
  - kind: ServiceAccount
    name: helm-traefik
    namespace: kube-system
- apiVersion: rbac.authorization.k8s.io/v1
  kind: ClusterRole
  metadata:
    annotations:
      rbac.authorization.kubernetes.io/autoupdate: "true"
    creationTimestamp: "2024-01-08T17:05:54Z"
    labels:
      kubernetes.io/bootstrapping: rbac-defaults
    name: cluster-admin
    resourceVersion: "72"
    uid: 7a564a7b-9ca4-49ce-8a42-78660cb44f4c
  rules:
  - apiGroups:
    - '*'
    resources:
    - '*'
    verbs:
    - '*'
  - nonResourceURLs:
    - '*'
    verbs:
    - '*'
...
</pre></div></li><li class='expandable detail-hide'>kube-system ServiceAccount helm-traefik-crd<div class='details'><pre>---
kind: ServiceAccount
name: helm-traefik-crd
namespace: kube-system
relatedObjects:
- apiVersion: rbac.authorization.k8s.io/v1
  kind: ClusterRoleBinding
  metadata:
    annotations:
      objectset.rio.cattle.io/applied: H4sIAAAAAAAA/4yRzY7UQAyEXwX5nA7zw2g2kTjAHkDitiAuiIPT7Z6Y9E/kdoJgNO+Okl3QrMQuHLut+lyuOgOO/JmkcE7QgnRoa5y0z8I/UTmnergpNeeX8xYqGDg5aOE2TEVJ7nKgt5wcpxNUEEnRoSK0Z8CUsq7ysjxz942sFtJaONcWVQMtTF5gPYVobE4qOQQSY3sUNUInLiorA6onCfl7IjGneXgAXY3mbfXiAyf3+j2FeLtA/8lJGAlaUEHyPBgr7r8kZUS76IapI1N+FKUIlwqs0Gr/E0cqinGENk0hVBCwo/BsMD2WHlp4deP93h3sfrs9dvvjzltn8bBpjs3BN3533OzQbw7Nbtn24H1N88qIuT7mUoHkQHfk15JGfid5Gp+r/a+dw59t9v7ToIucFnyZ7i+C9sv5t/IjycyW3libp6Tw2OrjrJ9M8+vlVwAAAP//b1bdJakCAAA
      objectset.rio.cattle.io/id: helm-controller-chart-registration
      objectset.rio.cattle.io/owner-gvk: helm.cattle.io/v1, Kind=HelmChart
      objectset.rio.cattle.io/owner-name: traefik-crd
      objectset.rio.cattle.io/owner-namespace: kube-system
    creationTimestamp: "2024-01-08T17:06:00Z"
    labels:
      objectset.rio.cattle.io/hash: 48ff3d5c3117b372fcdca509795f9f2702af0592
    name: helm-kube-system-traefik-crd
    resourceVersion: "348"
    uid: 31be0c7e-dd79-49c6-9a13-77f5f124746c
  roleRef:
    apiGroup: rbac.authorization.k8s.io
    kind: ClusterRole
    name: cluster-admin
  subjects:
  - kind: ServiceAccount
    name: helm-traefik-crd
    namespace: kube-system
- apiVersion: rbac.authorization.k8s.io/v1
  kind: ClusterRole
  metadata:
    annotations:
      rbac.authorization.kubernetes.io/autoupdate: "true"
    creationTimestamp: "2024-01-08T17:05:54Z"
    labels:
      kubernetes.io/bootstrapping: rbac-defaults
    name: cluster-admin
    resourceVersion: "72"
    uid: 7a564a7b-9ca4-49ce-8a42-78660cb44f4c
  rules:
  - apiGroups:
    - '*'
    resources:
    - '*'
    verbs:
    - '*'
  - nonResourceURLs:
    - '*'
    verbs:
    - '*'
...
</pre></div></li></ul></div></div></div><div class='accordion-item'><div class='accordion-header' id='control_28_header'><button class='accordion-button collapsed' type='button' data-bs-toggle='collapse' data-bs-target='#control_28' aria-expanded='false' aria-controls='control_28'><div class='row'><div class='col'><h2 class='fs-4'>C-0188: CIS-5.1.4 Minimize access to create pods</h2><p class='mb-0'> The ability to create pods in a namespace can provide a number of opportunities for privilege escalation, such as assigning privileged service accounts to these pods or mounting hostPaths with access to sensitive data (unless Pod Security Policies are implemented to restrict this access)

 As such, access to create new pods should be restricted to the smallest possible group of users.</p></div></div></button></div><div id='control_28' class='accordion-collapse collapse' aria-labelledby='control_28_header' data-bs-parent='#report'><div class='accordion-body'><p>The ability to create pods in a cluster opens up possibilities for privilege escalation and should be restricted, where possible.</p><h5>Detection</h5><p>Check which subjects have RBAC permissions to create pods.</p><h5>Remediation</h5><p>Where possible, remove `create` access to `pod` objects in the cluster.</p><h5>Checked paths and expected values</h5><ul><li>relatedObjects[*].roleRef.name</li><li>relatedObjects[*].rules[*].apiGroups[*]</li><li>relatedObjects[*].rules[*].resources[*]</li><li>relatedObjects[*].rules[*].verbs[*]</li><li>relatedObjects[*].subjects[*]</li></ul><h5>References</h5><ul><li><a href='https://workbench.cisecurity.org/sections/1126661/recommendations/1838592'>https://workbench.cisecurity.org/sections/1126661/recommendations/1838592</a></li></ul><h5>Affected resources</h5><ul><li class='expandable detail-hide'>kube-system ServiceAccount helm-traefik<div class='details'><pre>---
kind: ServiceAccount
name: helm-traefik
namespace: kube-system
relatedObjects:
- apiVersion: rbac.authorization.k8s.io/v1
  kind: ClusterRoleBinding
  metadata:
    annotations:
      objectset.rio.cattle.io/applied: H4sIAAAAAAAA/4yRze6TUBDFX8XMGlD+SGhJXGgXmrirxo1xMVyGMnI/yNwBo03f3UBbrYmtLu/H+c2Zc46AI38iiRw81CANmgwn7YPwD1QOPhs2MePwfM4hgYF9CzXs7BSVZB8svWHfsj9AAo4UW1SE+gjofdBVHpdjaL6S0UiaCYfMoKqlhckLrCfrUhO8SrCWJDU9iqZCB44qKwOSu4TwzZOkh3m4gG6e5jx59p59++odWbdboP/keHQENaggdTz81/c4olk0w9RQGr9HJQenBIzQav0jO4qKboTaT9YmYLEh+zCUHmMPNZgX3bYirPCppKIlU+XbsjIVFk8vcyw2XUFlh1R2y7SL7zXJGyPpdZFTAhIs7albyxn5rYRpfFT3X7uGX5PM+TLF1rFf8HE6bwP15+NV+YFkZkOvjQmTV/jT5u+M76b45fQzAAD//6tHuTCdAgAA
      objectset.rio.cattle.io/id: helm-controller-chart-registration
      objectset.rio.cattle.io/owner-gvk: helm.cattle.io/v1, Kind=HelmChart
      objectset.rio.cattle.io/owner-name: traefik
      objectset.rio.cattle.io/owner-namespace: kube-system
    creationTimestamp: "2024-01-08T17:06:00Z"
    labels:
      objectset.rio.cattle.io/hash: c0f97ea7a25e3dec71957c7a3241a38f3e5fae5f
    name: helm-kube-system-traefik
    resourceVersion: "349"
    uid: a815f9db-1d48-4564-a669-936f12c9a7ec
  roleRef:
    apiGroup: rbac.authorization.k8s.io
    kind: ClusterRole
    name: cluster-admin
  subjects:
  - kind: ServiceAccount
    name: helm-traefik
    namespace: kube-system
- apiVersion: rbac.authorization.k8s.io/v1
  kind: ClusterRole
  metadata:
    annotations:
      rbac.authorization.kubernetes.io/autoupdate: "true"
    creationTimestamp: "2024-01-08T17:05:54Z"
    labels:
      kubernetes.io/bootstrapping: rbac-defaults
    name: cluster-admin
    resourceVersion: "72"
    uid: 7a564a7b-9ca4-49ce-8a42-78660cb44f4c
  rules:
  - apiGroups:
    - '*'
    resources:
    - '*'
    verbs:
    - '*'
  - nonResourceURLs:
    - '*'
    verbs:
    - '*'
...
</pre></div></li><li class='expandable detail-hide'>kube-system ServiceAccount helm-traefik-crd<div class='details'><pre>---
kind: ServiceAccount
name: helm-traefik-crd
namespace: kube-system
relatedObjects:
- apiVersion: rbac.authorization.k8s.io/v1
  kind: ClusterRoleBinding
  metadata:
    annotations:
      objectset.rio.cattle.io/applied: H4sIAAAAAAAA/4yRzY7UQAyEXwX5nA7zw2g2kTjAHkDitiAuiIPT7Z6Y9E/kdoJgNO+Okl3QrMQuHLut+lyuOgOO/JmkcE7QgnRoa5y0z8I/UTmnergpNeeX8xYqGDg5aOE2TEVJ7nKgt5wcpxNUEEnRoSK0Z8CUsq7ysjxz942sFtJaONcWVQMtTF5gPYVobE4qOQQSY3sUNUInLiorA6onCfl7IjGneXgAXY3mbfXiAyf3+j2FeLtA/8lJGAlaUEHyPBgr7r8kZUS76IapI1N+FKUIlwqs0Gr/E0cqinGENk0hVBCwo/BsMD2WHlp4deP93h3sfrs9dvvjzltn8bBpjs3BN3533OzQbw7Nbtn24H1N88qIuT7mUoHkQHfk15JGfid5Gp+r/a+dw59t9v7ToIucFnyZ7i+C9sv5t/IjycyW3libp6Tw2OrjrJ9M8+vlVwAAAP//b1bdJakCAAA
      objectset.rio.cattle.io/id: helm-controller-chart-registration
      objectset.rio.cattle.io/owner-gvk: helm.cattle.io/v1, Kind=HelmChart
      objectset.rio.cattle.io/owner-name: traefik-crd
      objectset.rio.cattle.io/owner-namespace: kube-system
    creationTimestamp: "2024-01-08T17:06:00Z"
    labels:
      objectset.rio.cattle.io/hash: 48ff3d5c3117b372fcdca509795f9f2702af0592
    name: helm-kube-system-traefik-crd
    resourceVersion: "348"
    uid: 31be0c7e-dd79-49c6-9a13-77f5f124746c
  roleRef:
    apiGroup: rbac.authorization.k8s.io
    kind: ClusterRole
    name: cluster-admin
  subjects:
  - kind: ServiceAccount
    name: helm-traefik-crd
    namespace: kube-system
- apiVersion: rbac.authorization.k8s.io/v1
  kind: ClusterRole
  metadata:
    annotations:
      rbac.authorization.kubernetes.io/autoupdate: "true"
    creationTimestamp: "2024-01-08T17:05:54Z"
    labels:
      kubernetes.io/bootstrapping: rbac-defaults
    name: cluster-admin
    resourceVersion: "72"
    uid: 7a564a7b-9ca4-49ce-8a42-78660cb44f4c
  rules:
  - apiGroups:
    - '*'
    resources:
    - '*'
    verbs:
    - '*'
  - nonResourceURLs:
    - '*'
    verbs:
    - '*'
...
</pre></div></li><li class='expandable detail-hide'>kube-system ServiceAccount local-path-provisioner-service-account<div class='details'><pre>---
kind: ServiceAccount
name: local-path-provisioner-service-account
namespace: kube-system
relatedObjects:
- apiVersion: rbac.authorization.k8s.io/v1
  kind: ClusterRoleBinding
  metadata:
    annotations:
      objectset.rio.cattle.io/applied: H4sIAAAAAAAA/4yRQWvjMBCF/8oyZ9sbrxNjDHvI7qGH3lLopfQwksaxakVjpLFLG/LfixIKDaRJj2LmfU/z3h5wtI8UomUPLQSFusBJeg72HcWyL4YmFpZ/zyVkMFhvoIX/bopCYcOO/llvrN9CBjsSNCgI7R7Qe5ajPKYnqxfSEkmKYLnQKOIoMW2CQfbtnF89hXw7D9DCUMUvk7nMft1bb/6ujWF/E+FxR9CCY40uj8IBt/QjURxRJ+UwKcrjWxTawSEDh4rc1dN6jD20UDZVV610veo6patFvawXVbesunLVLEyj6wb/GFRmmaBnnxxR+nwMPNvUDIVcpegPGQR2tKHumPJo7wJP47XeLpYGt8ySSTKL0+k8aJ/2n5wHCrPVtNaaJy83UfG0nuPZ/sVcnw8fAQAA//9f/s3AjgIAAA
      objectset.rio.cattle.io/id: ""
      objectset.rio.cattle.io/owner-gvk: k3s.cattle.io/v1, Kind=Addon
      objectset.rio.cattle.io/owner-name: local-storage
      objectset.rio.cattle.io/owner-namespace: kube-system
    creationTimestamp: "2024-01-08T17:05:58Z"
    labels:
      objectset.rio.cattle.io/hash: 183f35c65ffbc3064603f43f1580d8c68a2dabd4
    name: local-path-provisioner-bind
    resourceVersion: "270"
    uid: 3847ebc1-fd46-4406-a419-a9d5884f731f
  roleRef:
    apiGroup: rbac.authorization.k8s.io
    kind: ClusterRole
    name: local-path-provisioner-role
  subjects:
  - kind: ServiceAccount
    name: local-path-provisioner-service-account
    namespace: kube-system
- apiVersion: rbac.authorization.k8s.io/v1
  kind: ClusterRole
  metadata:
    annotations:
      objectset.rio.cattle.io/applied: H4sIAAAAAAAA/4ySMY/bMAyF/0rBsZDdpE4Cw0CHokOHbh26FBloiY5Vy6Ig0j60h/z3QkaGO7R3l0mgHt5HUk+PgMn/oCyeI3SQe7Q1Ljpy9n9QPcd6aqX2/GHdg4HJRwcdfAmLKOXvHAgMzKToUBG6R8AYWTeflJL7X2RVSOvsubaoGqjAfKGAeVHnh0i5uqwTdDA18kRZ9+bdNx/dp8/OcXwTEXEm6CCwxVCJcsYL3WWShLY4p6WnSn6L0gxXAwF7Cq+uNqKM0MG+bYbmaE/HYehtszsdTrtmODTD/tjuXGtPLX502LtDgT4bMqGOVcq8+hIJ5SqXV74ayEsgge7nltjXzEsqFcDZQCbhJdtNhsiOBAykEqooRV05LDPZgH4uguU4+MuMSYp3pdxvvgspGAheyvGAakc4X81b3Si6xD7q/zpud+yet3l/F3Wlgnzqs5lQS3bphdFu6d7+6z/Im2wDitAdm5+vfwMAAP//OqHYBhsDAAA
      objectset.rio.cattle.io/id: ""
      objectset.rio.cattle.io/owner-gvk: k3s.cattle.io/v1, Kind=Addon
      objectset.rio.cattle.io/owner-name: local-storage
      objectset.rio.cattle.io/owner-namespace: kube-system
    creationTimestamp: "2024-01-08T17:05:58Z"
    labels:
      objectset.rio.cattle.io/hash: 183f35c65ffbc3064603f43f1580d8c68a2dabd4
    name: local-path-provisioner-role
    resourceVersion: "269"
    uid: 893c5c72-e93d-40cc-81b5-1779e96a6a92
  rules:
  - apiGroups:
    - ""
    resources:
    - nodes
    - persistentvolumeclaims
    - configmaps
    verbs:
    - get
    - list
    - watch
  - apiGroups:
    - ""
    resources:
    - endpoints
    - persistentvolumes
    - pods
    verbs:
    - '*'
  - apiGroups:
    - ""
    resources:
    - events
    verbs:
    - create
    - patch
  - apiGroups:
    - storage.k8s.io
    resources:
    - storageclasses
    verbs:
    - get
    - list
    - watch
...
</pre></div></li></ul></div></div></div><div class='accordion-item'><div class='accordion-header' id='control_29_header'><button class='accordion-button collapsed' type='button' data-bs-toggle='collapse' data-bs-target='#control_29' aria-expanded='false' aria-controls='control_29'><div class='row'><div class='col'><h2 class='fs-4'>C-0190: CIS-5.1.6 Ensure that Service Account Tokens are only mounted where necessary</h2><p class='mb-0'> Service accounts tokens should not be mounted in pods except where the workload running in the pod explicitly needs to communicate with the API server</p></div></div></button></div><div id='control_29' class='accordion-collapse collapse' aria-labelledby='control_29_header' data-bs-parent='#report'><div class='accordion-body'><p>Mounting service account tokens inside pods can provide an avenue for privilege escalation attacks where an attacker is able to compromise a single pod in the cluster.

 Avoiding mounting these tokens removes this attack avenue.</p><h5>Detection</h5><p>Check that all service accounts and workloads disable automount of service account tokens.</p><h5>Remediation</h5><p>Modify the definition of pods and service accounts which do not need to mount service account tokens to disable it.</p><h5>Checked paths and expected values</h5><ul><li>automountServiceAccountToken</li><li>automountServiceAccountToken = false</li></ul><h5>References</h5><ul><li><a href='https://workbench.cisecurity.org/sections/1126661/recommendations/1838595'>https://workbench.cisecurity.org/sections/1126661/recommendations/1838595</a></li></ul><h5>Affected resources</h5><ul><li class='expandable detail-hide'>kube-system ServiceAccount helm-traefik<div class='details'><pre>---
apiVersion: v1
automountServiceAccountToken: true
kind: ServiceAccount
metadata:
  annotations:
    objectset.rio.cattle.io/applied: H4sIAAAAAAAA/4yQzUrDQBSFX0XuelJNY4gdcCFuBJcW97eTk2bM/JSZm4iUvrskFNRF1eVhznz34xyJD/YVKdsYSNNUkiIeJfo4BnlBmqzBgzFz2sYBgbSkEYoGG1rS9LNBijyEWxYmfSQOIQqLjSHPMe7eYCRDVsnGlWERh5WN13YG9XC+MDFIis4hFabnJEXC3mZJC4PURUJ8D0jFfhrOoG9PU6munm1o75/g/OMM/ZMT2IM0SWJ0dvhXPR/YzH+GcYcif2SBp5Mik7Cob61HFvYH0mF0TpHjHdyvo/Sce9JkbrpNA254XaNqYZpyUzem4Wp9W3J111WoO0bdzdfO3suSX/IX9U6fAQAA//8OYeye+wEAAA
    objectset.rio.cattle.io/id: helm-controller-chart-registration
    objectset.rio.cattle.io/owner-gvk: helm.cattle.io/v1, Kind=HelmChart
    objectset.rio.cattle.io/owner-name: traefik
    objectset.rio.cattle.io/owner-namespace: kube-system
  creationTimestamp: "2024-01-08T17:06:00Z"
  labels:
    objectset.rio.cattle.io/hash: c0f97ea7a25e3dec71957c7a3241a38f3e5fae5f
  name: helm-traefik
  namespace: kube-system
  resourceVersion: "347"
  uid: d927443d-b78a-4508-a7db-7d9ddfe57f62
...
</pre></div></li><li class='expandable detail-hide'>kube-system ServiceAccount helm-traefik-crd<div class='details'><pre>---
apiVersion: v1
automountServiceAccountToken: true
kind: ServiceAccount
metadata:
  annotations:
    objectset.rio.cattle.io/applied: H4sIAAAAAAAA/4yQz07zQAzEX+WTz5t+TUoUshIHxAWJIxV3Z+NtluyfyusEoarvjhL1QA8FjiN7fh7PCfDo3oizSxE0zCUowElSSFOUV+LZGXo0ZlH7NFIELTyRgtHFHjRcb4CCQII9CoI+AcaYBMWlmBeZuncykkk27NLGoIinjUv/3QIayIfCpCicvCcuzIAsBdPBZeGVAeomIX1E4uIwjxfQt9Fcqn8vLvYPz+TD0wL9lRMxEGgQRrJuLAz3f7LkI5rFN04dFfkzCwU4KzBMa/y9C5QFwxF0nLxX4LEj/2MxA+YBNNzdW7vra7Mry6bbNZU1vcF62zZtbVtbNdsK7bZuq+XaJfva5vUDNyOevwIAAP//D+VkGwMCAAA
    objectset.rio.cattle.io/id: helm-controller-chart-registration
    objectset.rio.cattle.io/owner-gvk: helm.cattle.io/v1, Kind=HelmChart
    objectset.rio.cattle.io/owner-name: traefik-crd
    objectset.rio.cattle.io/owner-namespace: kube-system
  creationTimestamp: "2024-01-08T17:06:00Z"
  labels:
    objectset.rio.cattle.io/hash: 48ff3d5c3117b372fcdca509795f9f2702af0592
  name: helm-traefik-crd
  namespace: kube-system
  resourceVersion: "346"
  uid: 8b5adf3c-86f1-4eb5-b368-424a083d7fdf
...
</pre></div></li><li class='expandable detail-hide'>kube-system ServiceAccount local-path-provisioner-service-account<div class='details'><pre>---
apiVersion: v1
kind: ServiceAccount
metadata:
  annotations:
    objectset.rio.cattle.io/applied: H4sIAAAAAAAA/4yQQUvEMBCF/4rMuVlb05YS8LBnj4L3aTLdxraZkpmtyLL/XYogelj1ODzex5vvArjGF8oSOYGDrYICppgCOHimvEVPR+/5nBQKWEgxoCK4C2BKrKiRk+wn96/kVUgPOfLBo+pMh8j3cQdBcTPnt0TZnLYJHExWviVbVdw9xRQejyFw+hORcCFwMLPH2YhyxhP9qyQr+r05nXsy8i5KC1wLmLGn+dfXRpQRHFSdHWzj22YYem/Ltm5LO9R2qJquDJ1vO3wI2Id6h/4YuaKOZs28xd09ZSOfvg1+Cb+57/oRAAD///h+7Ma3AQAA
    objectset.rio.cattle.io/id: ""
    objectset.rio.cattle.io/owner-gvk: k3s.cattle.io/v1, Kind=Addon
    objectset.rio.cattle.io/owner-name: local-storage
    objectset.rio.cattle.io/owner-namespace: kube-system
  creationTimestamp: "2024-01-08T17:05:58Z"
  labels:
    objectset.rio.cattle.io/hash: 183f35c65ffbc3064603f43f1580d8c68a2dabd4
  name: local-path-provisioner-service-account
  namespace: kube-system
  resourceVersion: "268"
  uid: 3a0117f5-0601-4b4b-818c-71263aeed29c
...
</pre></div></li><li class='expandable detail-hide'>kube-system ServiceAccount svclb<div class='details'><pre>---
apiVersion: v1
kind: ServiceAccount
metadata:
  creationTimestamp: "2024-01-08T17:05:59Z"
  name: svclb
  namespace: kube-system
  resourceVersion: "307"
  uid: 91b3fe63-0ab5-4d42-bc9b-8888ac1763bf
...
</pre></div></li><li class='expandable detail-hide'>kube-system ServiceAccount traefik<div class='details'><pre>---
apiVersion: v1
kind: ServiceAccount
metadata:
  annotations:
    meta.helm.sh/release-name: traefik
    meta.helm.sh/release-namespace: kube-system
  creationTimestamp: "2024-01-08T17:06:48Z"
  labels:
    app.kubernetes.io/instance: traefik-kube-system
    app.kubernetes.io/managed-by: Helm
    app.kubernetes.io/name: traefik
    helm.sh/chart: traefik-21.2.1_up21.2.0
  name: traefik
  namespace: kube-system
  resourceVersion: "544"
  uid: b460680a-d16c-4973-9d2a-9b9648431fad
...
</pre></div></li></ul></div></div></div><div class='accordion-item'><div class='accordion-header' id='control_30_header'><button class='accordion-button collapsed' type='button' data-bs-toggle='collapse' data-bs-target='#control_30' aria-expanded='false' aria-controls='control_30'><div class='row'><div class='col'><h2 class='fs-4'>C-0191: CIS-5.1.8 Limit use of the Bind, Impersonate and Escalate permissions in the Kubernetes cluster</h2><p class='mb-0'> Cluster roles and roles with the impersonate, bind or escalate permissions should not be granted unless strictly required. Each of these permissions allow a particular subject to escalate their privileges beyond those explicitly granted by cluster administrators</p></div></div></button></div><div id='control_30' class='accordion-collapse collapse' aria-labelledby='control_30_header' data-bs-parent='#report'><div class='accordion-body'><p>The impersonate privilege allows a subject to impersonate other users gaining their rights to the cluster. The bind privilege allows the subject to add a binding to a cluster role or role which escalates their effective permissions in the cluster. The escalate privilege allows a subject to modify cluster roles to which they are bound, increasing their rights to that level.

 Each of these permissions has the potential to allow for privilege escalation to cluster-admin level.</p><h5>Remediation</h5><p>Where possible, remove the impersonate, bind and escalate rights from subjects.</p><h5>Checked paths and expected values</h5><ul><li>relatedObjects[*].roleRef.name</li><li>relatedObjects[*].rules[*].apiGroups[*]</li><li>relatedObjects[*].rules[*].resources[*]</li><li>relatedObjects[*].rules[*].verbs[*]</li><li>relatedObjects[*].subjects[*]</li></ul><h5>References</h5><ul><li><a href='https://workbench.cisecurity.org/sections/1126661/recommendations/1838597'>https://workbench.cisecurity.org/sections/1126661/recommendations/1838597</a></li></ul><h5>Affected resources</h5><ul><li class='expandable detail-hide'>kube-system ServiceAccount helm-traefik<div class='details'><pre>---
kind: ServiceAccount
name: helm-traefik
namespace: kube-system
relatedObjects:
- apiVersion: rbac.authorization.k8s.io/v1
  kind: ClusterRoleBinding
  metadata:
    annotations:
      objectset.rio.cattle.io/applied: H4sIAAAAAAAA/4yRze6TUBDFX8XMGlD+SGhJXGgXmrirxo1xMVyGMnI/yNwBo03f3UBbrYmtLu/H+c2Zc46AI38iiRw81CANmgwn7YPwD1QOPhs2MePwfM4hgYF9CzXs7BSVZB8svWHfsj9AAo4UW1SE+gjofdBVHpdjaL6S0UiaCYfMoKqlhckLrCfrUhO8SrCWJDU9iqZCB44qKwOSu4TwzZOkh3m4gG6e5jx59p59++odWbdboP/keHQENaggdTz81/c4olk0w9RQGr9HJQenBIzQav0jO4qKboTaT9YmYLEh+zCUHmMPNZgX3bYirPCppKIlU+XbsjIVFk8vcyw2XUFlh1R2y7SL7zXJGyPpdZFTAhIs7albyxn5rYRpfFT3X7uGX5PM+TLF1rFf8HE6bwP15+NV+YFkZkOvjQmTV/jT5u+M76b45fQzAAD//6tHuTCdAgAA
      objectset.rio.cattle.io/id: helm-controller-chart-registration
      objectset.rio.cattle.io/owner-gvk: helm.cattle.io/v1, Kind=HelmChart
      objectset.rio.cattle.io/owner-name: traefik
      objectset.rio.cattle.io/owner-namespace: kube-system
    creationTimestamp: "2024-01-08T17:06:00Z"
    labels:
      objectset.rio.cattle.io/hash: c0f97ea7a25e3dec71957c7a3241a38f3e5fae5f
    name: helm-kube-system-traefik
    resourceVersion: "349"
    uid: a815f9db-1d48-4564-a669-936f12c9a7ec
  roleRef:
    apiGroup: rbac.authorization.k8s.io
    kind: ClusterRole
    name: cluster-admin
  subjects:
  - kind: ServiceAccount
    name: helm-traefik
    namespace: kube-system
- apiVersion: rbac.authorization.k8s.io/v1
  kind: ClusterRole
  metadata:
    annotations:
      rbac.authorization.kubernetes.io/autoupdate: "true"
    creationTimestamp: "2024-01-08T17:05:54Z"
    labels:
      kubernetes.io/bootstrapping: rbac-defaults
    name: cluster-admin
    resourceVersion: "72"
    uid: 7a564a7b-9ca4-49ce-8a42-78660cb44f4c
  rules:
  - apiGroups:
    - '*'
    resources:
    - '*'
    verbs:
    - '*'
  - nonResourceURLs:
    - '*'
    verbs:
    - '*'
...
</pre></div></li><li class='expandable detail-hide'>kube-system ServiceAccount helm-traefik-crd<div class='details'><pre>---
kind: ServiceAccount
name: helm-traefik-crd
namespace: kube-system
relatedObjects:
- apiVersion: rbac.authorization.k8s.io/v1
  kind: ClusterRoleBinding
  metadata:
    annotations:
      objectset.rio.cattle.io/applied: H4sIAAAAAAAA/4yRzY7UQAyEXwX5nA7zw2g2kTjAHkDitiAuiIPT7Z6Y9E/kdoJgNO+Okl3QrMQuHLut+lyuOgOO/JmkcE7QgnRoa5y0z8I/UTmnergpNeeX8xYqGDg5aOE2TEVJ7nKgt5wcpxNUEEnRoSK0Z8CUsq7ysjxz942sFtJaONcWVQMtTF5gPYVobE4qOQQSY3sUNUInLiorA6onCfl7IjGneXgAXY3mbfXiAyf3+j2FeLtA/8lJGAlaUEHyPBgr7r8kZUS76IapI1N+FKUIlwqs0Gr/E0cqinGENk0hVBCwo/BsMD2WHlp4deP93h3sfrs9dvvjzltn8bBpjs3BN3533OzQbw7Nbtn24H1N88qIuT7mUoHkQHfk15JGfid5Gp+r/a+dw59t9v7ToIucFnyZ7i+C9sv5t/IjycyW3libp6Tw2OrjrJ9M8+vlVwAAAP//b1bdJakCAAA
      objectset.rio.cattle.io/id: helm-controller-chart-registration
      objectset.rio.cattle.io/owner-gvk: helm.cattle.io/v1, Kind=HelmChart
      objectset.rio.cattle.io/owner-name: traefik-crd
      objectset.rio.cattle.io/owner-namespace: kube-system
    creationTimestamp: "2024-01-08T17:06:00Z"
    labels:
      objectset.rio.cattle.io/hash: 48ff3d5c3117b372fcdca509795f9f2702af0592
    name: helm-kube-system-traefik-crd
    resourceVersion: "348"
    uid: 31be0c7e-dd79-49c6-9a13-77f5f124746c
  roleRef:
    apiGroup: rbac.authorization.k8s.io
    kind: ClusterRole
    name: cluster-admin
  subjects:
  - kind: ServiceAccount
    name: helm-traefik-crd
    namespace: kube-system
- apiVersion: rbac.authorization.k8s.io/v1
  kind: ClusterRole
  metadata:
    annotations:
      rbac.authorization.kubernetes.io/autoupdate: "true"
    creationTimestamp: "2024-01-08T17:05:54Z"
    labels:
      kubernetes.io/bootstrapping: rbac-defaults
    name: cluster-admin
    resourceVersion: "72"
    uid: 7a564a7b-9ca4-49ce-8a42-78660cb44f4c
  rules:
  - apiGroups:
    - '*'
    resources:
    - '*'
    verbs:
    - '*'
  - nonResourceURLs:
    - '*'
    verbs:
    - '*'
...
</pre></div></li></ul></div></div></div><div class='accordion-item'><div class='accordion-header' id='control_31_header'><button class='accordion-button collapsed' type='button' data-bs-toggle='collapse' data-bs-target='#control_31' aria-expanded='false' aria-controls='control_31'><div class='row'><div class='col'><h2 class='fs-4'>C-0210: CIS-5.7.2 Ensure that the seccomp profile is set to docker/default in your pod definitions</h2><p class='mb-0'> Enable `docker/default` seccomp profile in your pod definitions.</p></div></div></button></div><div id='control_31' class='accordion-collapse collapse' aria-labelledby='control_31_header' data-bs-parent='#report'><div class='accordion-body'><p>Seccomp (secure computing mode) is used to restrict the set of system calls applications can make, allowing cluster administrators greater control over the security of workloads running in the cluster. Kubernetes disables seccomp profiles by default for historical reasons. You should enable it to ensure that the workloads have restricted actions available within the container.</p><h5>Detection</h5><p>Checks if seccomp profile is defined as type RuntimeDefault in security context of workload or container level</p><h5>Remediation</h5><p>Use security context to enable the `docker/default` seccomp profile in your pod definitions. An example is as below:

 
```
  securityContext:
    seccompProfile:
      type: RuntimeDefault

```</p><h5>Checked paths and expected values</h5><ul><li>spec.template.spec.containers[*].securityContext.seccompProfile.type = RuntimeDefault</li></ul><h5>References</h5><ul><li><a href='https://workbench.cisecurity.org/sections/1126667/recommendations/1838635'>https://workbench.cisecurity.org/sections/1126667/recommendations/1838635</a></li></ul><h5>Affected resources</h5><ul><li class='expandable detail-hide'>kube-system DaemonSet svclb-traefik-bf26f129<div class='details'><pre>---
apiVersion: apps/v1
kind: DaemonSet
metadata:
  annotations:
    deprecated.daemonset.template.generation: "1"
    objectset.rio.cattle.io/applied: H4sIAAAAAAAA/8RVwW7jNhD9lWLOsizb2tQR0EOQBEXQrmPY3l4WRjCiRjFriiTIkTZGoH8vKDtZpWsnQYFm4YNBzptH8r3RzCOglX+R89JoyACt9cNmBBFspS4ggyukyuglMURQEWOBjJA9AmptGFka7cPS5H+TYE8cO2ligcyKYmmGMnBAdDJuvmlyg/tmCxkMm1H0yx9SF78tyTVS0Jt5GiuCDNghlXL7Lri3KELOts5p4HeeqYI2AuGoe8xKVuQZKwuZrpWKQGFO6tUnbtBvIIPp5KwUuaBkPC4+FUif8snZ2Xla0oiwnEzPxfkEy18LARH4Rgij2RmlyMXbie+xaVOQJ0WCjYMMSlSe3kjxjfhBiHfgTyhxoPKNUPngQDjIy/FZORqfwz5+ItVbEkGp7/d/hApZbP58FhGtPU3ethEwVVYhU5fbq7d3GPQq98dJ2BMCazaVqTUfCvpCiLBamS1pyDpvIwiHoNTkPGRfH4F00/0f7rNcXN7NbxcriKBBVYetaQJt9AKwuJj9fr3sQZK4+w1fIK+ul6u7+eJ2ddtDri7nP2JeO69D3Mz7p42SOJ3Eo/EoHo8SaNcRyArvQ8ShFhtyw62S1pIbqDxrkjiNUzhg5rVSc6Ok2EEGN+XM8NyRJ83wXInBTWEH0wQisMbxXqZn1ebGMWTTJIKN8fx9dSzbGTbCqKdnryNw5E3tBIUCCsaRqJ3k3aXRTA/cFR5azKWSLGlfZUUB2VeYXa/uLq4+38xg3bZBnrd9S9PJxxr3rwN/lnPhGq9Yl6aTvnfd8ijB/+be+miq33nByvdN1cSxtE0aS3tXGvcNXdEXE9p1d4v+tz7rtVOIgI0i9zQ2w9deliQYMpiZpdhQUavQ7bcURA2jYOCMojj0F6eJyYfmU6FncmHa2cDVzYnrB+nZd27/F8pDoxtYhZpOMu85Lp1kKVBdFIXR/lar3fGEdeiEtS2QackOme53QdbQT6W+/9IF9hPi4YvGBqXCXBFkozAFdjaotniB7TorI9edk6J2jjTP6ion9/TQArIkgoK8dFQcC+lu77P0/sj2grDYQZa07T8BAAD//yoC/PIWCQAA
    objectset.rio.cattle.io/id: ""
    objectset.rio.cattle.io/owner-gvk: /v1, Kind=Service
    objectset.rio.cattle.io/owner-name: traefik
    objectset.rio.cattle.io/owner-namespace: kube-system
  creationTimestamp: "2024-01-08T17:06:48Z"
  generation: 1
  labels:
    objectset.rio.cattle.io/hash: 836fcbce022d5dae5b36694fe1eaf389c93af7dc
    svccontroller.k3s.cattle.io/nodeselector: "false"
    svccontroller.k3s.cattle.io/svcname: traefik
    svccontroller.k3s.cattle.io/svcnamespace: kube-system
  name: svclb-traefik-bf26f129
  namespace: kube-system
  resourceVersion: "615"
  uid: acc5b475-2181-4d70-b320-8de6f12fd45f
spec:
  revisionHistoryLimit: 10
  selector:
    matchLabels:
      app: svclb-traefik-bf26f129
  template:
    metadata:
      creationTimestamp: ~
      labels:
        app: svclb-traefik-bf26f129
        svccontroller.k3s.cattle.io/svcname: traefik
        svccontroller.k3s.cattle.io/svcnamespace: kube-system
    spec:
      automountServiceAccountToken: false
      containers:
      - name: lb-tcp-80
        image: rancher/klipper-lb:v0.4.4
        ports:
        - name: lb-tcp-80
          hostPort: 80
          containerPort: 80
          protocol: TCP
        env:
        - name: SRC_PORT
          value: XXXXXX
        - name: SRC_RANGES
          value: XXXXXX
        - name: DEST_PROTO
          value: XXXXXX
        - name: DEST_PORT
          value: XXXXXX
        - name: DEST_IPS
          value: XXXXXX
        resources: []
        terminationMessagePath: /dev/termination-log
        terminationMessagePolicy: File
        imagePullPolicy: IfNotPresent
        securityContext:
          capabilities:
            add:
            - NET_ADMIN
      - name: lb-tcp-443
        image: rancher/klipper-lb:v0.4.4
        ports:
        - name: lb-tcp-443
          hostPort: 443
          containerPort: 443
          protocol: TCP
        env:
        - name: SRC_PORT
          value: XXXXXX
        - name: SRC_RANGES
          value: XXXXXX
        - name: DEST_PROTO
          value: XXXXXX
        - name: DEST_PORT
          value: XXXXXX
        - name: DEST_IPS
          value: XXXXXX
        resources: []
        terminationMessagePath: /dev/termination-log
        terminationMessagePolicy: File
        imagePullPolicy: IfNotPresent
        securityContext:
          capabilities:
            add:
            - NET_ADMIN
      dnsPolicy: ClusterFirst
      restartPolicy: Always
      schedulerName: default-scheduler
      securityContext:
        sysctls:
        - name: net.ipv4.ip_forward
          value: "1"
      serviceAccount: svclb
      serviceAccountName: svclb
      terminationGracePeriodSeconds: 30
      tolerations:
      - effect: NoSchedule
        key: node-role.kubernetes.io/master
        operator: Exists
      - effect: NoSchedule
        key: node-role.kubernetes.io/control-plane
        operator: Exists
      - key: CriticalAddonsOnly
        operator: Exists
  updateStrategy:
    rollingUpdate:
      maxSurge: 0
      maxUnavailable: 1
    type: RollingUpdate
...
</pre></div></li><li class='expandable detail-hide'>kube-system Deployment local-path-provisioner<div class='details'><pre>---
apiVersion: apps/v1
kind: Deployment
metadata:
  annotations:
    deployment.kubernetes.io/revision: "1"
    objectset.rio.cattle.io/applied: H4sIAAAAAAAA/6xU3W7yRhB9lWqubQMfBCFLvUBJqlZNCEqU3kSoGtZj2LDeXe0Obizkd68Gm/yoIWmlXnl/Zs6emXPGB0Cv/6AQtbOQA3ofB/UIEthpW0AOV+SNayqyDAlUxFggI+QHQGsdI2tno2zd+pkUR+IsaJcpZDaUaTfQAgLJ2Xv3l6WQbuod5LAbx3c39Sj56Xdti5/nReHstxAWK4IcjFNo0sgu4Ib+VVL0qCRzt19TGpvIVEGbgME1mS9L22LcQg6j2bgcX6jpRVmu1Xg4nUyH43IyLkcXs2ExU9MZ/ihwXUwE9ANJj7xNfXC1luZTgO7+DJ/oSQmbQF38r1qKbG50pRnyYQKRDCl2QYIqZLW9ea0AvT//aivgHJBp0xwfcMZou3n0BTJ1YC+PFmvUBteGIB+1CXDjheP9h1g5p8qbU947t5j/wKUvVDnLqC2FCPmTbKsKxZJP59sXGYP4NE2Vs6XeQAIDYjXodv0ne47OwioBsvURuRdleXf152J+e/2wnF9eQwI1mj39ElwlZEpNprin8nW9RBbxTzVmb8q1bbtKQFfivxwCWrWlMPicc14Ps2H2YwJ9wnJvzNIZrRrI4bdy4XgZKHbD9513amf2Fd26veWuY5Use57v2/CG1R2kXSa0KyHug3ZBc3NpMMZFF9e5MLWuoFQFzVqhkXZTqLWiuVLy0uIrfmkfm2IXDAmwMxROP5CnA+xIir7s4Y9DH++saWSIvUSKteH6RUeO0CYHoLIkxZDDwj2oLRV7IwPfwRypBmcokzEKlpiizKyYKjiTeoOW/lfkCiMfdfgEcnVS52RlafstenHTP2Xtvduel6lt278DAAD//8i6p1C4BQAA
    objectset.rio.cattle.io/id: ""
    objectset.rio.cattle.io/owner-gvk: k3s.cattle.io/v1, Kind=Addon
    objectset.rio.cattle.io/owner-name: local-storage
    objectset.rio.cattle.io/owner-namespace: kube-system
  creationTimestamp: "2024-01-08T17:05:58Z"
  generation: 1
  labels:
    objectset.rio.cattle.io/hash: 183f35c65ffbc3064603f43f1580d8c68a2dabd4
  name: local-path-provisioner
  namespace: kube-system
  resourceVersion: "475"
  uid: 718c0dfe-3f1a-4b36-807a-d731f31753f6
spec:
  progressDeadlineSeconds: 600
  replicas: 1
  revisionHistoryLimit: 0
  selector:
    matchLabels:
      app: local-path-provisioner
  strategy:
    rollingUpdate:
      maxSurge: 25%
      maxUnavailable: 1
    type: RollingUpdate
  template:
    metadata:
      creationTimestamp: ~
      labels:
        app: local-path-provisioner
    spec:
      containers:
      - name: local-path-provisioner
        image: rancher/local-path-provisioner:v0.0.24
        command:
        - local-path-provisioner
        - start
        - --config
        - /etc/config/config.json
        env:
        - name: POD_NAMESPACE
          value: XXXXXX
          valueFrom:
            fieldRef:
              apiVersion: v1
              fieldPath: metadata.namespace
        resources: []
        volumeMounts:
        - name: config-volume
          mountPath: /etc/config/
        terminationMessagePath: /dev/termination-log
        terminationMessagePolicy: File
        imagePullPolicy: IfNotPresent
      dnsPolicy: ClusterFirst
      priorityClassName: system-node-critical
      restartPolicy: Always
      schedulerName: default-scheduler
      securityContext: []
      serviceAccount: local-path-provisioner-service-account
      serviceAccountName: local-path-provisioner-service-account
      terminationGracePeriodSeconds: 30
      tolerations:
      - key: CriticalAddonsOnly
        operator: Exists
      - effect: NoSchedule
        key: node-role.kubernetes.io/control-plane
        operator: Exists
      - effect: NoSchedule
        key: node-role.kubernetes.io/master
        operator: Exists
      volumes:
      - configMap:
          defaultMode: 420
          name: local-path-config
        name: config-volume
...
</pre></div></li><li class='expandable detail-hide'>kube-system Deployment traefik<div class='details'><pre>---
apiVersion: apps/v1
kind: Deployment
metadata:
  annotations:
    deployment.kubernetes.io/revision: "1"
    meta.helm.sh/release-name: traefik
    meta.helm.sh/release-namespace: kube-system
  creationTimestamp: "2024-01-08T17:06:48Z"
  generation: 1
  labels:
    app.kubernetes.io/instance: traefik-kube-system
    app.kubernetes.io/managed-by: Helm
    app.kubernetes.io/name: traefik
    helm.sh/chart: traefik-21.2.1_up21.2.0
  name: traefik
  namespace: kube-system
  resourceVersion: "629"
  uid: ec30998f-e81b-47de-aeae-3970de0b73a4
spec:
  progressDeadlineSeconds: 600
  replicas: 1
  revisionHistoryLimit: 10
  selector:
    matchLabels:
      app.kubernetes.io/instance: traefik-kube-system
      app.kubernetes.io/name: traefik
  strategy:
    rollingUpdate:
      maxSurge: 1
      maxUnavailable: 0
    type: RollingUpdate
  template:
    metadata:
      annotations:
        prometheus.io/path: /metrics
        prometheus.io/port: "9100"
        prometheus.io/scrape: "true"
      creationTimestamp: ~
      labels:
        app.kubernetes.io/instance: traefik-kube-system
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: traefik
        helm.sh/chart: traefik-21.2.1_up21.2.0
    spec:
      containers:
      - name: traefik
        image: rancher/mirrored-library-traefik:2.9.10
        args:
        - --global.checknewversion
        - --global.sendanonymoususage
        - --entrypoints.metrics.address=:9100/tcp
        - --entrypoints.traefik.address=:9000/tcp
        - --entrypoints.web.address=:8000/tcp
        - --entrypoints.websecure.address=:8443/tcp
        - --api.dashboard=true
        - --ping=true
        - --metrics.prometheus=true
        - --metrics.prometheus.entrypoint=metrics
        - --providers.kubernetescrd
        - --providers.kubernetesingress
        - --providers.kubernetesingress.ingressendpoint.publishedservice=kube-system/traefik
        - --entrypoints.websecure.http.tls=true
        ports:
        - name: metrics
          containerPort: 9100
          protocol: TCP
        - name: traefik
          containerPort: 9000
          protocol: TCP
        - name: web
          containerPort: 8000
          protocol: TCP
        - name: websecure
          containerPort: 8443
          protocol: TCP
        resources: []
        volumeMounts:
        - name: data
          mountPath: /data
        - name: tmp
          mountPath: /tmp
        livenessProbe:
          httpGet:
            path: /ping
            port: 9000
            scheme: HTTP
          initialDelaySeconds: 2
          timeoutSeconds: 2
          periodSeconds: 10
          successThreshold: 1
          failureThreshold: 3
        readinessProbe:
          httpGet:
            path: /ping
            port: 9000
            scheme: HTTP
          initialDelaySeconds: 2
          timeoutSeconds: 2
          periodSeconds: 10
          successThreshold: 1
          failureThreshold: 1
        terminationMessagePath: /dev/termination-log
        terminationMessagePolicy: File
        imagePullPolicy: IfNotPresent
        securityContext:
          capabilities:
            drop:
            - ALL
          runAsUser: 65532
          runAsGroup: 65532
          runAsNonRoot: true
          readOnlyRootFilesystem: true
      dnsPolicy: ClusterFirst
      priorityClassName: system-cluster-critical
      restartPolicy: Always
      schedulerName: default-scheduler
      securityContext:
        fsGroup: 65532
      serviceAccount: traefik
      serviceAccountName: traefik
      terminationGracePeriodSeconds: 60
      tolerations:
      - key: CriticalAddonsOnly
        operator: Exists
      - effect: NoSchedule
        key: node-role.kubernetes.io/control-plane
        operator: Exists
      - effect: NoSchedule
        key: node-role.kubernetes.io/master
        operator: Exists
      volumes:
      - emptyDir: []
        name: data
      - emptyDir: []
        name: tmp
...
</pre></div></li><li class='expandable detail-hide'>kube-system Job helm-install-traefik<div class='details'><pre>---
apiVersion: batch/v1
kind: Job
metadata:
  annotations:
    batch.kubernetes.io/job-tracking: ""
    objectset.rio.cattle.io/applied: H4sIAAAAAAAA/6xVUY/qNhP9K59Guk9fEgLZbCDSPgQIhd5diAK7alWtkDETcHHsyHZoVyv+e+WQezfb3m5vpb7ZzszxOeM5k1cgFXtCpZkUEMOOGHrsnfvgwImJPcTwo9yBAyUasieGQPwKRAhpiGFSaLuVu1+RGo3GU0x6lBjD0WOyx2z2EXnpUimMkpyjcumRKOMqPDBtVIMBzt8iyN8EKvdwPrVAnU/nvvO/z0zs7+bIy4kF/UccQUqEGIwiWLDTd4XrilCbc6p36OoXbbCEiwNUYUN9w0rUhpQVxKLm3AFOdsiboli6jVbt/Yl5c/pdPI5EHyEG6hejCElEBiEGe6RRfxRGNCLB4KZPgmERYFgQDAvLrNXYVJ0JbQjn7ttFH0jSFVLLe0foSRbFPSuZgbjv+74DBsuKE4P2+wd98IFkKQp2mF/lrOfJILy9C6NJMByPZuPx7ThIg4kfzobRKEgnfhCG09EoDGfRjT9OwptplM4G09HtdBTNhtPb//wBLh35tlMJE6g0xL+8AlEHu4C2lOCA62o0rjaKiQM4cOByR7h3reMUC1Jzk1+b++UOnh1AcW6Q2odZJg8pOHAmvO724sX5GvGU5uvFatk9ytNs1d3P0/uH7TRfPKV5B0sjVWi6cZN5km+29sp1lky6975//PcJnbCjMZWOe71Pr58fx2m+TDfpeptki8unnrYPT6+11L1WhzvoewOv//+6ahb+X0h/Q9wmyX9I/xXL5HEz32bJer2d5Ok0XW4Wyf26k1YQrrGbsFxts3z108+dGE+fqeNRXmuDyuOSEu70fe9m4Pme3+vfNpug3XSxZsni/jFPt9nqfjHpIir80iSXZwdYSQ7NKRH0iKp34qyqULm2FeOz7w29gburGd8P/EHgD/shtDlZzXkmOaMvEMOiWEqTKdQoDLwzNzigUMtaUbTdfnHgLHld4oOshbn2bmmXGTHWc60D3zAa1roR9j6unaRtmLWDvfvybEUJucc1cqRGKmsW+z5KoEHdTE0NMXAm6t+tQ5X1pTJfpazEjDBeKwQHNKozo5hQaq9edkbW26i6ytFd77ScnS+dHr+2qxbh+mu5RrkdczeuLtjhgVQ2R3SjW4Fv4d+S3gwIQ0zdlPryRwAAAP//DrZg0DIHAAA
    objectset.rio.cattle.io/id: helm-controller-chart-registration
    objectset.rio.cattle.io/owner-gvk: helm.cattle.io/v1, Kind=HelmChart
    objectset.rio.cattle.io/owner-name: traefik
    objectset.rio.cattle.io/owner-namespace: kube-system
  creationTimestamp: "2024-01-08T17:06:00Z"
  generation: 1
  labels:
    helmcharts.helm.cattle.io/chart: traefik
    objectset.rio.cattle.io/hash: c0f97ea7a25e3dec71957c7a3241a38f3e5fae5f
  name: helm-install-traefik
  namespace: kube-system
  resourceVersion: "598"
  uid: 2a591629-9af8-4949-b2dd-39bd02b148a4
spec:
  backoffLimit: 1000
  completionMode: NonIndexed
  completions: 1
  parallelism: 1
  selector:
    matchLabels:
      batch.kubernetes.io/controller-uid: 2a591629-9af8-4949-b2dd-39bd02b148a4
  suspend: false
  template:
    metadata:
      annotations:
        helmcharts.helm.cattle.io/configHash: SHA256=57C38B9FBB6B3E3C05F8793EC0355D9955F740BA54D7EF2D96D97F8D678F2B0E
      creationTimestamp: ~
      labels:
        batch.kubernetes.io/controller-uid: 2a591629-9af8-4949-b2dd-39bd02b148a4
        batch.kubernetes.io/job-name: helm-install-traefik
        controller-uid: 2a591629-9af8-4949-b2dd-39bd02b148a4
        helmcharts.helm.cattle.io/chart: traefik
        job-name: helm-install-traefik
    spec:
      containers:
      - name: helm
        image: rancher/klipper-helm:v0.8.2-build20230815
        args:
        - install
        - --set-string
        - global.systemDefaultRegistry=
        env:
        - name: NAME
          value: XXXXXX
        - name: VERSION
          value: XXXXXX
        - name: REPO
          value: XXXXXX
        - name: HELM_DRIVER
          value: XXXXXX
        - name: CHART_NAMESPACE
          value: XXXXXX
        - name: CHART
          value: XXXXXX
        - name: HELM_VERSION
          value: XXXXXX
        - name: TARGET_NAMESPACE
          value: XXXXXX
        - name: AUTH_PASS_CREDENTIALS
          value: XXXXXX
        - name: NO_PROXY
          value: XXXXXX
        - name: FAILURE_POLICY
          value: XXXXXX
        resources: []
        volumeMounts:
        - name: values
          mountPath: /config
        - name: content
          mountPath: /chart
        terminationMessagePath: /dev/termination-log
        terminationMessagePolicy: File
        imagePullPolicy: IfNotPresent
      dnsPolicy: ClusterFirst
      nodeSelector:
        kubernetes.io/os: linux
      restartPolicy: OnFailure
      schedulerName: default-scheduler
      securityContext: []
      serviceAccount: helm-traefik
      serviceAccountName: helm-traefik
      terminationGracePeriodSeconds: 30
      volumes:
      - name: values
        secret:
          defaultMode: 420
          secretName: chart-values-traefik
      - configMap:
          defaultMode: 420
          name: chart-content-traefik
        name: content
...
</pre></div></li><li class='expandable detail-hide'>kube-system Job helm-install-traefik-crd<div class='details'><pre>---
apiVersion: batch/v1
kind: Job
metadata:
  annotations:
    batch.kubernetes.io/job-tracking: ""
    objectset.rio.cattle.io/applied: H4sIAAAAAAAA/7RVUY/iNhD+K9VI99QkJCEsm0j3ELhQ6O0CCuyqVbVCxkzAxbEj26E9If575ZC7hu11e324t9ie7/P3jWcmZyAVe0almRSQwJYYeuidAnDgyMQOEvhZbsGBEg3ZEUMgOQMRQhpimBTaLuX2d6RGo/EUkx4lxnD0mOwxiz4gL10qhVGSc1QuPRBlXIV7po1qOMD5Vwb5h0Dl7k/HlqhzdAqcHz4ysXs/RV6OLel/8ghSIiRgFMGCHV2qdt8E0RWhFnest+jqT9pgCRcHqMJG/pqVqA0pK0hEzbkDnGyRN4mxkhu/2nulvtn9Zi0Hog+QQHRfFP3dgPaDYLjtD8OC7igZ+PEwHhRxEQ79kBT+IA6tutZrk30mtCGcu7eXvWFNV0it/i2hR1kUD6xkBpLA930HDJYVJwbt+Rs18YZ1KQq2n14traZpOLh7n/VH/jiKwvh+Mg7GQRSnk9EkGt/H8d1kFIdROEyzKMiiuygexf1onEbxII6D0fC7PMSlkwJbuYQJVBqS385A1N5+QJtSeHEAxak5ajM+Tx8zcOBEeP262C7Ol6jnLF/NFvPuVp4tF931NHt43HzIZ89Z3uHTSBWabtx4mubrjb12tUzH3btvX/UW0Ak7GFPppNd7d/74NMryebbOVpt0Obu862n7ovSaJN3reHHDwAu94Me6CoN/iP6KuXWa/5T9L5Xp03q6Waar1WacZx+y+XqWPqw6sIJwjV3AfLFZ5otffu3EePpEHY/yWhtUHpeUcCfwvSj0fM/vBXfNot8uulyTdPbwlGeb5eJhNu4yKvz88pcXB1hJ9s0uEfSAqnfkrKpQubbGkpPv3Xuhu60Z34V+2PfvgwG0mGXN+VJyRj9BArNiLs1SoUZh4KZzwQGFWtaKoi3jiwMnyesSH2UtzLUgS/u5JMY2U9taf3M0qnVj7DauHZdtmK1xe/flxZoScocr5EiNVLYD7PsogQZ1MxY1JMCZqP+0radswynzxcpCTAjjtUJwQKM6MYoppfbqeWce3c6hqyXd7aFWt/O52pNz+9WyXP8h1yj3Vec2LVuw/SOpLE50Ea3RW8jX0tBMAENM3aT98lcAAAD//411peIjBwAA
    objectset.rio.cattle.io/id: helm-controller-chart-registration
    objectset.rio.cattle.io/owner-gvk: helm.cattle.io/v1, Kind=HelmChart
    objectset.rio.cattle.io/owner-name: traefik-crd
    objectset.rio.cattle.io/owner-namespace: kube-system
  creationTimestamp: "2024-01-08T17:06:00Z"
  generation: 1
  labels:
    helmcharts.helm.cattle.io/chart: traefik-crd
    objectset.rio.cattle.io/hash: 48ff3d5c3117b372fcdca509795f9f2702af0592
  name: helm-install-traefik-crd
  namespace: kube-system
  resourceVersion: "588"
  uid: 655ceb1b-aaa8-4b24-92ab-fceb2ddd45bd
spec:
  backoffLimit: 1000
  completionMode: NonIndexed
  completions: 1
  parallelism: 1
  selector:
    matchLabels:
      batch.kubernetes.io/controller-uid: 655ceb1b-aaa8-4b24-92ab-fceb2ddd45bd
  suspend: false
  template:
    metadata:
      annotations:
        helmcharts.helm.cattle.io/configHash: SHA256=E3B0C44298FC1C149AFBF4C8996FB92427AE41E4649B934CA495991B7852B855
      creationTimestamp: ~
      labels:
        batch.kubernetes.io/controller-uid: 655ceb1b-aaa8-4b24-92ab-fceb2ddd45bd
        batch.kubernetes.io/job-name: helm-install-traefik-crd
        controller-uid: 655ceb1b-aaa8-4b24-92ab-fceb2ddd45bd
        helmcharts.helm.cattle.io/chart: traefik-crd
        job-name: helm-install-traefik-crd
    spec:
      containers:
      - name: helm
        image: rancher/klipper-helm:v0.8.2-build20230815
        args:
        - install
        env:
        - name: NAME
          value: XXXXXX
        - name: VERSION
          value: XXXXXX
        - name: REPO
          value: XXXXXX
        - name: HELM_DRIVER
          value: XXXXXX
        - name: CHART_NAMESPACE
          value: XXXXXX
        - name: CHART
          value: XXXXXX
        - name: HELM_VERSION
          value: XXXXXX
        - name: TARGET_NAMESPACE
          value: XXXXXX
        - name: AUTH_PASS_CREDENTIALS
          value: XXXXXX
        - name: NO_PROXY
          value: XXXXXX
        - name: FAILURE_POLICY
          value: XXXXXX
        resources: []
        volumeMounts:
        - name: values
          mountPath: /config
        - name: content
          mountPath: /chart
        terminationMessagePath: /dev/termination-log
        terminationMessagePolicy: File
        imagePullPolicy: IfNotPresent
      dnsPolicy: ClusterFirst
      nodeSelector:
        kubernetes.io/os: linux
      restartPolicy: OnFailure
      schedulerName: default-scheduler
      securityContext: []
      serviceAccount: helm-traefik-crd
      serviceAccountName: helm-traefik-crd
      terminationGracePeriodSeconds: 30
      volumes:
      - name: values
        secret:
          defaultMode: 420
          secretName: chart-values-traefik-crd
      - configMap:
          defaultMode: 420
          name: chart-content-traefik-crd
        name: content
...
</pre></div></li></ul></div></div></div><div class='accordion-item'><div class='accordion-header' id='control_32_header'><button class='accordion-button collapsed' type='button' data-bs-toggle='collapse' data-bs-target='#control_32' aria-expanded='false' aria-controls='control_32'><div class='row'><div class='col'><h2 class='fs-4'>C-0211: CIS-5.7.3 Apply Security Context to Your Pods and Containers</h2><p class='mb-0'> Apply Security Context to Your Pods and Containers</p></div></div></button></div><div id='control_32' class='accordion-collapse collapse' aria-labelledby='control_32_header' data-bs-parent='#report'><div class='accordion-body'><p>A security context defines the operating system security settings (uid, gid, capabilities, SELinux role, etc..) applied to a container. When designing your containers and pods, make sure that you configure the security context for your pods, containers, and volumes. A security context is a property defined in the deployment yaml. It controls the security parameters that will be assigned to the pod/container/volume. There are two levels of security context: pod level security context, and container level security context.</p><h5>Detection</h5><p>Check that pod and container security context fields according to recommendations in CIS Security Benchmark for Docker Containers</p><h5>Remediation</h5><p>Follow the Kubernetes documentation and apply security contexts to your pods. For a suggested list of security contexts, you may refer to the CIS Security Benchmark for Docker Containers.</p><h5>Checked paths and expected values</h5><ul><li>spec.template.spec.containers[*].securityContext.allowPrivilegeEscalation = false</li><li>spec.template.spec.containers[*].securityContext.capabilities.drop[*] = NET_RAW</li><li>spec.template.spec.containers[*].securityContext.readOnlyRootFilesystem = true</li><li>spec.template.spec.containers[*].securityContext.runAsNonRoot = true</li><li>spec.template.spec.containers[*].securityContext.seLinuxOptions = YOUR_VALUE</li><li>spec.template.spec.containers[*].securityContext.seccompProfile = YOUR_VALUE</li><li>spec.template.spec.securityContext.fsGroup = YOUR_VALUE</li><li>spec.template.spec.securityContext.fsGroupChangePolicy = Always</li><li>spec.template.spec.securityContext.supplementalGroups = YOUR_VALUE</li><li>spec.template.spec.securityContext.sysctls = 1</li></ul><h5>References</h5><ul><li><a href='https://workbench.cisecurity.org/sections/1126667/recommendations/1838636'>https://workbench.cisecurity.org/sections/1126667/recommendations/1838636</a></li></ul><h5>Affected resources</h5><ul><li class='expandable detail-hide'>kube-system DaemonSet svclb-traefik-bf26f129<div class='details'><pre>---
apiVersion: apps/v1
kind: DaemonSet
metadata:
  annotations:
    deprecated.daemonset.template.generation: "1"
    objectset.rio.cattle.io/applied: H4sIAAAAAAAA/8RVwW7jNhD9lWLOsizb2tQR0EOQBEXQrmPY3l4WRjCiRjFriiTIkTZGoH8vKDtZpWsnQYFm4YNBzptH8r3RzCOglX+R89JoyACt9cNmBBFspS4ggyukyuglMURQEWOBjJA9AmptGFka7cPS5H+TYE8cO2ligcyKYmmGMnBAdDJuvmlyg/tmCxkMm1H0yx9SF78tyTVS0Jt5GiuCDNghlXL7Lri3KELOts5p4HeeqYI2AuGoe8xKVuQZKwuZrpWKQGFO6tUnbtBvIIPp5KwUuaBkPC4+FUif8snZ2Xla0oiwnEzPxfkEy18LARH4Rgij2RmlyMXbie+xaVOQJ0WCjYMMSlSe3kjxjfhBiHfgTyhxoPKNUPngQDjIy/FZORqfwz5+ItVbEkGp7/d/hApZbP58FhGtPU3ethEwVVYhU5fbq7d3GPQq98dJ2BMCazaVqTUfCvpCiLBamS1pyDpvIwiHoNTkPGRfH4F00/0f7rNcXN7NbxcriKBBVYetaQJt9AKwuJj9fr3sQZK4+w1fIK+ul6u7+eJ2ddtDri7nP2JeO69D3Mz7p42SOJ3Eo/EoHo8SaNcRyArvQ8ShFhtyw62S1pIbqDxrkjiNUzhg5rVSc6Ok2EEGN+XM8NyRJ83wXInBTWEH0wQisMbxXqZn1ebGMWTTJIKN8fx9dSzbGTbCqKdnryNw5E3tBIUCCsaRqJ3k3aXRTA/cFR5azKWSLGlfZUUB2VeYXa/uLq4+38xg3bZBnrd9S9PJxxr3rwN/lnPhGq9Yl6aTvnfd8ijB/+be+miq33nByvdN1cSxtE0aS3tXGvcNXdEXE9p1d4v+tz7rtVOIgI0i9zQ2w9deliQYMpiZpdhQUavQ7bcURA2jYOCMojj0F6eJyYfmU6FncmHa2cDVzYnrB+nZd27/F8pDoxtYhZpOMu85Lp1kKVBdFIXR/lar3fGEdeiEtS2QackOme53QdbQT6W+/9IF9hPi4YvGBqXCXBFkozAFdjaotniB7TorI9edk6J2jjTP6ion9/TQArIkgoK8dFQcC+lu77P0/sj2grDYQZa07T8BAAD//yoC/PIWCQAA
    objectset.rio.cattle.io/id: ""
    objectset.rio.cattle.io/owner-gvk: /v1, Kind=Service
    objectset.rio.cattle.io/owner-name: traefik
    objectset.rio.cattle.io/owner-namespace: kube-system
  creationTimestamp: "2024-01-08T17:06:48Z"
  generation: 1
  labels:
    objectset.rio.cattle.io/hash: 836fcbce022d5dae5b36694fe1eaf389c93af7dc
    svccontroller.k3s.cattle.io/nodeselector: "false"
    svccontroller.k3s.cattle.io/svcname: traefik
    svccontroller.k3s.cattle.io/svcnamespace: kube-system
  name: svclb-traefik-bf26f129
  namespace: kube-system
  resourceVersion: "615"
  uid: acc5b475-2181-4d70-b320-8de6f12fd45f
spec:
  revisionHistoryLimit: 10
  selector:
    matchLabels:
      app: svclb-traefik-bf26f129
  template:
    metadata:
      creationTimestamp: ~
      labels:
        app: svclb-traefik-bf26f129
        svccontroller.k3s.cattle.io/svcname: traefik
        svccontroller.k3s.cattle.io/svcnamespace: kube-system
    spec:
      automountServiceAccountToken: false
      containers:
      - name: lb-tcp-80
        image: rancher/klipper-lb:v0.4.4
        ports:
        - name: lb-tcp-80
          hostPort: 80
          containerPort: 80
          protocol: TCP
        env:
        - name: SRC_PORT
          value: XXXXXX
        - name: SRC_RANGES
          value: XXXXXX
        - name: DEST_PROTO
          value: XXXXXX
        - name: DEST_PORT
          value: XXXXXX
        - name: DEST_IPS
          value: XXXXXX
        resources: []
        terminationMessagePath: /dev/termination-log
        terminationMessagePolicy: File
        imagePullPolicy: IfNotPresent
        securityContext:
          capabilities:
            add:
            - NET_ADMIN
      - name: lb-tcp-443
        image: rancher/klipper-lb:v0.4.4
        ports:
        - name: lb-tcp-443
          hostPort: 443
          containerPort: 443
          protocol: TCP
        env:
        - name: SRC_PORT
          value: XXXXXX
        - name: SRC_RANGES
          value: XXXXXX
        - name: DEST_PROTO
          value: XXXXXX
        - name: DEST_PORT
          value: XXXXXX
        - name: DEST_IPS
          value: XXXXXX
        resources: []
        terminationMessagePath: /dev/termination-log
        terminationMessagePolicy: File
        imagePullPolicy: IfNotPresent
        securityContext:
          capabilities:
            add:
            - NET_ADMIN
      dnsPolicy: ClusterFirst
      restartPolicy: Always
      schedulerName: default-scheduler
      securityContext:
        sysctls:
        - name: net.ipv4.ip_forward
          value: "1"
      serviceAccount: svclb
      serviceAccountName: svclb
      terminationGracePeriodSeconds: 30
      tolerations:
      - effect: NoSchedule
        key: node-role.kubernetes.io/master
        operator: Exists
      - effect: NoSchedule
        key: node-role.kubernetes.io/control-plane
        operator: Exists
      - key: CriticalAddonsOnly
        operator: Exists
  updateStrategy:
    rollingUpdate:
      maxSurge: 0
      maxUnavailable: 1
    type: RollingUpdate
...
</pre></div></li><li class='expandable detail-hide'>kube-system Deployment local-path-provisioner<div class='details'><pre>---
apiVersion: apps/v1
kind: Deployment
metadata:
  annotations:
    deployment.kubernetes.io/revision: "1"
    objectset.rio.cattle.io/applied: H4sIAAAAAAAA/6xU3W7yRhB9lWqubQMfBCFLvUBJqlZNCEqU3kSoGtZj2LDeXe0Obizkd68Gm/yoIWmlXnl/Zs6emXPGB0Cv/6AQtbOQA3ofB/UIEthpW0AOV+SNayqyDAlUxFggI+QHQGsdI2tno2zd+pkUR+IsaJcpZDaUaTfQAgLJ2Xv3l6WQbuod5LAbx3c39Sj56Xdti5/nReHstxAWK4IcjFNo0sgu4Ib+VVL0qCRzt19TGpvIVEGbgME1mS9L22LcQg6j2bgcX6jpRVmu1Xg4nUyH43IyLkcXs2ExU9MZ/ihwXUwE9ANJj7xNfXC1luZTgO7+DJ/oSQmbQF38r1qKbG50pRnyYQKRDCl2QYIqZLW9ea0AvT//aivgHJBp0xwfcMZou3n0BTJ1YC+PFmvUBteGIB+1CXDjheP9h1g5p8qbU947t5j/wKUvVDnLqC2FCPmTbKsKxZJP59sXGYP4NE2Vs6XeQAIDYjXodv0ne47OwioBsvURuRdleXf152J+e/2wnF9eQwI1mj39ElwlZEpNprin8nW9RBbxTzVmb8q1bbtKQFfivxwCWrWlMPicc14Ps2H2YwJ9wnJvzNIZrRrI4bdy4XgZKHbD9513amf2Fd26veWuY5Use57v2/CG1R2kXSa0KyHug3ZBc3NpMMZFF9e5MLWuoFQFzVqhkXZTqLWiuVLy0uIrfmkfm2IXDAmwMxROP5CnA+xIir7s4Y9DH++saWSIvUSKteH6RUeO0CYHoLIkxZDDwj2oLRV7IwPfwRypBmcokzEKlpiizKyYKjiTeoOW/lfkCiMfdfgEcnVS52RlafstenHTP2Xtvduel6lt278DAAD//8i6p1C4BQAA
    objectset.rio.cattle.io/id: ""
    objectset.rio.cattle.io/owner-gvk: k3s.cattle.io/v1, Kind=Addon
    objectset.rio.cattle.io/owner-name: local-storage
    objectset.rio.cattle.io/owner-namespace: kube-system
  creationTimestamp: "2024-01-08T17:05:58Z"
  generation: 1
  labels:
    objectset.rio.cattle.io/hash: 183f35c65ffbc3064603f43f1580d8c68a2dabd4
  name: local-path-provisioner
  namespace: kube-system
  resourceVersion: "475"
  uid: 718c0dfe-3f1a-4b36-807a-d731f31753f6
spec:
  progressDeadlineSeconds: 600
  replicas: 1
  revisionHistoryLimit: 0
  selector:
    matchLabels:
      app: local-path-provisioner
  strategy:
    rollingUpdate:
      maxSurge: 25%
      maxUnavailable: 1
    type: RollingUpdate
  template:
    metadata:
      creationTimestamp: ~
      labels:
        app: local-path-provisioner
    spec:
      containers:
      - name: local-path-provisioner
        image: rancher/local-path-provisioner:v0.0.24
        command:
        - local-path-provisioner
        - start
        - --config
        - /etc/config/config.json
        env:
        - name: POD_NAMESPACE
          value: XXXXXX
          valueFrom:
            fieldRef:
              apiVersion: v1
              fieldPath: metadata.namespace
        resources: []
        volumeMounts:
        - name: config-volume
          mountPath: /etc/config/
        terminationMessagePath: /dev/termination-log
        terminationMessagePolicy: File
        imagePullPolicy: IfNotPresent
      dnsPolicy: ClusterFirst
      priorityClassName: system-node-critical
      restartPolicy: Always
      schedulerName: default-scheduler
      securityContext: []
      serviceAccount: local-path-provisioner-service-account
      serviceAccountName: local-path-provisioner-service-account
      terminationGracePeriodSeconds: 30
      tolerations:
      - key: CriticalAddonsOnly
        operator: Exists
      - effect: NoSchedule
        key: node-role.kubernetes.io/control-plane
        operator: Exists
      - effect: NoSchedule
        key: node-role.kubernetes.io/master
        operator: Exists
      volumes:
      - configMap:
          defaultMode: 420
          name: local-path-config
        name: config-volume
...
</pre></div></li><li class='expandable detail-hide'>kube-system Deployment traefik<div class='details'><pre>---
apiVersion: apps/v1
kind: Deployment
metadata:
  annotations:
    deployment.kubernetes.io/revision: "1"
    meta.helm.sh/release-name: traefik
    meta.helm.sh/release-namespace: kube-system
  creationTimestamp: "2024-01-08T17:06:48Z"
  generation: 1
  labels:
    app.kubernetes.io/instance: traefik-kube-system
    app.kubernetes.io/managed-by: Helm
    app.kubernetes.io/name: traefik
    helm.sh/chart: traefik-21.2.1_up21.2.0
  name: traefik
  namespace: kube-system
  resourceVersion: "629"
  uid: ec30998f-e81b-47de-aeae-3970de0b73a4
spec:
  progressDeadlineSeconds: 600
  replicas: 1
  revisionHistoryLimit: 10
  selector:
    matchLabels:
      app.kubernetes.io/instance: traefik-kube-system
      app.kubernetes.io/name: traefik
  strategy:
    rollingUpdate:
      maxSurge: 1
      maxUnavailable: 0
    type: RollingUpdate
  template:
    metadata:
      annotations:
        prometheus.io/path: /metrics
        prometheus.io/port: "9100"
        prometheus.io/scrape: "true"
      creationTimestamp: ~
      labels:
        app.kubernetes.io/instance: traefik-kube-system
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: traefik
        helm.sh/chart: traefik-21.2.1_up21.2.0
    spec:
      containers:
      - name: traefik
        image: rancher/mirrored-library-traefik:2.9.10
        args:
        - --global.checknewversion
        - --global.sendanonymoususage
        - --entrypoints.metrics.address=:9100/tcp
        - --entrypoints.traefik.address=:9000/tcp
        - --entrypoints.web.address=:8000/tcp
        - --entrypoints.websecure.address=:8443/tcp
        - --api.dashboard=true
        - --ping=true
        - --metrics.prometheus=true
        - --metrics.prometheus.entrypoint=metrics
        - --providers.kubernetescrd
        - --providers.kubernetesingress
        - --providers.kubernetesingress.ingressendpoint.publishedservice=kube-system/traefik
        - --entrypoints.websecure.http.tls=true
        ports:
        - name: metrics
          containerPort: 9100
          protocol: TCP
        - name: traefik
          containerPort: 9000
          protocol: TCP
        - name: web
          containerPort: 8000
          protocol: TCP
        - name: websecure
          containerPort: 8443
          protocol: TCP
        resources: []
        volumeMounts:
        - name: data
          mountPath: /data
        - name: tmp
          mountPath: /tmp
        livenessProbe:
          httpGet:
            path: /ping
            port: 9000
            scheme: HTTP
          initialDelaySeconds: 2
          timeoutSeconds: 2
          periodSeconds: 10
          successThreshold: 1
          failureThreshold: 3
        readinessProbe:
          httpGet:
            path: /ping
            port: 9000
            scheme: HTTP
          initialDelaySeconds: 2
          timeoutSeconds: 2
          periodSeconds: 10
          successThreshold: 1
          failureThreshold: 1
        terminationMessagePath: /dev/termination-log
        terminationMessagePolicy: File
        imagePullPolicy: IfNotPresent
        securityContext:
          capabilities:
            drop:
            - ALL
          runAsUser: 65532
          runAsGroup: 65532
          runAsNonRoot: true
          readOnlyRootFilesystem: true
      dnsPolicy: ClusterFirst
      priorityClassName: system-cluster-critical
      restartPolicy: Always
      schedulerName: default-scheduler
      securityContext:
        fsGroup: 65532
      serviceAccount: traefik
      serviceAccountName: traefik
      terminationGracePeriodSeconds: 60
      tolerations:
      - key: CriticalAddonsOnly
        operator: Exists
      - effect: NoSchedule
        key: node-role.kubernetes.io/control-plane
        operator: Exists
      - effect: NoSchedule
        key: node-role.kubernetes.io/master
        operator: Exists
      volumes:
      - emptyDir: []
        name: data
      - emptyDir: []
        name: tmp
...
</pre></div></li><li class='expandable detail-hide'>kube-system Job helm-install-traefik<div class='details'><pre>---
apiVersion: batch/v1
kind: Job
metadata:
  annotations:
    batch.kubernetes.io/job-tracking: ""
    objectset.rio.cattle.io/applied: H4sIAAAAAAAA/6xVUY/qNhP9K59Guk9fEgLZbCDSPgQIhd5diAK7alWtkDETcHHsyHZoVyv+e+WQezfb3m5vpb7ZzszxOeM5k1cgFXtCpZkUEMOOGHrsnfvgwImJPcTwo9yBAyUasieGQPwKRAhpiGFSaLuVu1+RGo3GU0x6lBjD0WOyx2z2EXnpUimMkpyjcumRKOMqPDBtVIMBzt8iyN8EKvdwPrVAnU/nvvO/z0zs7+bIy4kF/UccQUqEGIwiWLDTd4XrilCbc6p36OoXbbCEiwNUYUN9w0rUhpQVxKLm3AFOdsiboli6jVbt/Yl5c/pdPI5EHyEG6hejCElEBiEGe6RRfxRGNCLB4KZPgmERYFgQDAvLrNXYVJ0JbQjn7ttFH0jSFVLLe0foSRbFPSuZgbjv+74DBsuKE4P2+wd98IFkKQp2mF/lrOfJILy9C6NJMByPZuPx7ThIg4kfzobRKEgnfhCG09EoDGfRjT9OwptplM4G09HtdBTNhtPb//wBLh35tlMJE6g0xL+8AlEHu4C2lOCA62o0rjaKiQM4cOByR7h3reMUC1Jzk1+b++UOnh1AcW6Q2odZJg8pOHAmvO724sX5GvGU5uvFatk9ytNs1d3P0/uH7TRfPKV5B0sjVWi6cZN5km+29sp1lky6975//PcJnbCjMZWOe71Pr58fx2m+TDfpeptki8unnrYPT6+11L1WhzvoewOv//+6ahb+X0h/Q9wmyX9I/xXL5HEz32bJer2d5Ok0XW4Wyf26k1YQrrGbsFxts3z108+dGE+fqeNRXmuDyuOSEu70fe9m4Pme3+vfNpug3XSxZsni/jFPt9nqfjHpIir80iSXZwdYSQ7NKRH0iKp34qyqULm2FeOz7w29gburGd8P/EHgD/shtDlZzXkmOaMvEMOiWEqTKdQoDLwzNzigUMtaUbTdfnHgLHld4oOshbn2bmmXGTHWc60D3zAa1roR9j6unaRtmLWDvfvybEUJucc1cqRGKmsW+z5KoEHdTE0NMXAm6t+tQ5X1pTJfpazEjDBeKwQHNKozo5hQaq9edkbW26i6ytFd77ScnS+dHr+2qxbh+mu5RrkdczeuLtjhgVQ2R3SjW4Fv4d+S3gwIQ0zdlPryRwAAAP//DrZg0DIHAAA
    objectset.rio.cattle.io/id: helm-controller-chart-registration
    objectset.rio.cattle.io/owner-gvk: helm.cattle.io/v1, Kind=HelmChart
    objectset.rio.cattle.io/owner-name: traefik
    objectset.rio.cattle.io/owner-namespace: kube-system
  creationTimestamp: "2024-01-08T17:06:00Z"
  generation: 1
  labels:
    helmcharts.helm.cattle.io/chart: traefik
    objectset.rio.cattle.io/hash: c0f97ea7a25e3dec71957c7a3241a38f3e5fae5f
  name: helm-install-traefik
  namespace: kube-system
  resourceVersion: "598"
  uid: 2a591629-9af8-4949-b2dd-39bd02b148a4
spec:
  backoffLimit: 1000
  completionMode: NonIndexed
  completions: 1
  parallelism: 1
  selector:
    matchLabels:
      batch.kubernetes.io/controller-uid: 2a591629-9af8-4949-b2dd-39bd02b148a4
  suspend: false
  template:
    metadata:
      annotations:
        helmcharts.helm.cattle.io/configHash: SHA256=57C38B9FBB6B3E3C05F8793EC0355D9955F740BA54D7EF2D96D97F8D678F2B0E
      creationTimestamp: ~
      labels:
        batch.kubernetes.io/controller-uid: 2a591629-9af8-4949-b2dd-39bd02b148a4
        batch.kubernetes.io/job-name: helm-install-traefik
        controller-uid: 2a591629-9af8-4949-b2dd-39bd02b148a4
        helmcharts.helm.cattle.io/chart: traefik
        job-name: helm-install-traefik
    spec:
      containers:
      - name: helm
        image: rancher/klipper-helm:v0.8.2-build20230815
        args:
        - install
        - --set-string
        - global.systemDefaultRegistry=
        env:
        - name: NAME
          value: XXXXXX
        - name: VERSION
          value: XXXXXX
        - name: REPO
          value: XXXXXX
        - name: HELM_DRIVER
          value: XXXXXX
        - name: CHART_NAMESPACE
          value: XXXXXX
        - name: CHART
          value: XXXXXX
        - name: HELM_VERSION
          value: XXXXXX
        - name: TARGET_NAMESPACE
          value: XXXXXX
        - name: AUTH_PASS_CREDENTIALS
          value: XXXXXX
        - name: NO_PROXY
          value: XXXXXX
        - name: FAILURE_POLICY
          value: XXXXXX
        resources: []
        volumeMounts:
        - name: values
          mountPath: /config
        - name: content
          mountPath: /chart
        terminationMessagePath: /dev/termination-log
        terminationMessagePolicy: File
        imagePullPolicy: IfNotPresent
      dnsPolicy: ClusterFirst
      nodeSelector:
        kubernetes.io/os: linux
      restartPolicy: OnFailure
      schedulerName: default-scheduler
      securityContext: []
      serviceAccount: helm-traefik
      serviceAccountName: helm-traefik
      terminationGracePeriodSeconds: 30
      volumes:
      - name: values
        secret:
          defaultMode: 420
          secretName: chart-values-traefik
      - configMap:
          defaultMode: 420
          name: chart-content-traefik
        name: content
...
</pre></div></li><li class='expandable detail-hide'>kube-system Job helm-install-traefik-crd<div class='details'><pre>---
apiVersion: batch/v1
kind: Job
metadata:
  annotations:
    batch.kubernetes.io/job-tracking: ""
    objectset.rio.cattle.io/applied: H4sIAAAAAAAA/7RVUY/iNhD+K9VI99QkJCEsm0j3ELhQ6O0CCuyqVbVCxkzAxbEj26E9If575ZC7hu11e324t9ie7/P3jWcmZyAVe0almRSQwJYYeuidAnDgyMQOEvhZbsGBEg3ZEUMgOQMRQhpimBTaLuX2d6RGo/EUkx4lxnD0mOwxiz4gL10qhVGSc1QuPRBlXIV7po1qOMD5Vwb5h0Dl7k/HlqhzdAqcHz4ysXs/RV6OLel/8ghSIiRgFMGCHV2qdt8E0RWhFnest+jqT9pgCRcHqMJG/pqVqA0pK0hEzbkDnGyRN4mxkhu/2nulvtn9Zi0Hog+QQHRfFP3dgPaDYLjtD8OC7igZ+PEwHhRxEQ79kBT+IA6tutZrk30mtCGcu7eXvWFNV0it/i2hR1kUD6xkBpLA930HDJYVJwbt+Rs18YZ1KQq2n14traZpOLh7n/VH/jiKwvh+Mg7GQRSnk9EkGt/H8d1kFIdROEyzKMiiuygexf1onEbxII6D0fC7PMSlkwJbuYQJVBqS385A1N5+QJtSeHEAxak5ajM+Tx8zcOBEeP262C7Ol6jnLF/NFvPuVp4tF931NHt43HzIZ89Z3uHTSBWabtx4mubrjb12tUzH3btvX/UW0Ak7GFPppNd7d/74NMryebbOVpt0Obu862n7ovSaJN3reHHDwAu94Me6CoN/iP6KuXWa/5T9L5Xp03q6Waar1WacZx+y+XqWPqw6sIJwjV3AfLFZ5otffu3EePpEHY/yWhtUHpeUcCfwvSj0fM/vBXfNot8uulyTdPbwlGeb5eJhNu4yKvz88pcXB1hJ9s0uEfSAqnfkrKpQubbGkpPv3Xuhu60Z34V+2PfvgwG0mGXN+VJyRj9BArNiLs1SoUZh4KZzwQGFWtaKoi3jiwMnyesSH2UtzLUgS/u5JMY2U9taf3M0qnVj7DauHZdtmK1xe/flxZoScocr5EiNVLYD7PsogQZ1MxY1JMCZqP+0radswynzxcpCTAjjtUJwQKM6MYoppfbqeWce3c6hqyXd7aFWt/O52pNz+9WyXP8h1yj3Vec2LVuw/SOpLE50Ea3RW8jX0tBMAENM3aT98lcAAAD//411peIjBwAA
    objectset.rio.cattle.io/id: helm-controller-chart-registration
    objectset.rio.cattle.io/owner-gvk: helm.cattle.io/v1, Kind=HelmChart
    objectset.rio.cattle.io/owner-name: traefik-crd
    objectset.rio.cattle.io/owner-namespace: kube-system
  creationTimestamp: "2024-01-08T17:06:00Z"
  generation: 1
  labels:
    helmcharts.helm.cattle.io/chart: traefik-crd
    objectset.rio.cattle.io/hash: 48ff3d5c3117b372fcdca509795f9f2702af0592
  name: helm-install-traefik-crd
  namespace: kube-system
  resourceVersion: "588"
  uid: 655ceb1b-aaa8-4b24-92ab-fceb2ddd45bd
spec:
  backoffLimit: 1000
  completionMode: NonIndexed
  completions: 1
  parallelism: 1
  selector:
    matchLabels:
      batch.kubernetes.io/controller-uid: 655ceb1b-aaa8-4b24-92ab-fceb2ddd45bd
  suspend: false
  template:
    metadata:
      annotations:
        helmcharts.helm.cattle.io/configHash: SHA256=E3B0C44298FC1C149AFBF4C8996FB92427AE41E4649B934CA495991B7852B855
      creationTimestamp: ~
      labels:
        batch.kubernetes.io/controller-uid: 655ceb1b-aaa8-4b24-92ab-fceb2ddd45bd
        batch.kubernetes.io/job-name: helm-install-traefik-crd
        controller-uid: 655ceb1b-aaa8-4b24-92ab-fceb2ddd45bd
        helmcharts.helm.cattle.io/chart: traefik-crd
        job-name: helm-install-traefik-crd
    spec:
      containers:
      - name: helm
        image: rancher/klipper-helm:v0.8.2-build20230815
        args:
        - install
        env:
        - name: NAME
          value: XXXXXX
        - name: VERSION
          value: XXXXXX
        - name: REPO
          value: XXXXXX
        - name: HELM_DRIVER
          value: XXXXXX
        - name: CHART_NAMESPACE
          value: XXXXXX
        - name: CHART
          value: XXXXXX
        - name: HELM_VERSION
          value: XXXXXX
        - name: TARGET_NAMESPACE
          value: XXXXXX
        - name: AUTH_PASS_CREDENTIALS
          value: XXXXXX
        - name: NO_PROXY
          value: XXXXXX
        - name: FAILURE_POLICY
          value: XXXXXX
        resources: []
        volumeMounts:
        - name: values
          mountPath: /config
        - name: content
          mountPath: /chart
        terminationMessagePath: /dev/termination-log
        terminationMessagePolicy: File
        imagePullPolicy: IfNotPresent
      dnsPolicy: ClusterFirst
      nodeSelector:
        kubernetes.io/os: linux
      restartPolicy: OnFailure
      schedulerName: default-scheduler
      securityContext: []
      serviceAccount: helm-traefik-crd
      serviceAccountName: helm-traefik-crd
      terminationGracePeriodSeconds: 30
      volumes:
      - name: values
        secret:
          defaultMode: 420
          secretName: chart-values-traefik-crd
      - configMap:
          defaultMode: 420
          name: chart-content-traefik-crd
        name: content
...
</pre></div></li></ul></div></div></div><div class='accordion-item'><div class='accordion-header' id='control_33_header'><button class='accordion-button collapsed' type='button' data-bs-toggle='collapse' data-bs-target='#control_33' aria-expanded='false' aria-controls='control_33'><div class='row'><div class='col'><h2 class='fs-4'>C-0212: CIS-5.7.4 The default namespace should not be used</h2><p class='mb-0'> Kubernetes provides a default namespace, where objects are placed if no namespace is specified for them. Placing objects in this namespace makes application of RBAC and other controls more difficult.</p></div></div></button></div><div id='control_33' class='accordion-collapse collapse' aria-labelledby='control_33_header' data-bs-parent='#report'><div class='accordion-body'><p>Resources in a Kubernetes cluster should be segregated by namespace, to allow for security controls to be applied at that level and to make it easier to manage resources.</p><h5>Detection</h5><p>Lists all resources in default namespace for user to review and approve.</p><h5>Remediation</h5><p>Ensure that namespaces are created to allow for appropriate segregation of Kubernetes resources and that all new resources are created in a specific namespace.</p><h5>Checked paths and expected values</h5><ul><li>metadata.namespace</li></ul><h5>References</h5><ul><li><a href='https://workbench.cisecurity.org/sections/1126667/recommendations/1838637'>https://workbench.cisecurity.org/sections/1126667/recommendations/1838637</a></li></ul><h5>Affected resources</h5><ul><li class='expandable detail-hide'>default EndpointSlice kubernetes<div class='details'><pre>---
addressType: IPv4
apiVersion: discovery.k8s.io/v1
endpoints:
- addresses:
  - 172.19.0.3
  conditions:
    ready: true
kind: EndpointSlice
metadata:
  creationTimestamp: "2024-01-08T17:05:55Z"
  generation: 1
  labels:
    kubernetes.io/service-name: kubernetes
  name: kubernetes
  namespace: default
  resourceVersion: "195"
  uid: 1e6e4fea-5b81-449f-a7fa-9a2def625c42
ports:
- name: https
  port: 6443
  protocol: TCP
...
</pre></div></li><li class='expandable detail-hide'>default Endpoints kubernetes<div class='details'><pre>---
apiVersion: v1
kind: Endpoints
metadata:
  creationTimestamp: "2024-01-08T17:05:55Z"
  labels:
    endpointslice.kubernetes.io/skip-mirror: "true"
  name: kubernetes
  namespace: default
  resourceVersion: "194"
  uid: 1e3ca603-0602-42d4-84aa-6820a8f78786
subsets:
- addresses:
  - ip: 172.19.0.3
  ports:
  - name: https
    port: 6443
    protocol: TCP
...
</pre></div></li><li class='expandable detail-hide'>default Service kubernetes<div class='details'><pre>---
apiVersion: v1
kind: Service
metadata:
  creationTimestamp: "2024-01-08T17:05:55Z"
  labels:
    component: apiserver
    provider: kubernetes
  name: kubernetes
  namespace: default
  resourceVersion: "192"
  uid: 46bca163-e26d-497c-98d6-1dfc3c50d674
spec:
  clusterIP: 10.43.0.1
  clusterIPs:
  - 10.43.0.1
  internalTrafficPolicy: Cluster
  ipFamilies:
  - IPv4
  ipFamilyPolicy: SingleStack
  ports:
  - name: https
    port: 443
    protocol: TCP
    targetPort: 6443
  sessionAffinity: None
  type: ClusterIP
...
</pre></div></li></ul></div></div></div><div class='accordion-item'><div class='accordion-header' id='control_34_header'><button class='accordion-button collapsed' type='button' data-bs-toggle='collapse' data-bs-target='#control_34' aria-expanded='false' aria-controls='control_34'><div class='row'><div class='col'><h2 class='fs-4'>C-0262: Anonymous access enabled</h2><p class='mb-0'> Granting permissions to the system:unauthenticated or system:anonymous user is generally not recommended and can introduce security risks. Allowing unauthenticated access to your Kubernetes cluster can lead to unauthorized access, potential data breaches, and abuse of cluster resources.</p></div></div></button></div><div id='control_34' class='accordion-collapse collapse' aria-labelledby='control_34_header' data-bs-parent='#report'><div class='accordion-body'><h5>Detection</h5><p>Checks if ClusterRoleBinding/RoleBinding resources give permissions to anonymous user. Also checks in the apiserver if the --anonymous-auth flag is set to false</p><h5>Remediation</h5><p>Review and modify your cluster's RBAC configuration to ensure that only authenticated and authorized users have appropriate permissions based on their roles and responsibilities within your system.</p><h5>Checked paths and expected values</h5><ul><li>subjects[*]</li></ul><h5>Affected resources</h5><ul><li class='expandable detail-hide'>-cluster- ClusterRoleBinding system:public-info-viewer<div class='details'><pre>---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  annotations:
    rbac.authorization.kubernetes.io/autoupdate: "true"
  creationTimestamp: "2024-01-08T17:05:54Z"
  labels:
    kubernetes.io/bootstrapping: rbac-defaults
  name: system:public-info-viewer
  resourceVersion: "138"
  uid: 2205af79-2c4d-4fc1-a8b2-160ac5075b6d
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: system:public-info-viewer
subjects:
- apiGroup: rbac.authorization.k8s.io
  kind: Group
  name: system:authenticated
- apiGroup: rbac.authorization.k8s.io
  kind: Group
  name: system:unauthenticated
...
</pre></div></li></ul></div></div></div>            </div>
        </div>
    </div>
</div>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL"
        crossorigin="anonymous"></script>
<script>
    // show details when resource is clicked
    const expandables = document.querySelectorAll('.expandable');
    expandables.forEach(el => el.addEventListener('click', handleClick));

    function handleClick(e) {
        e.target.classList.toggle('detail-hide');
    }

    // scroll to opened heading
    document.addEventListener('shown.bs.collapse', function(event){
        window.location.href = '#' + event.target.id  + "_header";
        //document.querySelector('#'+ event.target.id + "_header").scrollIntoView({ behavior: 'instant' });

    });

</script>
</body>
</html>